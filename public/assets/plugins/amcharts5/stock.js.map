{"version":3,"file":"stock.js","mappings":"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","sources":["webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/StockToolbarCSS.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/PanelControls.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/StockIcons.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/StockChartDefaultTheme.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/StockControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/Dropdown.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DropdownColors.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/ColorControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/SettingsModal.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/StockChart.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/Indicator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/StockLegend.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/StockPanel.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/ChartIndicator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MovingAverage.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MovingAverageEnvelope.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MovingAverageDeviation.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/BollingerBands.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/RelativeStrengthIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/AccumulationDistribution.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/AccumulativeSwingIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/Aroon.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MACD.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/ChaikinMoneyFlow.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/ChaikinOscillator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/OnBalanceVolume.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/StochasticOscillator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/AwesomeOscillator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/WilliamsR.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/Volume.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/CommodityChannelIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/DisparityIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/DrawingSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/PolylineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/RectangleSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/SimpleLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/HorizontalLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/VerticalLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/AverageSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/RegressionSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/DoodleSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/SpriteResizer.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/IconSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/LabelSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/CalloutSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/EllipseSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/TrendLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/QuadrantLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/FibonacciSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/FibonacciTimezoneSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/HorizontalRaySeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/StockToolbar.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DropdownList.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DrawingToolControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DropdownListControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/IconControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DrawingControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/IndicatorControl.ts","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/types/options.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/l10n/default.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/index.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/dom.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/formatting.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/dates.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/index.js","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DateRangeSelector.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/PeriodSelector.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/SeriesTypeControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/IntervalControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/ResetControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/SettingsControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/ComparisonControl.ts","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/polyfills.js","webpack://@amcharts/amcharts5/./node_modules/regression/dist/regression.js","webpack://@amcharts/amcharts5/./tmp/webpack/stock.js"],"sourcesContent":["import type { Root } from \"../../../core/Root\"\n\nimport { StyleRule } from \"../../../core/util/Utils\"\nimport { MultiDisposer, IDisposer, CounterDisposer } from \"../../../core/util/Disposer\";\n\n/**\n * @ignore\n */\nlet rules: CounterDisposer | undefined;\n\n/**\n * @ignore\n */\nexport default function(element: ShadowRoot | null, root: Root, _prefix?: string): IDisposer {\n\tconst ic = root.interfaceColors;\n\tconst active = ic.get(\"secondaryButton\")!.toCSS();\n\tconst hover = ic.get(\"secondaryButtonHover\")!.toCSS();\n\t//const border = ic.get(\"secondaryButtonStroke\")!.toCSS();\n\tconst text = ic.get(\"text\")!.toCSS();\n\tconst border = ic.get(\"secondaryButtonActive\")!.toCSS();\n\tconst bg = ic.get(\"background\")!.toCSS();\n\n\tif (!rules) {\n\t\tconst disposer = new MultiDisposer([\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"position\": \"relative\",\n\t\t\t\t\"border\": \"1px solid \" + border,\n\t\t\t\t\"border-radius\": \"4px\",\n\t\t\t\t\"padding\": \"3px 0 3px 5px\",\n\t\t\t\t\"margin\": \"2px\",\n\t\t\t\t\"z-index\": \"1\",\n\t\t\t\t\"cursor\": \"default\",\n\t\t\t\t\"line-height\": \"1.5em\",\n\t\t\t\t\"color\": text\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button div\", {\n\t\t\t\t\"box-sizing\": \"initial\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button:hover\", {\n\t\t\t\t\"background\": active\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button.am5stock-no-hover:hover\", {\n\t\t\t\t\"background\": \"initial\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content .am5stock-control-button\", {\n\t\t\t\t\"padding\": \"0\",\n\t\t\t\t\"border\": \"none\",\n\t\t\t\t//\"margin-top\": \"3px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button.am5stock-align-right\", {\n\t\t\t\t\"float\": \"right\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button.am5stock-control-button-active\", {\n\t\t\t\t\"background\": active,\n\t\t\t\t\"z-index\": \"2\",\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content .am5stock-control-button.am5stock-control-button-active, .am5-modal-content .am5stock-control-button:hover\", {\n\t\t\t\t\"background\": \"none\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon\", {\n\t\t\t\t\"min-width\": \"1.2em\",\n\t\t\t\t\"min-height\": \"1.2em\",\n\t\t\t\t\"max-width\": \"1.2em\",\n\t\t\t\t//\"max-height\": \"1.2em\",\n\t\t\t\t//\"margin-right\": \"4px\",\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"position\": \"relative\",\n\t\t\t\t\"margin\": \"0 5px 0 0\",\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon.am5stock-icon-wide\", {\n\t\t\t\t\"max-width\": \"60px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon > *\", {\n\t\t\t\t\"vertical-align\": \"sub\",\n\t\t\t\t// \"max-width\": \"18px\",\n\t\t\t\t// \"max-height\": \"18px\",\n\t\t\t\t//\"margin-right\": \"5px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon > .am5stock-control-icon-color\", {\n\t\t\t\t\"max-width\": \"20px\",\n\t\t\t\t//\"max-height\": \"20px\",\n\t\t\t\t\"width\": \"20px\",\n\t\t\t\t//\"height\": \"20px\",\n\t\t\t\t//\"margin-right\": \"5px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon > .am5stock-control-icon-color-bg\", {\n\t\t\t\t\"width\": \"100%\",\n\t\t\t\t\"height\": \"100%\",\n\t\t\t\t\"display\": \"block\",\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"left\": \"0\",\n\t\t\t\t\"top\": \"0\",\n\t\t\t\t\"z-index\": \"-1\",\n\t\t\t\t\"background-image\": \"linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)\",\n\t\t\t\t\"background-size\": \"10px 10px\",\n\t\t\t\t\"background-position\": \"0 0, 0 5px, 5px -5px, -5px 0px\",\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button path\", {\n\t\t\t\t//fill: ic.get(\"secondaryButtonText\")!.toCSS(),\n\t\t\t\t\"stroke-width\": \"0.5\",\n\t\t\t\t\"stroke\": text,\n\t\t\t\t\"fill\": \"none\",\n\t\t\t\t\"vector-effect\": \"non-scaling-stroke\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-label\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"margin\": \"0 5px 0 0\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list-container\", {\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"left\": \"0\",\n\t\t\t\t\"top\": \"100%\",\n\t\t\t\t\"margin-top\": \"10px\",\n\t\t\t\t\"background\": bg,\n\t\t\t\t\"border\": \"1px solid \" + border,\n\t\t\t\t\"border-radius\": \"3px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-align-right .am5stock-control-list-container\", {\n\t\t\t\t\"left\": \"auto\",\n\t\t\t\t\"right\": \"0\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list-arrow\", {\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"left\": \"5px\",\n\t\t\t\t\"top\": \"-5px\",\n\t\t\t\t\"border\": \"solid \" + border,\n\t\t\t\t\"border-width\": \"0 1px 1px 0\",\n\t\t\t\t\"background\": bg,\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"padding\": \"5px\",\n\t\t\t\t\"transform\": \"rotate(-135deg)\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-align-right .am5stock-control-list-arrow\", {\n\t\t\t\t\"right\": \"5px\",\n\t\t\t\t\"left\": \"auto\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list\", {\n\t\t\t\t\"list-style\": \"none\",\n\t\t\t\t\"margin\": \"5px\",\n\t\t\t\t\"padding\": \"2px\",\n\t\t\t\t\"white-space\": \"nowrap\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li\", {\n\t\t\t\t\"padding\": \"2px 6px 2px 6px\",\n\t\t\t\t\"position\": \"relative\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li:hover\", {\n\t\t\t\t\"background\": active\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li.am5stock-list-info\", {\n\t\t\t\t\"font-style\": \"italic\",\n\t\t\t\t\"color\": hover\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list .am5stock-list-sub\", {\n\t\t\t\t\"font-size\": \"0.7em\",\n\t\t\t\t\"color\": hover,\n\t\t\t\t\"display\": \"block\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li.am5stock-list-info:hover\", {\n\t\t\t\t\"background\": \"none\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li.am5stock-list-heading\", {\n\t\t\t\t\"font-style\": \"normal\",\n\t\t\t\t\"font-weight\": \"bold\",\n\t\t\t\t\"color\": \"initial\",\n\t\t\t\t\"margin-top\": \"0.3em\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li svg\", {\n\t\t\t\t\"max-width\": \"1em\",\n\t\t\t\t\"max-height\": \"1em\",\n\t\t\t\t\"margin-right\": \"0.8em\",\n\t\t\t\t//\"position\": \"absolute\",\n\t\t\t\t\"left\": \"0px\",\n\t\t\t\t\"top\": \"2px\",\n\t\t\t\t\"display\": \"inline-block\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li svg.am5stock-icon-wide, .am5stock-control-icon > *.am5stock-icon-wide\", {\n\t\t\t\t\"width\": \"60px\",\n\t\t\t\t\"max-width\": \"60px\",\n\t\t\t\t\"margin-right\": \"0\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li div, .am5stock-control-list li label\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"margin-right\": \"1em\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li input\", {\n\t\t\t\t\"margin-right\": \"1em\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-list-search\", {\n\t\t\t\t//\"display\": \"inline-block\",\n\t\t\t\t\"margin\": \"0.5em 0.7em\",\n\t\t\t\t\"padding-bottom\": \"0.25em\",\n\t\t\t\t//\"padding-left\": \"30px\",\n\t\t\t\t//\"border-bottom\": \"1px solid \" + active,\n\t\t\t\t\"position\": \"relative\",\n\t\t\t\t//\"background\": \"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyNCIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjEwLjUiIHI9IjcuNSIvPjxsaW5lIHgxPSIyMSIgeDI9IjE1LjgiIHkxPSIyMSIgeTI9IjE1LjgiLz48L3N2Zz4=) left / 20px 20px no-repeat\",\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-list-search input\", {\n\t\t\t\t\"border\": \"1px solid \" + active,\n\t\t\t\t\"padding\": \"6px 10px 6px 30px\",\n\t\t\t\t\"margin-top\": \"5px\",\n\t\t\t\t\"background\": \"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyNCIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjEwLjUiIHI9IjcuNSIvPjxsaW5lIHgxPSIyMSIgeDI9IjE1LjgiIHkxPSIyMSIgeTI9IjE1LjgiLz48L3N2Zz4=) 5px / 20px 20px no-repeat\",\n\t\t\t\t\"background-color\": \"#fff\",\n\t\t\t\t//\"background-color\": active,\n\t\t\t\t\"color\": \"#888\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-list-search input::placeholder\", {\n\t\t\t\t\"color\": \"#888\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors, .am5stock-control-icons\", {\n\t\t\t\t\"list-style\": \"none\",\n\t\t\t\t\"margin\": \"5px\",\n\t\t\t\t\"padding\": \"2px\",\n\t\t\t\t//\"white-space\": \"nowrap\",\n\t\t\t\t\"width\": \"240px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors li, .am5stock-control-icons li\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"padding\": \"0\",\n\t\t\t\t\"margin\": \"0\",\n\t\t\t\t\"border\": \"3px solid \" + bg,\n\t\t\t\t\"width\": \"24px\",\n\t\t\t\t\"height\": \"24px\",\n\t\t\t\t\"position\": \"relative\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors li:hover, .am5stock-control-colors li.am5stock-control-active, .am5stock-control-icons li:hover, .am5stock-control-icons li.am5stock-control-active\", {\n\t\t\t\t\"border-color\": \"rgba(200, 200, 200, 1)\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors li.am5stock-control-opacity\", {\n\t\t\t\t\"width\": \"42px\",\n\t\t\t\t\"text-align\": \"center\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors li.am5stock-control-opacity\", {\n\t\t\t\t\"width\": \"42px\",\n\t\t\t\t\"text-align\": \"center\",\n\t\t\t\t\"font-size\": \"12px\",\n\t\t\t\t\"line-height\": \"24px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-opacity-100, .am5stock-control-opacity-75, .am5stock-control-opacity-50\", {\n\t\t\t\t\"color\": \"#fff\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-row\", {\n\t\t\t\t\"display\": \"flex\",\n\t\t\t\t\"flex-direction\": \"row\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-column\", {\n\t\t\t\t\"width\": \"200px\",\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"padding\": \"1em\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-group\", {\n\t\t\t\t\"white-space\": \"nowrap\",\n\t\t\t\t//\"margin\": \"0.5em 1em\",\n\t\t\t\t\"padding-bottom\": \"0.25em\",\n\t\t\t\t\"border-bottom\": \"1px solid \" + active,\n\t\t\t\t\"position\": \"relative\",\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-group input\", {\n\t\t\t\t\"border\": \"none\",\n\t\t\t\t\"padding\": \"3px 5px\",\n\t\t\t\t\"margin-top\": \"5px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-link\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"margin\": \"0 0.15em\",\n\t\t\t\t\"padding\": \"0 3px\",\n\t\t\t\t\"border-radius\": \"3px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-link.am5stock-active, .am5stock-link:hover\", {\n\t\t\t\t//\"font-weight\": \"bold\"\n\t\t\t\t\"background\": active\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-drawing-label-wrapper\", {\n\t\t\t\t//\"font-weight\": \"bold\"\n\t\t\t\t\"background-color\": bg,\n\t\t\t\t\"bakcground-opacity\": \"0.5\",\n\t\t\t\t\"padding\": \"0.5em\",\n\t\t\t\t\"border-radius\": \"4px\",\n\t\t\t\t\"-webkit-box-shadow\": \"0px 0px 36px 0px rgba(0,0,0,0.45)\",\n\t\t\t\t\"box-shadow\": \"0px 0px 36px 0px rgba(0,0,0,0.45)\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5stock-drawing-label-input\", {\n\t\t\t\t\"width\": \"250px\",\n\t\t\t\t\"min-height\": \"50px\",\n\t\t\t}),\n\n\t\t]);\n\n\t\trules = new CounterDisposer(() => {\n\t\t\trules = undefined;\n\t\t\tdisposer.dispose();\n\t\t});\n\t}\n\n\treturn rules.increment();\n}","import type { StockChart } from \"./StockChart\";\r\nimport type { StockPanel } from \"./StockPanel\";\r\n\r\nimport { Container, IContainerPrivate, IContainerSettings } from \"../../core/render/Container\";\r\nimport { Button } from \"../../core/render/Button\";\r\nimport { Graphics } from \"../../core/render/Graphics\";\r\n\r\nexport interface IPanelControlsSettings extends IContainerSettings {\r\n\r\n\t/**\r\n\t * A target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * A target [[StockPanel]].\r\n\t */\r\n\tstockPanel: StockPanel\r\n\r\n}\r\n\r\nexport interface IPanelControlsPrivate extends IContainerPrivate {\r\n\r\n}\r\n\r\n/**\r\n * Creates a button set for [[StockChart]] panels (move up/down, close, etc.)\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/panels/#Panel_controls} for more info\r\n */\r\nexport class PanelControls extends Container {\r\n\r\n\tdeclare public _settings: IPanelControlsSettings;\r\n\tdeclare public _privateSettings: IPanelControlsPrivate;\r\n\r\n\tpublic static className: string = \"PanelControls\";\r\n\tpublic static classNames: Array<string> = Container.classNames.concat([PanelControls.className]);\r\n\r\n\t/**\r\n\t * A [[Button]] which moves panel up.\r\n\t *\r\n\t * @default Button.new()\r\n\t */\r\n\tpublic upButton = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"up\", \"control\", \"panel\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t})\r\n\t}))\r\n\r\n\t/**\r\n\t * A [[Button]] which moves panel down.\r\n\t *\r\n\t * @default Button.new()\r\n\t */\r\n\tpublic downButton = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"down\", \"control\", \"panel\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t})\r\n\t}))\r\n\r\n\t/**\r\n\t * A [[Button]] which expands/collapses the panel.\r\n\t *\r\n\t * @default Button.new()\r\n\t */\r\n\tpublic expandButton = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"expand\", \"control\", \"panel\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t})\r\n\t}))\r\n\r\n\t/**\r\n\t * A [[Button]] which closes the panel.\r\n\t *\r\n\t * @default Button.new()\r\n\t */\r\n\tpublic closeButton = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"close\", \"control\", \"panel\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t})\r\n\t}))\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\r\n\t\tconst upButton = this.upButton;\r\n\t\tconst downButton = this.downButton;\r\n\r\n\t\tdownButton.events.on(\"click\", () => {\r\n\t\t\tconst stockPanel = this.get(\"stockPanel\");\r\n\t\t\tstockPanel.moveDown();\r\n\t\t});\r\n\r\n\t\tupButton.events.on(\"click\", () => {\r\n\t\t\tconst stockPanel = this.get(\"stockPanel\");\r\n\t\t\tstockPanel.moveUp();\r\n\t\t});\r\n\r\n\t\tthis.closeButton.events.on(\"click\", () => {\r\n\t\t\tconst stockPanel = this.get(\"stockPanel\");\r\n\t\t\tstockPanel.close();\r\n\t\t});\r\n\r\n\t\tthis.expandButton.events.on(\"click\", () => {\r\n\t\t\tconst stockPanel = this.get(\"stockPanel\");\r\n\t\t\tstockPanel.expand();\r\n\t\t});\r\n\r\n\t}\r\n}\r\n","export interface StockIcon {\r\n\tviewbox: string;\r\n\tpath: string;\r\n\tstyle?: string;\r\n}\r\n\r\n/**\r\n * A collection of icons used in [[StockChart]].\r\n */\r\nexport class StockIcons {\r\n\tpublic static icons: { [index: string]: StockIcon } = {\r\n\t\t// Misc\r\n\t\t\"Default\": { viewbox: \"0 0 50 50\", path: \"M 25 10 L 25 40 M 10 25 L 41 25\" },\r\n\t\t\"Indicator\": { viewbox: \"0 0 50 50\", path: \"M 2 10 C 28 27 31 1 48 11 M 1 49 C 24 22 25 38 48 44 M 3 25 L 48 25 L 41 19 M 48 25 L 41 31\" },\r\n\t\t\"Color\": { viewbox: \"0 0 50 50\", path: \"\" },\r\n\t\t\"Dash\": { viewbox: \"0 0 60 16\", path: \"M0,8 60,8\" },\r\n\r\n\t\t\"Calendar\": { viewbox: \"0 0 50 50\", path: \"M 3 8 L 47 8 L 47 49 L 3 49 L 3 8 M 3 19 L 47 19 M 9 28 L 15 28 M 22 28 L 28 28 M 35 28 L 41 28 M 9 39 L 15 39 M 22 39 L 28 39 M 35 39 L 41 39 M 12 14 L 12 1 M 38 14 L 38 1\" },\r\n\t\t\"Period\": { viewbox: \"0 0 50 50\", path: \"M 3 3 L 47 3 L 47 48 L 3 48 L 3 3 M 3 12 L 47 12 M 9 21 L 15 21 M 22 21 L 28 21 M 35 21 L 41 21 M 9 30 L 15 30 M 22 30 L 28 30 M 35 30 L 41 30 M 9 39 L 15 39 M 22 39 L 28 39 M 35 39 L 41 39\" },\r\n\t\t\"Interval\": { viewbox: \"0 0 50 50\", path: \"M 3 10 L 3 48 M 3 10 L 43 10 M 13 10 L 13 36 M 23 10 L 23 36 M 43 10 L 43 48 M 33 10 L 33 36\" },\r\n\t\t\"Comparison\": { viewbox: \"0 0 50 50\", path: \"M 25 10 L 25 40 M 10 25 L 41 25\" },\r\n\t\t\"Settings\": { viewbox: \"0 0 50 50\", path: \"M49,25 L47.6,33.2 L41.3,32.6 L39.7,35.3 L43.4,40.4 L37,45.8 L32.6,41.3 L29.7,42.4 L29.2,48.6 L20.8,48.6 L20.3,42.4 L17.4,41.3 L13,45.8 L6.6,40.4 L10.3,35.3 L8.7,32.6 L2.4,33.2 L1,25 L7.1,23.4 L7.6,20.3 L2.4,16.8 L6.6,9.6 L12.3,12.3 L14.7,10.3 L13,4.2 L20.8,1.4 L23.4,7.1 L26.6,7.1 L29.2,1.4 L37,4.2 L35.3,10.3 L37.7,12.3 L43.4,9.6 L47.6,16.8 L42.4,20.3 L42.9,23.4 L49,25 M 17 25 A 1 1 0 0 0 33 25 A 1 1 0 0 0 17 25\" },\r\n\r\n\t\t// Chart types\r\n\t\t\"Line Series\": { viewbox: \"0 0 50 50\", path: \"M 3 28 L 14 18 L 25 32 L 36 9 L 47 19\" },\r\n\t\t\"Area Series\": { viewbox: \"0 0 50 50\", path: \"M 3 20 L 14 13 L 25 20.95 L 37 9 L 48 16 L 48 48 M 8 17 L 8 48 M 13 14 L 13 48 M 18 16 L 18 48 M 23 20 L 23 48 M 28 18 L 28 48 M 33 13 L 33 48 M 38 10 L 38 48 M 43 13 L 43 48 M 3 20 L 3 48\" },\r\n\t\t\"Candlestick Series\": { viewbox: \"0 0 50 50\", path: \"M 3 17 L 3 37 L 19 37 M 19 37 L 19 17 L 3 17 M 11 17 L 11 6 M 11 37 L 11 50 M 30 11 L 30 31 L 46 31 L 46 11 L 30 11 M 38 11 L 38 0 M 38 31 L 38 44 M 3 22 L 19 22 M 3 27 L 19 27 M 3 32 L 19 32 M 30 16 L 46 16 M 30 21 L 46 21 M 30 26 L 46 26\" },\r\n\t\t\"Pro Candlestick Series\": { viewbox: \"0 0 50 50\", path: \"M 3 10 L 3 31 L 19 31 M 19 31 L 19 10 L 3 10 M 11 10 L 11 0 M 11 31 L 11 43 M 30 17 L 30 37 L 46 37 L 46 17 L 30 17 M 38 17 L 38 4 M 38 37 L 38 50 M 30 22 L 46 22 M 30 27 L 46 27 M 30 32 L 46 32\" },\r\n\t\t\"OHLC Series\": { viewbox: \"0 0 50 50\", path: \"M 11 31 L 20 31 M 11 3 L 11 43 M 38 5 L 38 50 M 29 36 L 38 36 M 38 12 L 47 12 M 11 17 L 2 17\" },\r\n\r\n\t\t// Drawing tools\r\n\t\t\"Draw\": { viewbox: \"0 0 50 50\", path: \"M 29 2 L 48 21 L 22 47 L 3 47 L 3 28 L 29 2 M 23 8 L 42 27 M 3 42 L 8 47 M 18 39 L 36 21 M 11 32 L 29 14 M 3 28 L 11 32 L 13 38 L 18 39 L 22 47 M 25 6 L 44 25 M 27 4 L 46 23 M 3 44 L 6 47 M 3 40 L 10 47\" },\r\n\t\t\"Average\": { viewbox: \"0 0 50 50\", path: \"M2 24a5 5 0 1 0 10 0 5 5 0 1 0-10 0M12 24h26M38 24a5 5 0 1 0 10 0 5 5 0 1 0-10 0\" },\r\n\t\t\"Callout\": { viewbox: \"0 0 50 50\", path: \"M 3 3 L 47 3 L 47 39 L 31 39 L 25 45 L 19 39 L 3 39 L 3 3 M 11 12 L 39 12 M 11 20 L 39 20 M 11 28 L 39 28\" },\r\n\t\t\"Doodle\": { viewbox: \"0 0 48 48\", path: \"M 43.036,2.509 C 32.59,9.83 8.05,6.67 6.29,15.01 5.19,26.29 34.40,18.9 37.4,27.5 c 1.4,3.78 -4.0,8 -15.7,13.18\" },\r\n\t\t\"Ellipse\": { viewbox: \"0 0 50 50\", path: \"M 25 5 a 22 20 0 1 0 1 0 z\" },\r\n\t\t\"Fibonacci\": { viewbox: \"0 0 50 50\", path: \"M2 3 h46 M2 11.5 h46 M2 24 h46 M2 49 h46\" },\r\n\t\t\"Fibonacci Timezone\": { viewbox: \"0 0 50 50\", path: \"M5 2.5 v46 M13.5 2.5 v46 M26 2.5 v46 M46.5 2.5 v46\" },\r\n\t\t\"Horizontal Line\": { viewbox: \"0 0 50 50\", path: \"M20 24a5 5 0 1 0 10 0 5 5 0 1 0-10 0M2 24h18 M32,24 h18\" },\r\n\t\t\"Horizontal Ray\": { viewbox: \"0 0 50 50\", path: \"M2 24a5 5 0 1 0 10 0 5 5 0 1 0-10 0 M14,24 h36\" },\r\n\t\t\"Arrows &amp; Icons\": { viewbox: \"0 0 50 50\", path: \"M 5 35 L 5 15 L 26 15 M 26 15 L 26 5 L 45 26 L 26 45 L 26 35 L 5 35\" },\r\n\t\t\"Label\": { viewbox: \"0 0 50 50\", path: \"M 10 45 l 15 -32 l 15 32 m -24 -13 l 18 0\", style: \"stroke-width: 1.2px\" },\r\n\t\t\"Line\": { viewbox: \"0 0 50 50\", path: \"M 4 46 L 46 4\" },\r\n\t\t\"Polyline\": { viewbox: \"0 0 50 50\", path: \"M 2 15 L 16 42 L 36 22 L 48 29\" },\r\n\t\t\"Quadrant Line\": { viewbox: \"0 0 50 50\", path: \"M2 3 h46 M2 15 h46 M2 29 h46 M2 43 h46\" },\r\n\t\t\"Rectangle\": { viewbox: \"0 0 50 50\", path: \"M3 3 L47 3 L47 47 L3 47 L3 3\" },\r\n\t\t\"Regression\": { viewbox: \"0 0 50 50\", path: \"M 2 15 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0 M 11.36 17.369 L 38.661 32.505 M 38 35 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0\" },\r\n\t\t\"Trend Line\": { viewbox: \"0 0 50 50\", path: \"M 2 35 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0 M 11.343 32.542 L 38.614 17.398 M 38 15 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0\" },\r\n\t\t\"Vertical Line\": { viewbox: \"0 0 50 50\", path: \"M19 25a5 5 0 1 0 10 0 5 5 0 1 0-10 0M24 2v18 M24,32 v18\" },\r\n\r\n\t\t\"Eraser\": { viewbox: \"0 0 50 50\", path: \"M 13 48 L 21 48 L 45 24 L 29 8 L 1 36 L 13 48 M 32 48 L 38 48 M 43 48 L 49 48 M 23 14 L 39 30 M 20 17 L 36 33 M 26 11 L 42 27\" },\r\n\t\t\"Clear\": { viewbox: \"0 0 50 50\", path: \"M 6 10 L 12 48 L 38 48 L 44 10 L 6 10 M 14 14 L 18 43 M 25 14 L 25 43 M 36 14 L 32 43 M 6 8 L 44 8 M 21 8 L 21 3 L 30 3 L 30 8\" },\r\n\t\t\"Bold\": { viewbox: \"0 0 50 50\", path: \"M 12 4 L 12 47 L 32 47 C 45 47 47 23 32 23 C 42 23 42 4 31 4 L 12 4 Z M 32 23 L 12 23 Z\", style: \"stroke-width: 1.8px\" },\r\n\t\t\"Italic\": { viewbox: \"0 0 50 50\", path: \"M 17 5 L 38 5 M 27 5 L 18 47 M 8 47 L 28 47\" },\r\n\t\t\"Show Extension\": { viewbox: \"0 0 50 50\", path: \"M 10 15 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0 M 30 36 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0 M 40 41 L 50 50 M 20 20 L 30 30 M 10 10 L 0 0\" },\r\n\t\t\"Snap\": { viewbox: \"0 0 50 50\", path: \"M 17 29 L 29 29 M 33 39 a 5 5 0 1 0 16 3 a 5 5 0 1 0 -16 -3 M 29 17 L 29 29 L 3 3\" },\r\n\t\t\"Reset\": { viewbox: \"0 0 50 50\", path: \"M 4 25 A 1 1 0 0 0 46 25 Q 46 4 25 4 Q 18 4 11 10 L 5 4 L 5 16 L 17 16 L 11 10\" },\r\n\t};\r\n\r\n\tpublic static getIcon(id: string): SVGElement {\r\n\t\tconst icons: any = StockIcons.icons;\r\n\t\tconst icon: any = icons[id] || icons[\"Default\"];\r\n\t\treturn StockIcons._getSVG(icon);\r\n\t}\r\n\r\n\tpublic static _getSVG(icon: any): SVGElement {\r\n\t\tconst svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n\t\tsvg.setAttribute(\"viewBox\", icon.viewbox);\r\n\t\tsvg.setAttribute(\"class\", \"am5stock_control_default_icon\");\r\n\r\n\t\tconst path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n\t\tpath.setAttribute(\"d\", icon.path);\r\n\t\tsvg.appendChild(path);\r\n\r\n\t\tif (icon.style) {\r\n\t\t\tpath.setAttribute(\"style\", icon.style);\r\n\t\t}\r\n\t\treturn svg;\r\n\t}\r\n}","import { Theme } from \"../../core/Theme\";\r\nimport { p100, p50, p0, percent } from \"../../core/util/Percent\";\r\nimport { setColor } from \"../../themes/DefaultTheme\";\r\nimport { color } from \"../../core/util/Color\";\r\nimport { ColorSet } from \"../../core/util/ColorSet\";\r\nimport { StockIcons } from \"./toolbar/StockIcons\";\r\n\r\nimport * as $math from \"../../core/util/Math\";\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport class StockChartDefaultTheme extends Theme {\r\n\tprotected setupDefaultRules() {\r\n\t\tsuper.setupDefaultRules();\r\n\r\n\t\tconst l = this._root.language;\r\n\t\tconst r = this.rule.bind(this);\r\n\t\tconst verticalLayout = this._root.verticalLayout;\r\n\t\tconst ic = this._root.interfaceColors;\r\n\r\n\t\t/**\r\n\t\t * ========================================================================\r\n\t\t * charts/xy\r\n\t\t * ========================================================================\r\n\t\t */\r\n\r\n\t\tr(\"StockChart\").setAll({\r\n\t\t\tpaddingLeft: 18,\r\n\t\t\tpaddingRight: 18,\r\n\t\t\tpaddingTop: 5,\r\n\t\t\tpaddingBottom: 15,\r\n\t\t\twidth: p100,\r\n\t\t\theight: p100,\r\n\t\t\tlayout: verticalLayout,\r\n\t\t\tpercentScaleSeriesSettings: {\r\n\t\t\t\tvalueYShow: \"valueYChangeSelectionPercent\",\r\n\t\t\t\topenValueYShow: \"openValueYChangeSelectionPercent\",\r\n\t\t\t\thighValueYShow: \"highValueYChangeSelectionPercent\",\r\n\t\t\t\tlowValueYShow: \"lowValueYChangeSelectionPercent\"\r\n\t\t\t},\r\n\t\t\tpercentScaleValueAxisSettings: {\r\n\t\t\t\tnumberFormat: \"#.##'%'\",\r\n\t\t\t\tinterpolationDuration: 0,\r\n\t\t\t\textraMax: 0.05,\r\n\t\t\t\tstrictMinMaxSelection: true\r\n\t\t\t},\r\n\t\t\tautoSetPercentScale: true\r\n\t\t});\r\n\r\n\t\tr(\"XYChart\", [\"stock\"]).setAll({\r\n\t\t\tpaddingLeft: 0,\r\n\t\t\tpaddingRight: 0,\r\n\t\t\tpaddingBottom: 0,\r\n\t\t\tpaddingTop: 15,\r\n\t\t\tminHeight: 80\r\n\t\t});\r\n\r\n\t\tr(\"XYChart\", [\"stock\", \"scrollbar\"]).setAll({\r\n\t\t\tminHeight: 0\r\n\t\t});\r\n\r\n\t\tr(\"StockLegend\").setAll({\r\n\t\t\tclickTarget: \"marker\"\r\n\t\t});\r\n\r\n\t\tr(\"Label\").setAll({\r\n\t\t\tfontSize: \"0.8em\"\r\n\t\t});\r\n\r\n\t\tr(\"Legend\", [\"stocklegend\"]).setAll({\r\n\t\t\tpaddingTop: 6,\r\n\t\t\tpaddingLeft: 6\r\n\t\t})\r\n\r\n\t\tr(\"Container\", [\"itemcontainer\", \"legend\", \"stocklegend\"]).setAll({\r\n\t\t\tmarginLeft: 2,\r\n\t\t\tmarginRight: 2,\r\n\t\t\tmarginTop: 2,\r\n\t\t\tmarginBottom: 2\r\n\t\t})\r\n\r\n\t\tr(\"Label\", [\"legend\", \"value\", \"label\", \"stocklegend\"]).setAll({\r\n\t\t\twidth: null,\r\n\t\t\tpaddingRight: 5\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\").setAll({\r\n\t\t\tuseLastColorForLegendMarker: true\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"legend\", \"itemcontainer\", \"background\", \"stocklegend\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 1,\r\n\t\t\t\tcornerRadiusBL: 4,\r\n\t\t\t\tcornerRadiusBR: 4,\r\n\t\t\t\tcornerRadiusTL: 4,\r\n\t\t\t\tcornerRadiusTR: 4,\r\n\t\t\t\tshadowOffsetX: 0,\r\n\t\t\t\tshadowOffsetY: 0,\r\n\t\t\t\tshadowOpacity: 0.3,\r\n\t\t\t\tshadowBlur: 5,\r\n\t\t\t\tinteractive: true\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"shadowColor\", ic, \"alternativeBackground\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Rectangle\", [\"panelresizer\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\twidth: p100,\r\n\t\t\t\theight: 15,\r\n\t\t\t\tcenterY: p100,\r\n\t\t\t\tfillOpacity: 0,\r\n\t\t\t\tfill: ic.get(\"alternativeBackground\"),\r\n\t\t\t\tcursorOverStyle: \"row-resize\",\r\n\t\t\t\tinteractive: true\r\n\t\t\t})\r\n\r\n\t\t\trule.states.create(\"hover\", { fillOpacity: 0.07 });\r\n\t\t}\r\n\r\n\t\tr(\"Grid\", [\"renderer\", \"x\"]).setAll({\r\n\t\t\tstrokeOpacity: 0.05\r\n\t\t})\r\n\r\n\t\tr(\"Grid\", [\"renderer\", \"y\"]).setAll({\r\n\t\t\tstrokeOpacity: 0.05\r\n\t\t})\r\n\r\n\t\tr(\"Grid\", [\"renderer\", \"base\", \"y\"]).setAll({\r\n\t\t\tstrokeOpacity: 0.15\r\n\t\t})\r\n\r\n\t\tr(\"Button\", [\"zoom\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"AxisRendererY\", [\"y\"]).setAll({\r\n\t\t\topposite: true\r\n\t\t})\r\n\r\n\t\tr(\"Container\", [\"legend\", \"item\"]).setAll({\r\n\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"axis\", \"fill\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tvisible: true,\r\n\t\t\t\t//isMeasured: false,\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\tfillOpacity: 0.05,\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"fill\", ic, \"alternativeBackground\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Panel Controls\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"PanelControls\");\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tx: p100,\r\n\t\t\t\ty: 0,\r\n\t\t\t\tcenterX: p100,\r\n\t\t\t\tpaddingTop: 10,\r\n\t\t\t\tpaddingRight: 10,\r\n\t\t\t\tlayer: 30,\r\n\t\t\t\tlayout: this._root.horizontalLayout,\r\n\t\t\t\topacity: 0.5\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"hover\", { opacity: 1 });\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Control Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\tr(\"Button\", [\"control\", \"item\"]).setAll({\r\n\t\t\tpaddingTop: 1,\r\n\t\t\tpaddingBottom: 1,\r\n\t\t\tpaddingLeft: 2,\r\n\t\t\tpaddingRight: 2,\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50,\r\n\t\t\tforceHidden: true\r\n\t\t});\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Button\", [\"control\", \"item\", \"settings\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tforceHidden: false\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"background\", \"control\", \"button\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 0,\r\n\t\t\t\tstrokeOpacity: 0\r\n\t\t\t});\r\n\t\t}\r\n\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"control\", \"button\", \"icon\"]).states.create(\"hover\", {\r\n\t\t\t\tfillOpacity: 0.5\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"fill\", ic, \"secondaryButtonHover\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"control\", \"button\", \"icon\"]).states.create(\"down\", {\r\n\t\t\t\tfillOpacity: 0.5\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"fill\", ic, \"primaryButtonDown\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * PanelControls Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\tr(\"Button\", [\"panel\"]).setAll({\r\n\t\t\tscale: 1.2,\r\n\t\t\tpaddingLeft: 0,\r\n\t\t\tpaddingRight: 0,\r\n\t\t\tmarginLeft: 6\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Close Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"close\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tlet r = 5;\r\n\t\t\t\t\tdisplay.moveTo(-r, -r);\r\n\t\t\t\t\tdisplay.lineTo(r, r);\r\n\t\t\t\t\tdisplay.moveTo(-r, r);\r\n\t\t\t\t\tdisplay.lineTo(r, -r);\r\n\t\t\t\t\tdisplay.moveTo(0, 0);\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, r * 2);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Settings Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"settings\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tconst r = 10;\r\n\t\t\t\t\tconst ir = 8;\r\n\t\t\t\t\tconst spikes = 9;\r\n\t\t\t\t\tconst angleStep = 360 / spikes * $math.RADIANS / 2;\r\n\t\t\t\t\tdisplay.moveTo(r, 0)\r\n\t\t\t\t\tlet angle = 0;\r\n\t\t\t\t\tlet dAngle = 5 * $math.RADIANS;\r\n\t\t\t\t\tfor (let i = 0; i < spikes; i++) {\r\n\t\t\t\t\t\tangle += angleStep;\r\n\t\t\t\t\t\tdisplay.lineTo(r * Math.cos(angle), r * Math.sin(angle));\r\n\t\t\t\t\t\tdisplay.lineTo(ir * Math.cos(angle + dAngle), ir * Math.sin(angle + dAngle));\r\n\t\t\t\t\t\tangle += angleStep;\r\n\t\t\t\t\t\tdisplay.lineTo(ir * Math.cos(angle - dAngle), ir * Math.sin(angle - dAngle));\r\n\t\t\t\t\t\tdisplay.lineTo(r * Math.cos(angle), r * Math.sin(angle));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, 4);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Up Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"up\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tlet r = 5;\r\n\t\t\t\t\tdisplay.moveTo(0, 5);\r\n\t\t\t\t\tdisplay.lineTo(0, -5);\r\n\t\t\t\t\tdisplay.moveTo(0, -5);\r\n\t\t\t\t\tdisplay.lineTo(-5, 0);\r\n\t\t\t\t\tdisplay.moveTo(0, -5);\r\n\t\t\t\t\tdisplay.lineTo(5, 0);\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, 2 * r);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Expand Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"expand\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tlet r = 5;\r\n\t\t\t\t\tdisplay.moveTo(-5, -2);\r\n\t\t\t\t\tdisplay.lineTo(-5, -5);\r\n\t\t\t\t\tdisplay.lineTo(5, -5);\r\n\t\t\t\t\tdisplay.lineTo(5, -2);\r\n\r\n\t\t\t\t\tdisplay.moveTo(5, 2);\r\n\t\t\t\t\tdisplay.lineTo(5, 5);\r\n\t\t\t\t\tdisplay.lineTo(-5, 5);\r\n\t\t\t\t\tdisplay.lineTo(-5, 2);\r\n\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, 2 * r);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Down Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"down\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tlet r = 5;\r\n\t\t\t\t\tdisplay.moveTo(0, -5);\r\n\t\t\t\t\tdisplay.lineTo(0, 5);\r\n\t\t\t\t\tdisplay.moveTo(0, 5);\r\n\t\t\t\t\tdisplay.lineTo(-5, 0);\r\n\t\t\t\t\tdisplay.moveTo(0, 5);\r\n\t\t\t\t\tdisplay.lineTo(5, 0);\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, 2 * r);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Drawing related\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\r\n\t\t// bullet of all drawing series\r\n\t\t{\r\n\t\t\tconst rule = r(\"Container\", [\"drawing\", \"grip\"]);\r\n\t\t\trule.states.create(\"hover\", {});\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Circle\", [\"drawing\", \"grip\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 1,\r\n\t\t\t\tradius: 5\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"alternativeBackground\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Circle\", [\"drawing\", \"grip\", \"outline\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0,\r\n\t\t\t\tfillOpacity: 0,\r\n\t\t\t\tstrokeWidth: 5,\r\n\t\t\t\tradius: 7\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"hover\", {\r\n\t\t\t\tstrokeOpacity: 1,\r\n\t\t\t\tfillOpacity: 1\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"outline\", \"label\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"label\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"callout\"]).setAll({\r\n\t\t\tfillOpacity: 0,\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"outline\", \"callout\"]).setAll({\r\n\t\t\tforceHidden: false\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"series\", \"fill\", \"drawing\"])\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 0.2,\r\n\t\t\t\tvisible: true,\r\n\t\t\t\tdraggable: true\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"hover\", {\r\n\t\t\t\tfillOpacity: 0.4\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tr(\"Line\", [\"drawing\"]).setAll({\r\n\t\t\tstrokeDasharray: [2, 2],\r\n\t\t\tstrokeWidth: 1,\r\n\t\t\tdraggable: true\r\n\t\t});\r\n\r\n\t\tr(\"Line\", [\"drawing\", \"hit\"]).setAll({\r\n\t\t\tstrokeWidth: 20,\r\n\t\t\tstrokeOpacity: 0,\r\n\t\t\tstrokeDasharray: 0,\r\n\t\t\tdraggable: true\r\n\t\t});\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Line\", [\"drawing\", \"horizontal\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\tstrokeDasharray: 0\r\n\t\t\t});\r\n\r\n\t\t\tconst stateRule = rule.states.create(\"hover\", {});\r\n\t\t\tsetColor(stateRule, \"stroke\", ic, \"negative\");\r\n\t\t}\r\n\t\t{\r\n\t\t\tconst rule = r(\"Line\", [\"drawing\", \"vertical\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\tstrokeDasharray: 0\r\n\t\t\t});\r\n\r\n\t\t\tconst stateRule = rule.states.create(\"hover\", {});\r\n\t\t\tsetColor(stateRule, \"stroke\", ic, \"negative\");\r\n\t\t}\r\n\r\n\t\tr(\"Line\", [\"drawing\", \"average\"]).setAll({\r\n\r\n\t\t});\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"series\", \"fill\", \"drawing\", \"doodle\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 0\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"hover\", { fillOpacity: 0 })\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"line\", \"series\", \"stroke\", \"drawing\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\tdraggable: true\r\n\t\t\t});\r\n\r\n\t\t\tconst stateRule = rule.states.create(\"hover\", {});\r\n\t\t\tsetColor(stateRule, \"stroke\", ic, \"negative\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"drawing\", \"icon\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tcenterX: p50,\r\n\t\t\t\tcenterY: p100,\r\n\t\t\t\tstrokeOpacity: 1,\r\n\t\t\t\tstrokeWidth: 2\r\n\t\t\t});\r\n\r\n\t\t\tconst hoverRule = rule.states.create(\"hover\", {})\r\n\t\t\tsetColor(hoverRule, \"stroke\", ic, \"negative\")\r\n\t\t}\r\n\r\n\t\tr(\"Label\", [\"drawing\", \"label\"]).setAll({\r\n\t\t\tcenterX: p0,\r\n\t\t\tcenterY: p50\r\n\t\t});\r\n\r\n\t\tr(\"PointedRectangle\", [\"drawing\", \"callout\"]).setAll({\r\n\t\t\tfillOpacity: 1,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t});\r\n\r\n\t\t// resizer\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"drawing\", \"grip\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 1,\r\n\t\t\t\tfillOpacity: 1,\r\n\t\t\t\twidth: 12,\r\n\t\t\t\theight: 12\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"alternativeBackground\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"drawing\", \"grip\", \"outline\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0,\r\n\t\t\t\tfillOpacity: 0,\r\n\t\t\t\twidth: 20,\r\n\t\t\t\theight: 20\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"hover\", {\r\n\t\t\t\tfillOpacity: 0.5\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"fill\", ic, \"alternativeBackground\");\r\n\t\t}\r\n\r\n\t\tr(\"SpriteResizer\").setAll({\r\n\t\t\trotationStep: 10\r\n\t\t})\r\n\r\n\t\tr(\"RoundedRectangle\", [\"resizer\", \"grip\", \"left\"]).setAll({\r\n\t\t\tcornerRadiusBL: 0,\r\n\t\t\tcornerRadiusBR: 0,\r\n\t\t\tcornerRadiusTL: 0,\r\n\t\t\tcornerRadiusTR: 0\r\n\t\t});\r\n\r\n\t\tr(\"RoundedRectangle\", [\"resizer\", \"grip\", \"right\"]).setAll({\r\n\t\t\tcornerRadiusBL: 0,\r\n\t\t\tcornerRadiusBR: 0,\r\n\t\t\tcornerRadiusTL: 0,\r\n\t\t\tcornerRadiusTR: 0\r\n\t\t});\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Rectangle\", [\"resizer\", \"rectangle\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeDasharray: [2, 2],\r\n\t\t\t\tstrokeOpacity: 0.5,\r\n\t\t\t\tstrokeWidth: 1\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"alternativeBackground\");\r\n\t\t}\r\n\t\t{\r\n\t\t\tconst rule = r(\"Ellipse\", [\"drawing\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 1,\r\n\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\tisMeasured: false,\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\tdraggable: true,\r\n\t\t\t\tfillOpacity: 0.25\r\n\t\t\t})\r\n\r\n\t\t\tconst stateRule = rule.states.create(\"hover\", {\r\n\t\t\t\tfillOpacity: 0.5\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(stateRule, \"stroke\", ic, \"negative\");\r\n\t\t}\r\n\r\n\t\tr(\"FibonacciSeries\").setAll({\r\n\t\t\tsequence: [0, 0.236, 0.382, 0.5, 0.618, 0.768, 1, 1.618, 2.618, 3.618, 4.236],\r\n\t\t\tcolors: [\r\n\t\t\t\tcolor(0x868686),\r\n\t\t\t\tcolor(0xed483c),\r\n\t\t\t\tcolor(0x83c486),\r\n\t\t\t\tcolor(0x4fab53),\r\n\t\t\t\tcolor(0x059183),\r\n\t\t\t\tcolor(0x69b4f1),\r\n\t\t\t\tcolor(0x868686),\r\n\t\t\t\tcolor(0x3065f8),\r\n\t\t\t\tcolor(0xed483c),\r\n\t\t\t\tcolor(0x982bab),\r\n\t\t\t\tcolor(0xe22465)\r\n\t\t\t]\r\n\t\t})\r\n\r\n\t\tr(\"IconSeries\").setAll({\r\n\t\t\tsnapToData: true\r\n\t\t})\r\n\r\n\t\tr(\"Graphics\", [\"line\", \"series\", \"stroke\", \"drawing\", \"fibonacci\"]).setAll({\r\n\t\t\tforceInactive: true,\r\n\t\t\tstrokeWidth: 0.5,\r\n\t\t\tstrokeOpacity: 1\r\n\t\t});\r\n\r\n\t\tr(\"Graphics\", [\"line\", \"series\", \"fill\", \"drawing\", \"fibonacci\"]).setAll({\r\n\t\t\tforceInactive: true,\r\n\t\t\tdraggable: false\r\n\t\t});\r\n\r\n\t\tr(\"Label\", [\"fibonacci\"]).setAll({\r\n\t\t\tpopulateText: true,\r\n\t\t\ttext: \"{sequence} ({value.formatNumber('#.00')})\",\r\n\t\t\tcenterX: p100,\r\n\t\t\tcenterY: p100,\r\n\t\t\tpaddingBottom: 2,\r\n\t\t\tfontSize: \"0.8em\"\r\n\t\t})\r\n\r\n\t\tr(\"Label\", [\"fibonaccitimezone\"]).setAll({\r\n\t\t\tpopulateText: true,\r\n\t\t\ttext: \"{value}\",\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p100,\r\n\t\t\tpaddingBottom: 2,\r\n\t\t\tfontSize: \"0.8em\"\r\n\t\t})\r\n\r\n\t\tr(\"FibonacciTimezoneSeries\").setAll({\r\n\t\t\tsequence: [1, 2, 3, 5, 8, 13, 21, 34, 55, 89],\r\n\t\t\tcolors: []\r\n\t\t})\r\n\r\n\r\n\t\tr(\"Graphics\", [\"line\", \"series\", \"fill\", \"drawing\", \"fibonaccitimezone\"]).setAll({\r\n\t\t\tforceInactive: true,\r\n\t\t\tdraggable: false,\r\n\t\t\tfillOpacity: 0.1\r\n\t\t});\r\n\r\n\r\n\t\tr(\"Graphics\", [\"line\", \"series\", \"stroke\", \"drawing\", \"fibonaccitimezone\"]).setAll({\r\n\t\t\tforceInactive: true,\r\n\t\t\tstrokeWidth: 0.5,\r\n\t\t\tstrokeOpacity: 1\r\n\t\t});\r\n\r\n\r\n\t\tr(\"Grid\", [\"overbought\"]).setAll({\r\n\t\t\tstrokeOpacity: 0.3\r\n\t\t});\r\n\r\n\r\n\t\tr(\"Grid\", [\"oversold\"]).setAll({\r\n\t\t\tstrokeOpacity: 0.3,\r\n\t\t});\r\n\r\n\r\n\t\t// series fill below oversold\r\n\t\tr(\"Graphics\", [\"rsi\", \"oversold\", \"fill\"]).setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tfillOpacity: 0.2\r\n\t\t});\r\n\r\n\t\t// series fill below oversold\r\n\t\tr(\"Graphics\", [\"williamsr\", \"oversold\", \"fill\"]).setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tfillOpacity: 0.2\r\n\t\t});\r\n\r\n\t\t// series fill below oversold\r\n\t\tr(\"Graphics\", [\"commoditychannelindex\", \"oversold\", \"fill\"]).setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tfillOpacity: 0.2\r\n\t\t});\r\n\r\n\t\t// series fill above oversold\r\n\t\tr(\"Graphics\", [\"rsi\", \"overbought\", \"fill\"]).setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tfillOpacity: 0.2\r\n\t\t});\r\n\r\n\t\t// series fill above oversold\r\n\t\tr(\"Graphics\", [\"williamsr\", \"overbought\", \"fill\"]).setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tfillOpacity: 0.2\r\n\t\t});\r\n\r\n\t\tr(\"Graphics\", [\"commoditychannelindex\", \"overbought\", \"fill\"]).setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tfillOpacity: 0.2\r\n\t\t});\r\n\r\n\t\tr(\"Graphics\", [\"fill\", \"bollingerbands\", \"upper\"]).setAll({\r\n\t\t\tfillOpacity: 0.2\r\n\t\t})\r\n\r\n\t\tr(\"Graphics\", [\"fill\", \"movingaverageenvelope\", \"upper\"]).setAll({\r\n\t\t\tfillOpacity: 0.2\r\n\t\t})\r\n\r\n\t\tr(\"Graphics\", [\"series\", \"line\", \"accumulativeswingindex\"]).setAll({\r\n\t\t\tfillOpacity: 0.2,\r\n\t\t\tvisible: true\r\n\t\t})\r\n\r\n\t\tr(\"XYChart\", [\"indicator\"]).setAll({\r\n\t\t\theight: percent(30),\r\n\t\t\tminHeight: 80\r\n\t\t})\r\n\r\n\t\tr(\"AxisLabel\", [\"x\", \"indicator\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\r\n\t\tr(\"XYSeries\", [\"indicator\"]).setAll({\r\n\t\t\tlegendLabelText: \"{name}\"\r\n\t\t})\r\n\r\n\r\n\t\tr(\"LineSeries\", [\"rsi\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period},{field})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"williamsr\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"commoditychannelindex\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"stochastic\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/] [{slowColor} bold]{slow.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period},{field})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"indicator\", \"bollingerbands\"]).setAll({\r\n\t\t\tlegendValueText: \"[{lowerColor} bold]{lower.formatNumber('#.000a')}[/] [{seriesColor} bold]{valueY.formatNumber('#.000a')}[/] [{upperColor} bold]{upper.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period},{field},{standardDeviations},{type})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"movingaverage\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period},{field},{type},{offset})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"indicator\", \"movingaverageenvelope\"]).setAll({\r\n\t\t\tlegendValueText: \"[{lowerColor} bold]{lower.formatNumber('#.000a')}[/] [{seriesColor} bold]{valueY.formatNumber('#.000a')}[/] [{upperColor} bold]{upper.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period},{field},{shiftType},{shift},{type})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"accumulationdistribution\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({useVolume})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"disparityindex\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period},{field},{movingAverageType})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"chaikinmoneyflow\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"chaikinoscillator\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period},{slowPeriod})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"onbalancevolume\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName}\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"accumulativeswingindex\"]).setAll({\r\n\t\t\tlegendValueText: \"[{swingColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({limitMoveValue})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"aroon\"]).setAll({\r\n\t\t\tlegendValueText: \"[{upColor} bold]{up.formatNumber('#.000a')}[/] [{downColor} bold]{down.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period})\"\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\", [\"awesomeoscillator\"]).setAll({\r\n\t\t\tlegendValueText: \"[{oscillatorColor}; bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\", [\"volume\"]).setAll({\r\n\t\t\tlegendValueText: \"[{volumeColor}; bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\", [\"movingaveragedeviation\"]).setAll({\r\n\t\t\tlegendValueText: \"[{deviationColor}; bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"macd\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000')}[/] [{signalColor} bold]{signal.formatNumber('#.000')}[/] [bold {differenceColor}]{difference.formatNumber('#.000')}[/b]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({fastPeriod},{slowPeriod},{signalPeriod})\"\r\n\t\t})\r\n\r\n\t\tr(\"RoundedRectangle\", [\"macd\", \"difference\"]).setAll({\r\n\t\t\tfillOpacity: 0.5,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t})\r\n\r\n\t\tr(\"RoundedRectangle\", [\"series\", \"column\", \"awesomeoscillator\"]).setAll({\r\n\t\t\tfillOpacity: 0.5,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"series\", \"column\", \"volume\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 0.5,\r\n\t\t\t\tstroke: ic.get(\"background\"),\r\n\t\t\t\tstrokeOpacity: 0.2\r\n\t\t\t})\r\n\r\n\t\t\trule.adapters.add(\"fill\", (fill, target: any) => {\r\n\t\t\t\tconst dataItem = target.dataItem;\r\n\t\t\t\tif (dataItem) {\r\n\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\tif (dataContext.volumeColor != null) {\r\n\t\t\t\t\t\treturn dataContext.volumeColor;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn fill;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tr(\"RoundedRectangle\", [\"series\", \"column\", \"movingaveragedeviation\"]).setAll({\r\n\t\t\tfillOpacity: 0.5,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t})\r\n\r\n\t\t// Y Axis of indicators\r\n\t\tr(\"Grid\", [\"renderer\", \"y\", \"rsi\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"AxisLabel\", [\"renderer\", \"y\", \"rsi\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\t// Y Axis of indicators\r\n\t\tr(\"Grid\", [\"renderer\", \"y\", \"williamsr\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"AxisLabel\", [\"renderer\", \"y\", \"williamsr\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"Grid\", [\"renderer\", \"y\", \"commoditychannelindex\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"AxisLabel\", [\"renderer\", \"y\", \"commoditychannelindex\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"Grid\", [\"renderer\", \"y\", \"stochastic\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"AxisLabel\", [\"renderer\", \"y\", \"stochastic\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\r\n\t\tr(\"MovingAverage\").setAll({\r\n\t\t\tname: \"Moving Average\",\r\n\t\t\tshortName: \"MA\",\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\ttype: \"simple\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 20,\r\n\t\t\toffset: 0\r\n\t\t})\r\n\r\n\t\tr(\"MovingAverageEnvelope\").setAll({\r\n\t\t\tname: \"Moving Average Envelope\",\r\n\t\t\tshortName: \"MA ENV\",\r\n\t\t\tseriesColor: color(0xff903f),\r\n\t\t\tupperColor: color(0xffc948),\r\n\t\t\tlowerColor: color(0xffaf74),\r\n\t\t\ttype: \"simple\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 20,\r\n\t\t\toffset: 0,\r\n\t\t\tshift: 5,\r\n\t\t\tshiftType: \"percent\"\r\n\t\t})\r\n\r\n\t\tr(\"MovingAverageDeviation\").setAll({\r\n\t\t\tname: \"Moving Average Deviation\",\r\n\t\t\tshortName: \"MA Dev\",\r\n\t\t\tincreasingColor: ic.get(\"positive\"),\r\n\t\t\tdecreasingColor: ic.get(\"negative\"),\r\n\t\t\ttype: \"simple\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 20\r\n\t\t})\r\n\r\n\t\tr(\"AccumulationDistribution\").setAll({\r\n\t\t\tname: \"Accumulation/Distribution\",\r\n\t\t\tshortName: \"Accum/Dist\",\r\n\t\t\tseriesColor: color(0x707070),\r\n\t\t\tuseVolume: true\r\n\t\t})\r\n\r\n\t\tr(\"DisparityIndex\").setAll({\r\n\t\t\tname: \"Disparity Index\",\r\n\t\t\tshortName: \"Disparity\",\r\n\t\t\tseriesColor: color(0x707070),\r\n\t\t\tperiod: 14,\r\n\t\t\tfield: \"close\",\r\n\t\t\tmovingAverageType: \"simple\"\r\n\t\t})\r\n\r\n\r\n\t\tr(\"ChaikinMoneyFlow\").setAll({\r\n\t\t\tname: \"Chaikin Money Flow\",\r\n\t\t\tshortName: \"Chaikin MF\",\r\n\t\t\tseriesColor: color(0x707070),\r\n\t\t\tperiod: 20\r\n\t\t})\r\n\r\n\t\tr(\"ChaikinOscillator\").setAll({\r\n\t\t\tname: \"Chaikin Oscillator\",\r\n\t\t\tperiod: 3,\r\n\t\t\tslowPeriod: 10,\r\n\t\t\tshortName: \"Chaikin Osc\",\r\n\t\t\tseriesColor: color(0x707070)\r\n\t\t})\r\n\r\n\t\tr(\"OnBalanceVolume\").setAll({\r\n\t\t\tname: \"On Balance Volume\",\r\n\t\t\tshortName: \"On Bal Vol\",\r\n\t\t\tseriesColor: color(0x707070)\r\n\t\t})\r\n\r\n\t\tr(\"BollingerBands\").setAll({\r\n\t\t\tname: \"Bollinger Bands\",\r\n\t\t\tshortName: \"Bollinger\",\r\n\t\t\tstandardDeviations: 2,\r\n\t\t\tseriesColor: color(0xff903f),\r\n\t\t\tupperColor: color(0xffc948),\r\n\t\t\tlowerColor: color(0xffaf74)\r\n\t\t});\r\n\r\n\r\n\t\tr(\"RelativeStrengthIndex\").setAll({\r\n\t\t\tname: \"Relative Strength Index\",\r\n\t\t\tshortName: \"RSI\",\r\n\t\t\tperiod: 14,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: 20,\r\n\t\t\toverBought: 80,\r\n\t\t\toverSoldColor: color(0xe40000),\r\n\t\t\toverBoughtColor: color(0x67b7dc),\r\n\t\t\tseriesColor: color(0xab82da)\r\n\t\t})\r\n\r\n\t\tr(\"WilliamsR\").setAll({\r\n\t\t\tname: \"Williams %R\",\r\n\t\t\tshortName: \"Williams %R\",\r\n\t\t\tperiod: 14,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: -80,\r\n\t\t\toverBought: -20,\r\n\t\t\toverSoldColor: color(0xe40000),\r\n\t\t\toverBoughtColor: color(0x67b7dc),\r\n\t\t\tseriesColor: color(0xab82da)\r\n\t\t})\r\n\r\n\t\tr(\"CommodityChannelIndex\").setAll({\r\n\t\t\tname: \"Commodity Channel Index\",\r\n\t\t\tshortName: \"CCI\",\r\n\t\t\tperiod: 20,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: -100,\r\n\t\t\toverBought: 100,\r\n\t\t\toverSoldColor: color(0xe40000),\r\n\t\t\toverBoughtColor: color(0x67b7dc),\r\n\t\t\tseriesColor: color(0xab82da)\r\n\t\t})\r\n\r\n\t\tr(\"StochasticOscillator\").setAll({\r\n\t\t\tname: \"Stochastic Oscillator\",\r\n\t\t\tshortName: \"Stochastic\",\r\n\t\t\tperiod: 14,\r\n\t\t\tkSmoothing: 1,\r\n\t\t\tdSmoothing: 3,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: 20,\r\n\t\t\toverBought: 80,\r\n\t\t\tseriesColor: color(0x707070),\r\n\t\t\tslowColor: ic.get(\"negative\")\r\n\t\t})\r\n\r\n\t\tr(\"AccumulativeSwingIndex\").setAll({\r\n\t\t\tname: \"Accumulative Swing Index\",\r\n\t\t\tshortName: \"ACC Swing\",\r\n\t\t\tlimitMoveValue: 1000,\r\n\t\t\tpositiveColor: ic.get(\"positive\"),\r\n\t\t\tnegativeColor: ic.get(\"negative\")\r\n\t\t})\r\n\r\n\t\tr(\"Aroon\").setAll({\r\n\t\t\tname: \"Aroon\",\r\n\t\t\tshortName: \"Aroon\",\r\n\t\t\tperiod: 14,\r\n\t\t\tupColor: ic.get(\"positive\"),\r\n\t\t\tdownColor: ic.get(\"negative\")\r\n\t\t})\r\n\r\n\t\tr(\"AwesomeOscillator\").setAll({\r\n\t\t\tname: \"Awesome Oscillator\",\r\n\t\t\tshortName: \"Awesome\",\r\n\t\t\tincreasingColor: ic.get(\"positive\"),\r\n\t\t\tdecreasingColor: ic.get(\"negative\")\r\n\t\t});\r\n\r\n\t\tr(\"Volume\").setAll({\r\n\t\t\tname: \"Volume\",\r\n\t\t\tshortName: \"Volume\",\r\n\t\t\tincreasingColor: ic.get(\"positive\"),\r\n\t\t\tdecreasingColor: ic.get(\"negative\")\r\n\t\t});\r\n\r\n\t\tr(\"MACD\").setAll({\r\n\t\t\tname: \"MACD\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tshortName: \"MACD\",\r\n\t\t\tfastPeriod: 12,\r\n\t\t\tslowPeriod: 26,\r\n\t\t\tsignalPeriod: 9,\r\n\t\t\tincreasingColor: ic.get(\"positive\"),\r\n\t\t\tdecreasingColor: ic.get(\"negative\"),\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\tsignalColor: color(0xff903f)\r\n\t\t});\r\n\r\n\t\tr(\"Grid\", [\"cursor\", \"y\", \"indicator\"]).set(\"forceHidden\", true);\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Toolbar\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\tr(\"StockControl\").setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tactive: false\r\n\t\t});\r\n\r\n\t\tr(\"IndicatorControl\").setAll({\r\n\t\t\tname: l.translateAny(\"Indicators\"),\r\n\t\t\tindicators: [\"Aroon\", \"Accumulation Distribution\", \"Accumulative Swing Index\", \"Awesome Oscillator\", \"Bollinger Bands\", \"Chaikin Money Flow\", \"Chaikin Oscillator\", \"Commodity Channel Index\", \"Disparity Index\", \"MACD\", \"Moving Average\", \"Moving Average Deviation\", \"Moving Average Envelope\", \"On Balance Volume\", \"Relative Strength Index\", \"Stochastic Oscillator\", \"Volume\", \"Williams R\"]\r\n\t\t});\r\n\r\n\t\tr(\"ComparisonControl\").setAll({\r\n\t\t\tname: l.translateAny(\"Comparison\")\r\n\t\t});\r\n\r\n\t\tconst drawingIcons = [{\r\n\t\t\tsvgPath: \"M 5 35 L 5 15 L 26 15 L 26 5 L 45 25 L 26 45 L 26 35 L 5 35 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(100),\r\n\t\t\tcenterY: percent(50)\r\n\t\t}, {\r\n\t\t\tsvgPath: \"M 45 35 L 45 15 L 24 15 L 24 5 L 5 25 L 24 45 L 24 35 L 45 35 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(0),\r\n\t\t\tcenterY: percent(50)\r\n\t\t}, {\r\n\t\t\tsvgPath: \"M 35 5 L 15 5 L 15 26 L 5 26 L 25 45 L 45 26 L 35 26 L 35 5 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(100)\r\n\t\t}, {\r\n\t\t\tsvgPath: \"M 35 45 L 15 45 L 15 24 L 5 24 L 25 5 L 45 24 L 35 24 L 35 45 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(0)\r\n\t\t},\r\n\t\t// :)\r\n\t\t{\r\n\t\t\tsvgPath: \"M 5 25 A 1 1 0 0 0 45 25 A 1 1 0 0 0 5 25 M 14 19 A 1 1 0 0 0 19 19 A 1 1 0 0 0 14 19 M 36 19 A 1 1 0 0 0 31 19 A 1 1 0 0 0 36 19 M 16 32 C 20 39 30 39 34 32\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t},\r\n\t\t// :(\r\n\t\t{\r\n\t\t\tsvgPath: \"M 5 25 A 1 1 0 0 0 45 25 A 1 1 0 0 0 5 25 M 14 19 A 1 1 0 0 0 19 19 A 1 1 0 0 0 14 19 M 36 19 A 1 1 0 0 0 31 19 A 1 1 0 0 0 36 19 M 33 37 C 28 32 21 32 16 37\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t},\r\n\t\t// :|\r\n\t\t{\r\n\t\t\tsvgPath: \"M 5 25 A 1 1 0 0 0 45 25 A 1 1 0 0 0 5 25 M 14 19 A 1 1 0 0 0 19 19 A 1 1 0 0 0 14 19 M 36 19 A 1 1 0 0 0 31 19 A 1 1 0 0 0 36 19 M 32 35 L 18 35\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t}, {\r\n\t\t\tsvgPath: \"M 25 46 C 25 38 -6 18 10 5 C 16 1 25 3 25 10 C 25 3 34 1 40 5 C 56 18 25 38 25 46\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(100)\r\n\t\t},\r\n\t\t// Flag right\r\n\t\t{\r\n\t\t\tsvgPath: \"M 2 43 L 2 4 L 26 4 L 17 15 L 26 26 L 2 26 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(0),\r\n\t\t\tcenterY: percent(100)\r\n\t\t},\r\n\t\t// star 5\r\n\t\t{\r\n\t\t\tsvgPath: \"M 25,2 L 25,2 L 33,14 L 47,18 L 37,29 L 39,44 L 25,38 L 11,44 L 13,29 L 3,18 L 17,14 L 25,2 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t},\r\n\t\t// star 8\r\n\t\t{\r\n\t\t\tsvgPath: \"M 25,2 L 25,2 L 30,13 L 41,9 L 37,20 L 48,25 L 37,30 L 41,41 L 30,37 L 25,48 L 20,37 L 9,41 L 13,30 L 2,25 L 13,20 L 9,9 L 20,13 L 25,2 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t},\r\n\t\t// star 10\r\n\t\t{\r\n\t\t\tsvgPath: \"M 25,2 L 25,2 L 30,10 L 39,6 L 38,16 L 47,18 L 41,25 L 47,32 L 38,34 L 39,44 L 30,40 L 25,48 L 20,40 L 11,44 L 12,34 L 3,32 L 9,25 L 3,18 L 12,16 L 11,6 L 20,10 L 25,2 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tstyle: { fillOpacity: 0 }\r\n\t\t},\r\n\t\t// >>\r\n\t\t{\r\n\t\t\tsvgPath: \"M 8 8 L 25 25 L 8 42 M 20 8 L 37 25 L 20 42\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(100),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tfillDisabled: true\r\n\t\t},\r\n\t\t// <<\r\n\t\t{\r\n\t\t\tsvgPath: \"M 42 8 L 25 25 L 42 42 M 30 8 L 13 25 L 30 42\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(0),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tfillDisabled: true\r\n\t\t},\r\n\t\t// ^^\r\n\t\t{\r\n\t\t\tsvgPath: \"M 42 42 L 25 25 L 9 42 M 9 29 L 25 13 L 42 30\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(100),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tfillDisabled: true\r\n\t\t},\r\n\t\t// vv\r\n\t\t{\r\n\t\t\tsvgPath: \"M 42 8 L 25 25 L 8 8 M 8 20 L 25 37 L 42 20\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(100),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tfillDisabled: true\r\n\t\t}]\r\n\r\n\r\n\r\n\t\tr(\"DrawingControl\").setAll({\r\n\t\t\tname: l.translateAny(\"Draw\"),\r\n\t\t\ttool: \"Line\",\r\n\t\t\ttools: [\"Average\", \"Callout\", \"Doodle\", \"Ellipse\", \"Fibonacci\", \"Fibonacci Timezone\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Label\", \"Line\", \"Polyline\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"],\r\n\t\t\ttogglable: true,\r\n\t\t\tstrokeColor: color(0x882dff),\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\tstrokeWidths: [1, 2, 4, 8, 16],\r\n\t\t\tstrokeDasharray: [],\r\n\t\t\tstrokeDasharrays: [[], [2, 2], [6, 3], [8, 4, 2, 4]],\r\n\t\t\tstrokeOpacity: 1,\r\n\t\t\tshowExtension: true,\r\n\t\t\tfillColor: color(0xad6eff),\r\n\t\t\tfillOpacity: 0.5,\r\n\t\t\tlabelFill: color(0x000000),\r\n\t\t\tlabelFontSize: \"12px\",\r\n\t\t\tlabelFontSizes: [\"8px\", \"10px\", \"11px\", \"12px\", \"14px\", \"16px\", \"20px\", \"24px\", \"36px\", \"48px\"],\r\n\t\t\tlabelFontWeight: \"normal\",\r\n\t\t\tlabelFontStyle: \"normal\",\r\n\t\t\tlabelFontFamily: \"Arial\",\r\n\t\t\tlabelFontFamilies: [\"Arial\", \"Courier New\", \"Garamond\", \"Georgia\", \"Times New Roman\"],\r\n\t\t\tdrawingIcon: drawingIcons[0],\r\n\t\t\tdrawingIcons: drawingIcons,\r\n\t\t\tsnapToData: true\r\n\t\t});\r\n\r\n\t\tr(\"ColorControl\").setAll({\r\n\t\t\tuseOpacity: true\r\n\t\t});\r\n\r\n\t\tr(\"DateRangeSelector\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Date Range\")\r\n\t\t});\r\n\r\n\t\tr(\"PeriodSelector\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Period selector\"),\r\n\t\t\ttogglable: false,\r\n\t\t\ticon: \"none\",\r\n\t\t\tperiods: [\r\n\t\t\t\t//{ timeUnit: \"day\", count: 1, name: \"1\" + l.translateAny(\"D\") },\r\n\t\t\t\t{ timeUnit: \"day\", count: 5, name: \"5\" + l.translateAny(\"D\") },\r\n\t\t\t\t{ timeUnit: \"month\", count: 1, name: \"1\" + l.translateAny(\"M\") },\r\n\t\t\t\t{ timeUnit: \"month\", count: 3, name: \"3\" + l.translateAny(\"M\") },\r\n\t\t\t\t{ timeUnit: \"month\", count: 6, name: \"6\" + l.translateAny(\"M\") },\r\n\t\t\t\t{ timeUnit: \"ytd\", name: l.translateAny(\"YTD\") },\r\n\t\t\t\t{ timeUnit: \"year\", count: 1, name: \"1\" + l.translateAny(\"Y\") },\r\n\t\t\t\t{ timeUnit: \"year\", count: 2, name: \"2\" + l.translateAny(\"Y\") },\r\n\t\t\t\t{ timeUnit: \"year\", count: 5, name: \"5\" + l.translateAny(\"Y\") },\r\n\t\t\t\t{ timeUnit: \"max\", name: l.translateAny(\"Max\") },\r\n\t\t\t]\r\n\t\t});\r\n\r\n\t\t// r(\"IconControl\").setAll({\r\n\t\t// });\r\n\r\n\t\t// r(\"DrawingToolControl\").setAll({\r\n\t\t// \t//name: l.translateAny(\"Draw\"),\r\n\t\t// \t//tools: [\"Average\", \"Callout\", \"Doodle\", \"Ellipse\", \"Fibonacci\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Label\", \"Line\", \"Polyline\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"]\r\n\t\t// });\r\n\r\n\t\tr(\"DropdownListControl\").setAll({\r\n\t\t\tfixedLabel: false\r\n\t\t});\r\n\r\n\t\tr(\"DropdownList\").setAll({\r\n\t\t\tsearchable: true,\r\n\t\t\tmaxSearchItems: 10,\r\n\t\t\titems: []\r\n\t\t});\r\n\r\n\t\tr(\"ComparisonControl\").setAll({\r\n\t\t\tfixedLabel: true\r\n\t\t});\r\n\r\n\t\tr(\"SeriesTypeControl\").setAll({\r\n\t\t\tcurrentItem: \"candlestick\",\r\n\t\t\titems: [{\r\n\t\t\t\tid: \"line\",\r\n\t\t\t\tlabel: l.translateAny(\"Line\"),\r\n\t\t\t\ticon: StockIcons.getIcon(\"Line Series\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"candlestick\",\r\n\t\t\t\tlabel: l.translateAny(\"Candles\"),\r\n\t\t\t\ticon: StockIcons.getIcon(\"Candlestick Series\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"procandlestick\",\r\n\t\t\t\tlabel: l.translateAny(\"Pro Candles\"),\r\n\t\t\t\ticon: StockIcons.getIcon(\"Pro Candlestick Series\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"ohlc\",\r\n\t\t\t\tlabel: l.translateAny(\"Sticks\"),\r\n\t\t\t\ticon: StockIcons.getIcon(\"OHLC Series\")\r\n\t\t\t}]\r\n\t\t});\r\n\r\n\t\tr(\"IntervalControl\").setAll({\r\n\t\t\tcurrentItem: \"1 day\",\r\n\t\t\titems: [\r\n\t\t\t\t{ id: \"1 minute\", label: \"1 \" + l.translateAny(\"minute\"), interval: { timeUnit: \"minute\", count: 1 } },\r\n\t\t\t\t{ id: \"2 minute\", label: \"2 \" + l.translateAny(\"minutes\"), interval: { timeUnit: \"minute\", count: 2 } },\r\n\t\t\t\t{ id: \"5 minute\", label: \"5 \" + l.translateAny(\"minutes\"), interval: { timeUnit: \"minute\", count: 5 } },\r\n\t\t\t\t{ id: \"15 minute\", label: \"15 \" + l.translateAny(\"minutes\"), interval: { timeUnit: \"minute\", count: 15 } },\r\n\t\t\t\t{ id: \"30 minute\", label: \"30 \" + l.translateAny(\"minutes\"), interval: { timeUnit: \"minute\", count: 30 } },\r\n\t\t\t\t{ id: \"1 hour\", label: \"1 \" + l.translateAny(\"hour\"), interval: { timeUnit: \"hour\", count: 1 } },\r\n\t\t\t\t{ id: \"4 hour\", label: \"4 \" + l.translateAny(\"hours\"), interval: { timeUnit: \"hour\", count: 4 } },\r\n\t\t\t\t{ id: \"1 day\", label: \"1 \" + l.translateAny(\"day\"), interval: { timeUnit: \"day\", count: 1 } },\r\n\t\t\t\t{ id: \"1 week\", label: \"1 \" + l.translateAny(\"week\"), interval: { timeUnit: \"week\", count: 1 } },\r\n\t\t\t\t{ id: \"1 month\", label: \"1 \" + l.translateAny(\"month\"), interval: { timeUnit: \"month\", count: 1 } },\r\n\t\t\t\t{ id: \"1 year\", label: \"1 \" + l.translateAny(\"year\"), interval: { timeUnit: \"year\", count: 1 } }\r\n\t\t\t]\r\n\t\t});\r\n\r\n\t\tr(\"DropdownColors\").setAll({\r\n\t\t\tcolors: ColorSet.new(this._root, {\r\n\t\t\t\tcolors: [\r\n\t\t\t\t\tcolor(0x000000), color(0x464e56), color(0x5b636a), color(0x767d84), color(0xb9bdc5), color(0xe0e4e9), color(0xf7f8ff), color(0xffffff),\r\n\t\t\t\t\tcolor(0x72d3ff), color(0xad6eff), color(0xff80c5), color(0xffbd74), color(0xffe786), color(0x64f1d9), color(0xff8084), color(0x79f4bd),\r\n\t\t\t\t\tcolor(0x2bbcff), color(0x882dff), color(0xff4aad), color(0xffa33f), color(0xffdb48), color(0x22dbbc), color(0xff333a), color(0x00b061),\r\n\t\t\t\t\tcolor(0x0780eb), color(0x6500e8), color(0xc70085), color(0xe5632a), color(0xefbb00), color(0x00a19a), color(0xdc142d), color(0x009c56),\r\n\t\t\t\t\tcolor(0x0061cb), color(0x4300ac), color(0x970064), color(0xc73b0a), color(0xe09c00), color(0x006c84), color(0xae1125), color(0x00894c),\r\n\t\t\t\t]\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t\tr(\"ResetControl\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Reset\"),\r\n\t\t\ttogglable: false,\r\n\t\t\t//align: \"right\"\r\n\t\t});\r\n\r\n\t\tr(\"SettingsControl\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Settings\"),\r\n\t\t\ttogglable: true,\r\n\t\t\tfixedLabel: true,\r\n\t\t\t//align: \"right\",\r\n\t\t\titems: [{\r\n\t\t\t\tform: \"checkbox\",\r\n\t\t\t\tid: \"fills\",\r\n\t\t\t\tlabel: l.translateAny(\"Fills\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"y-scale\",\r\n\t\t\t\tlabel: l.translateAny(\"Y-axis scale\"),\r\n\t\t\t\tclassName: \"am5stock-list-info am5stock-list-heading\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"y-scale\",\r\n\t\t\t\tform: \"radio\",\r\n\t\t\t\tvalue: \"percent\",\r\n\t\t\t\tlabel: l.translateAny(\"Change percent\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"y-scale\",\r\n\t\t\t\tform: \"radio\",\r\n\t\t\t\tvalue: \"regular\",\r\n\t\t\t\tlabel: l.translateAny(\"Regular\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"y-scale\",\r\n\t\t\t\tform: \"radio\",\r\n\t\t\t\tvalue: \"logarithmic\",\r\n\t\t\t\tlabel: l.translateAny(\"Logarithmic\")\r\n\t\t\t}]\r\n\t\t});\r\n\t}\r\n}\r\n","import { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"../../../core/util/Entity\"\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport type { IPointerEvent } from \"../../../core/render/backend/Renderer\";\r\nimport type { StockToolbar } from \"./StockToolbar\";\r\nimport type { StockChart } from \"../StockChart\";\r\n\r\n//import * as $array from \"../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IStockControlSettings extends IEntitySettings {\r\n\r\n\t/**\r\n\t * A [[StockChart]] the toolbar is for.\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * Is control visible?\r\n\t * \r\n\t * @default true\r\n\t */\r\n\tvisible?: boolean;\r\n\r\n\t/**\r\n\t * Name of the control. Used for the label.\r\n\t */\r\n\tname?: string;\r\n\r\n\t/**\r\n\t * Description of what the button does.\r\n\t */\r\n\tdescription?: string;\r\n\r\n\t/**\r\n\t * An element with control icon. If not set, each control will aytomatically\r\n\t * create an icon.\r\n\t */\r\n\ticon?: HTMLElement | SVGElement | \"none\";\r\n\r\n\t/**\r\n\t * Indicates if control is active.\r\n\t * \r\n\t * @default false\r\n\t */\r\n\tactive?: boolean;\r\n\r\n\t/**\r\n\t * If set to `true`, control can be toggle on and off by clicking on it.\r\n\t * \r\n\t * @default true\r\n\t */\r\n\ttogglable?: boolean;\r\n\r\n\t/**\r\n\t * Alignment of the control in a toolbar.\r\n\t *\r\n\t * @default \"left\"\r\n\t */\r\n\talign?: \"left\" | \"right\";\r\n\r\n}\r\n\r\n\r\nexport interface IStockControlPrivate extends IEntityPrivate {\r\n\ttoolbar: StockToolbar;\r\n\tbutton?: HTMLDivElement;\r\n\ticon?: HTMLElement;\r\n\tlabel?: HTMLDivElement;\r\n}\r\n\r\nexport interface IStockControlEvents extends IEntityEvents {\r\n\tclick: {\r\n\t\toriginalEvent: IPointerEvent\r\n\t}\r\n}\r\n\r\n/**\r\n * @todo revview\r\n */\r\nexport class StockControl extends Entity {\r\n\tpublic static className: string = \"StockControl\";\r\n\tpublic static classNames: Array<string> = Entity.classNames.concat([StockControl.className]);\r\n\r\n\tdeclare public _settings: IStockControlSettings;\r\n\tdeclare public _privateSettings: IStockControlPrivate;\r\n\tdeclare public _events: IStockControlEvents;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Inherit default themes from chart\r\n\t\tthis._defaultThemes = this.get(\"stockChart\")._defaultThemes;\r\n\t\tsuper._afterNewApplyThemes();\r\n\r\n\t\tthis._initElements();\r\n\t\tthis._applyClassNames();\r\n\r\n\t\tthis._root.addDisposer(this);\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\t// Create button\r\n\t\tconst button = document.createElement(\"div\");\r\n\t\tbutton.setAttribute(\"title\", this.get(\"description\", this.get(\"name\", \"\")));\r\n\t\tthis.setPrivate(\"button\", button);\r\n\r\n\t\t// Create icon\r\n\t\tconst icon = document.createElement(\"div\");\r\n\t\ticon.appendChild(this._getIcon());\r\n\t\tif (this.get(\"icon\") == \"none\") {\r\n\t\t\ticon.style.display = \"none\";\r\n\t\t}\r\n\t\tbutton.appendChild(icon);\r\n\t\tthis.setPrivate(\"icon\", icon);\r\n\r\n\t\t// Create label\r\n\t\tconst name = this.get(\"name\", \"\");\r\n\t\tconst label = document.createElement(\"div\");\r\n\t\tlabel.innerHTML = name;\r\n\t\tif (name == \"\") {\r\n\t\t\tlabel.style.display = \"none\";\r\n\t\t}\r\n\t\tbutton.appendChild(label);\r\n\t\tthis.setPrivate(\"label\", label);\r\n\r\n\t\t// Add click event\r\n\t\tthis._disposers.push($utils.addEventListener(button, \"click\", (ev) => {\r\n\t\t\t//ev.stopImmediatePropagation();\r\n\t\t\tif (this.get(\"togglable\") != false) {\r\n\t\t\t\tthis._handleClick();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.events.isEnabled(\"click\")) {\r\n\t\t\t\tthis.events.dispatch(\"click\", {\r\n\t\t\t\t\ttype: \"click\",\r\n\t\t\t\t\ttarget: this,\r\n\t\t\t\t\toriginalEvent: <IPointerEvent>ev\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\tprotected _applyClassNames(): void {\r\n\t\tthis.getPrivate(\"button\")!.className = \"am5stock am5stock-control am5stock-control-button\";\r\n\t\tthis.getPrivate(\"label\")!.className = \"am5stock-control-label\";\r\n\t\tthis.getPrivate(\"icon\")!.className = \"am5stock-control-icon\";\r\n\t}\r\n\r\n\tprotected _getIcon(): HTMLElement | SVGElement {\r\n\t\tconst userIcon = this.get(\"icon\");\r\n\t\tif (userIcon && userIcon != \"none\") {\r\n\t\t\treturn userIcon;\r\n\t\t}\r\n\t\treturn this._getDefaultIcon();\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Default\");\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"visible\") && !this.get(\"visible\")) {\r\n\t\t\tthis.getPrivate(\"button\")!.style.display = \"none\";\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"name\")) {\r\n\t\t\tthis._setLabel(this.get(\"name\", \"\"));\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"active\")) {\r\n\t\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\t\tif (this.get(\"active\")) {\r\n\t\t\t\t$utils.addClass(button, \"am5stock-control-button-active\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$utils.removeClass(button, \"am5stock-control-button-active\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"align\")) {\r\n\t\t\tif (this.get(\"align\") == \"right\") {\r\n\t\t\t\t$utils.addClass(this.getPrivate(\"button\")!, \"am5stock-align-right\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$utils.removeClass(this.getPrivate(\"button\")!, \"am5stock-align-right\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// todo icon\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\r\n\t\t// $array.each(this._itemDisposers, (x) => {\r\n\t\t// \tx.dispose();\r\n\t\t// });\r\n\t}\r\n\r\n\tprotected _setLabel(name: string): void {\r\n\t\tconst label = this.getPrivate(\"label\")!;\r\n\t\tlabel.innerHTML = name;\r\n\t\tif (name == \"\") {\r\n\t\t\tlabel.style.display = \"none\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlabel.style.display = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tthis.getPrivate(\"button\")!.style.display = \"none\";\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tthis.getPrivate(\"button\")!.style.display = \"\";\r\n\t}\r\n\r\n\tprotected _handleClick(): void {\r\n\t\tthis.set(\"active\", !this.get(\"active\"));\r\n\t}\r\n\r\n}","import type { StockControl } from \"./StockControl\";\r\nimport { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"../../../core/util/Entity\"\r\n//import type { IDisposer } from \"../../../core/util/Disposer\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\"\r\n\r\n\r\nexport interface IDropdownSettings extends IEntitySettings {\r\n\tcontrol: StockControl;\r\n\tparent?: HTMLElement;\r\n}\r\n\r\nexport interface IDropdownPrivate extends IEntityPrivate {\r\n\tcontainer?: HTMLDivElement;\r\n\tarrow?: HTMLDivElement;\r\n}\r\n\r\nexport interface IDropdownEvents extends IEntityEvents {\r\n\topened: {};\r\n\tclosed: {};\r\n}\r\n\r\n/**\r\n * @todo revview\r\n */\r\nexport class Dropdown extends Entity {\r\n\tpublic static className: string = \"Dropdown\";\r\n\tpublic static classNames: Array<string> = Entity.classNames.concat([Dropdown.className]);\r\n\r\n\tdeclare public _settings: IDropdownSettings;\r\n\tdeclare public _privateSettings: IDropdownPrivate;\r\n\tdeclare public _events: IDropdownEvents;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Inherit default themes from chart\r\n\t\tthis._defaultThemes = this.get(\"control\")._defaultThemes;\r\n\t\tsuper._afterNewApplyThemes();\r\n\r\n\t\tthis._initElements();\r\n\t\tthis._root.addDisposer(this);\r\n\r\n\t\t// Close on ESC\r\n\t\tif ($utils.supports(\"keyboardevents\")) {\r\n\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\r\n\t\t\t\tif (this.isOpen() && ev.keyCode == 27) {\r\n\t\t\t\t\tthis.hide();\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\tthis._disposers.push($utils.addEventListener(this.getPrivate(\"container\")!, \"click\", (ev: PointerEvent) => {\r\n\t\t\tif (this.isOpen()) {\r\n\t\t\t\tev.preventDefault();\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis._disposers.push($utils.addEventListener(document, \"click\", () => {\r\n\t\t\tif (this.isOpen()) {\r\n\t\t\t\tthis.hide();\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\t// Create container\r\n\t\tconst container = document.createElement(\"div\");\r\n\t\tcontainer.className = \"am5stock-control-list-container\";\r\n\t\tthis._disposers.push($utils.addEventListener(container, \"click\", (ev) => {\r\n\t\t\tev.stopPropagation();\r\n\t\t}));\r\n\r\n\t\tthis.setPrivate(\"container\", container);\r\n\r\n\t\tconst arrow = document.createElement(\"div\");\r\n\t\tarrow.className = \"am5stock-control-list-arrow\";\r\n\t\tcontainer.appendChild(arrow);\r\n\t\tthis.setPrivate(\"arrow\", arrow);\r\n\r\n\t\tconst parent = this.get(\"parent\");\r\n\t\tif (parent) {\r\n\t\t\tparent.appendChild(container);\r\n\t\t}\r\n\r\n\t\tthis.hide();\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"parent\")) {\r\n\t\t\tconst parent = this.get(\"parent\");\r\n\t\t\tconst container = this.getPrivate(\"container\");\r\n\t\t\tif (parent && container) {\r\n\t\t\t\tparent.appendChild(container);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\t/**\r\n\t * Returns `true` if dropdown is currently open.\r\n\t * \r\n\t * @return  Dropdown open?\r\n\t */\r\n\tpublic isOpen(): boolean {\r\n\t\treturn this.getPrivate(\"container\")!.style.display != \"none\";\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tthis.getPrivate(\"container\")!.style.display = \"none\";\r\n\t\tthis.events.dispatch(\"closed\", {\r\n\t\t\ttype: \"closed\",\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tconst arrow = this.getPrivate(\"arrow\")!;\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\t\tcontainer.style.display = \"\";\r\n\r\n\t\tlet offset = 0;\r\n\t\tconst toolbar = this.get(\"control\").getPrivate(\"toolbar\");\r\n\t\tif (toolbar) {\r\n\t\t\tconst toolbarContainer = this.get(\"control\").getPrivate(\"toolbar\").get(\"container\");\r\n\t\t\toffset = Math.round(toolbarContainer.getBoundingClientRect().right - container.getBoundingClientRect().right);\r\n\t\t}\r\n\r\n\t\tif (offset < 0) {\r\n\t\t\tcontainer.style.marginLeft = offset + \"px\";\r\n\t\t\tarrow.style.marginLeft = Math.abs(offset) + \"px\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcontainer.style.marginLeft = \"\";\r\n\t\t\tarrow.style.marginLeft = \"\";\r\n\t\t}\r\n\r\n\t\tthis.events.dispatch(\"opened\", {\r\n\t\t\ttype: \"opened\",\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\tpublic toggle(): void {\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\t\tif (container.style.display == \"none\") {\r\n\t\t\tthis.show();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.hide();\r\n\t\t}\r\n\t}\r\n\r\n}","import { Color, color } from \"../../../core/util/Color\";\r\n\r\nimport { ColorSet } from \"../../../core/util/ColorSet\";\r\nimport { Dropdown, IDropdownSettings, IDropdownPrivate, IDropdownEvents } from \"./Dropdown\"\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IDropdownColorsSettings extends IDropdownSettings {\r\n\tcolors?: ColorSet;\r\n\tuseOpacity?: boolean;\r\n}\r\n\r\n\r\nexport interface IDropdownColorsPrivate extends IDropdownPrivate {\r\n\tlist?: HTMLUListElement;\r\n\tcolor?: Color;\r\n\topacity?: number;\r\n}\r\n\r\nexport interface IDropdownColorsEvents extends IDropdownEvents {\r\n\tinvoked: {\r\n\t\tcolor: Color;\r\n\t};\r\n\r\n\tinvokedOpacity: {\r\n\t\topacity: number;\r\n\t};\r\n}\r\n\r\n/**\r\n * A dropdown used for color picker control.\r\n *\r\n * Should not be used as standalone control.\r\n */\r\nexport class DropdownColors extends Dropdown {\r\n\tpublic static className: string = \"DropdownColors\";\r\n\tpublic static classNames: Array<string> = Dropdown.classNames.concat([DropdownColors.className]);\r\n\r\n\tdeclare public _settings: IDropdownColorsSettings;\r\n\tdeclare public _privateSettings: IDropdownColorsPrivate;\r\n\tdeclare public _events: IDropdownColorsEvents;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis._root.addDisposer(this);\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\r\n\t\t// Create container\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\r\n\t\t// Create list\r\n\t\tconst list = document.createElement(\"ul\");\r\n\t\tlist.className = \"am5stock-control-colors\";\r\n\t\tcontainer.appendChild(list);\r\n\t\tthis.setPrivate(\"list\", list);\r\n\r\n\t\tthis._initItems();\r\n\t}\r\n\r\n\tprotected _initItems(): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tlist.innerHTML = \"\";\r\n\r\n\t\tlet cs = this.get(\"colors\");\r\n\t\tif (!cs) {\r\n\t\t\tcs = ColorSet.new(this._root, {});\r\n\t\t}\r\n\t\tconst colors = cs.get(\"colors\", []);\r\n\t\t$array.each(colors, (item) => {\r\n\t\t\tthis.addItem(item);\r\n\t\t});\r\n\t\tthis._initOpacity();\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"colors\") || this.isDirty(\"useOpacity\") || this.isPrivateDirty(\"color\") || this.isPrivateDirty(\"opacity\")) {\r\n\t\t\tthis._initItems();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\tpublic addItem(color: Color): void {\r\n\t\tconst currentColor = this.getPrivate(\"color\") ? this.getPrivate(\"color\")!.hex : 0;\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst item = document.createElement(\"li\");\r\n\t\titem.className = \"am5stock-control-color\";\r\n\t\tif (currentColor == color.hex) {\r\n\t\t\titem.className += \" am5stock-control-active\";\r\n\t\t}\r\n\t\titem.style.background = color.toCSS();\r\n\t\tlist.appendChild(item);\r\n\r\n\t\t// Add click event\r\n\t\tthis._disposers.push($utils.addEventListener(item, \"click\", (_ev) => {\r\n\t\t\tthis.hide();\r\n\t\t\tthis.events.dispatch(\"invoked\", {\r\n\t\t\t\ttype: \"invoked\",\r\n\t\t\t\tcolor: color,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t}));\r\n\t}\r\n\r\n\tprotected _initOpacity(): void {\r\n\t\tif (this.get(\"useOpacity\")) {\r\n\t\t\tconst currentOpacity = this.getPrivate(\"opacity\", 1);\r\n\t\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\t\tconst hr = document.createElement(\"hr\");\r\n\t\t\tlist.appendChild(hr);\r\n\r\n\t\t\tfor (let opacity = 100; opacity >= 0; opacity -= 25) {\r\n\t\t\t\tconst fill = color(0x000000);\r\n\t\t\t\tconst item = document.createElement(\"li\");\r\n\t\t\t\titem.innerHTML = opacity + \"%\";\r\n\t\t\t\titem.className = \"am5stock-control-opacity am5stock-control-opacity-\" + opacity;\r\n\t\t\t\tif (currentOpacity * 100 == opacity) {\r\n\t\t\t\t\titem.className += \" am5stock-control-active\";\r\n\t\t\t\t}\r\n\t\t\t\titem.style.background = fill.toCSS(opacity / 100);\r\n\t\t\t\tlist.appendChild(item);\r\n\r\n\t\t\t\t// Add click event\r\n\t\t\t\tthis._disposers.push($utils.addEventListener(item, \"click\", (_ev) => {\r\n\t\t\t\t\tthis.hide();\r\n\t\t\t\t\tthis.events.dispatch(\"invokedOpacity\", {\r\n\t\t\t\t\t\ttype: \"invokedOpacity\",\r\n\t\t\t\t\t\topacity: opacity / 100,\r\n\t\t\t\t\t\ttarget: this\r\n\t\t\t\t\t});\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}","import type { ColorSet } from \"../../../core/util/ColorSet\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownColors } from \"./DropdownColors\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\";\r\nimport StockToolbarCSS from \"./StockToolbarCSS\";\r\n\r\nexport interface IColorControlSettings extends IStockControlSettings {\r\n\tcolors?: ColorSet;\r\n\tuseOpacity?: boolean;\r\n}\r\n\r\nexport interface IColorControlPrivate extends IStockControlPrivate {\r\n\tdropdown?: DropdownColors;\r\n\tcolor?: Color;\r\n\topacity?: number;\r\n}\r\n\r\nexport interface IColorControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\tcolor: Color\r\n\t}\r\n\tselectedOpacity: {\r\n\t\topacity: number\r\n\t}\r\n}\r\n\r\n/**\r\n * Color picker control.\r\n */\r\nexport class ColorControl extends StockControl {\r\n\tpublic static className: string = \"ColorControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([ColorControl.className]);\r\n\r\n\tdeclare public _settings: IColorControlSettings;\r\n\tdeclare public _privateSettings: IColorControlPrivate;\r\n\tdeclare public _events: IColorControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst dropdownSettings: any = {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tuseOpacity: this.get(\"useOpacity\")\r\n\t\t}\r\n\t\tif (this.get(\"colors\")) {\r\n\t\t\tdropdownSettings.colors = this.get(\"colors\");\r\n\t\t}\r\n\t\tconst dropdown = DropdownColors.new(this._root, dropdownSettings);\r\n\t\tthis.setPrivate(\"dropdown\", dropdown);\r\n\r\n\t\tdropdown.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"invoked\", (ev) => {\r\n\t\t\tthis.setPrivate(\"color\", ev.color);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\tcolor: ev.color,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"invokedOpacity\", (ev) => {\r\n\t\t\tthis.setPrivate(\"opacity\", ev.opacity);\r\n\t\t\tthis.events.dispatch(\"selectedOpacity\", {\r\n\t\t\t\ttype: \"selectedOpacity\",\r\n\t\t\t\topacity: ev.opacity,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tdropdown.setPrivate(\"color\", this.getPrivate(\"color\"));\r\n\t\t\t\tdropdown.setPrivate(\"opacity\", this.getPrivate(\"opacity\"));\r\n\t\t\t\tthis.setTimeout(() => dropdown.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdropdown.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.onPrivate(\"color\", () => {\r\n\t\t\tconst color = this.getPrivate(\"color\");\r\n\t\t\tthis.getPrivate(\"icon\")!.style.backgroundColor = color ? color.toCSS(this.getPrivate(\"opacity\", 1)) : \"\";\r\n\t\t});\r\n\r\n\t\tthis.onPrivate(\"opacity\", () => {\r\n\t\t\tconst color = this.getPrivate(\"color\");\r\n\t\t\tthis.getPrivate(\"icon\")!.style.backgroundColor = color ? color.toCSS(this.getPrivate(\"opacity\", 1)) : \"\";\r\n\t\t});\r\n\r\n\t\t// Add checkered background for showing opacity\r\n\t\tconst bg = document.createElement(\"div\");\r\n\t\tbg.className = \"am5stock-control-icon-color-bg\";\r\n\t\tthis.getPrivate(\"icon\")!.appendChild(bg);\r\n\r\n\t\tthis.loadDefaultCSS();\r\n\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\tconst icon = StockIcons.getIcon(\"Color\");\r\n\t\t$utils.addClass(icon, \"am5stock-control-icon-color\");\r\n\t\treturn icon;\r\n\t}\r\n\r\n\t/**\r\n\t * Loads the default CSS.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic loadDefaultCSS(): void {\r\n\t\tconst disposer = StockToolbarCSS($utils.getShadowRoot(this._root.dom), this._root);\r\n\t\tthis._disposers.push(disposer);\r\n\t}\r\n\r\n}\r\n","import type { Indicator, IIndicatorEditableSetting } from \"./indicators/Indicator\";\r\nimport type { StockChart } from \"./StockChart\";\r\nimport type { XYSeries } from \"../xy/series/XYSeries\";\r\n\r\nimport { CandlestickSeries } from \"../xy/series/CandlestickSeries\";\r\nimport { LineSeries } from \"../xy/series/LineSeries\";\r\nimport { Modal, IModalSettings, IModalPrivate, IModalEvents } from \"../../core/util/Modal\";\r\nimport { ColorControl } from \"./toolbar/ColorControl\";\r\n\r\nimport * as $array from \"../../core/util/Array\";\r\nimport * as $object from \"../../core/util/Object\";\r\nimport * as $utils from \"../../core/util/Utils\";\r\nimport * as $type from \"../../core/util/Type\";\r\n\r\n\r\nexport interface ISettingsModalSettings extends IModalSettings {\r\n\r\n\t/**\r\n\t * A target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n}\r\n\r\nexport interface ISettingsModalPrivate extends IModalPrivate {\r\n}\r\n\r\nexport interface ISettingsModalEvents extends IModalEvents {\r\n\r\n\t/**\r\n\t * Invoked when modal is closed/saved.\r\n\t */\r\n\tdone: {\r\n\t\tsettings?: any,\r\n\t\tsettingsTarget?: Indicator | XYSeries\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\ninterface ISeriesEditableSetting extends IIndicatorEditableSetting {\r\n\tid?: string;\r\n\ttarget?: any;\r\n\tadditionalKeys?: string[];\r\n\tcurrentValue?: any;\r\n\tinvalidateTarget?: XYSeries;\r\n}\r\n\r\n/**\r\n * Used to display a modal dialog with HTML content.\r\n */\r\nexport class SettingsModal extends Modal {\r\n\tpublic static className: string = \"SettingsModal\";\r\n\tpublic static classNames: Array<string> = Modal.classNames.concat([Modal.className]);\r\n\r\n\tdeclare public _settings: ISettingsModalSettings;\r\n\tdeclare public _privateSettings: ISettingsModalPrivate;\r\n\tdeclare public _events: ISettingsModalEvents;\r\n\r\n\tprotected _updatedSettings: { [index: string]: any } = {};\r\n\tprotected _settingsTarget?: Indicator | XYSeries;\r\n\tprotected _colorControl?: ColorControl;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\t// if (this.isDirty(\"content\")) {\r\n\t\t// \tthis.getPrivate(\"content\").innerHTML = this.get(\"content\", \"\");\r\n\t\t// }\r\n\t}\r\n\r\n\t/**\r\n\t * Opens settings modal for an [[Indicator]].\r\n\t * \r\n\t * @param  target  Target indicator\r\n\t */\r\n\tpublic openIndicator(target: Indicator): void {\r\n\t\tthis._settingsTarget = target;\r\n\t\tthis.initContent(target._editableSettings, target);\r\n\t}\r\n\r\n\t/**\r\n\t * Opens settings editing for the any [[XYSeries]].\r\n\t * \r\n\t * @param  series  target series\r\n\t */\r\n\tpublic openSeries(series: XYSeries): void {\r\n\t\tthis._settingsTarget = series;\r\n\r\n\t\tconst l = this._root.language;\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\r\n\t\tlet settings: ISeriesEditableSetting[] = [];\r\n\r\n\t\tif (series == stockChart.get(\"stockSeries\")) {\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"stockPositiveColor\",\r\n\t\t\t\tkey: \"stockPositiveColor\",\r\n\t\t\t\tname: l.translateAny(\"Increase\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: stockChart.get(\"stockPositiveColor\", this._root.interfaceColors.get(\"positive\")),\r\n\t\t\t\ttarget: stockChart\r\n\t\t\t});\r\n\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"stockNegativeColor\",\r\n\t\t\t\tkey: \"stockNegativeColor\",\r\n\t\t\t\tname: l.translateAny(\"Decrease\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: stockChart.get(\"stockNegativeColor\", this._root.interfaceColors.get(\"negative\")),\r\n\t\t\t\ttarget: stockChart\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (series == stockChart.get(\"volumeSeries\")) {\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"volumePositiveColor\",\r\n\t\t\t\tkey: \"volumePositiveColor\",\r\n\t\t\t\tname: l.translateAny(\"Increase\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: stockChart.get(\"volumePositiveColor\", this._root.interfaceColors.get(\"positive\")),\r\n\t\t\t\ttarget: stockChart\r\n\t\t\t});\r\n\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"volumeNegativeColor\",\r\n\t\t\t\tkey: \"volumeNegativeColor\",\r\n\t\t\t\tname: l.translateAny(\"Decrease\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: stockChart.get(\"volumeNegativeColor\", this._root.interfaceColors.get(\"negative\")),\r\n\t\t\t\ttarget: stockChart\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (series instanceof CandlestickSeries && series.columns.length) {\r\n\t\t\tconst column = series.columns.getIndex(0);\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"riseFromOpen.fill\",\r\n\t\t\t\tkey: \"fill\",\r\n\t\t\t\tadditionalKeys: [\"stroke\"],\r\n\t\t\t\tname: l.translateAny(\"Increase\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: column!.states.lookup(\"riseFromOpen\")!.get(\"fill\"),\r\n\t\t\t\ttarget: series.columns.template.states.create(\"riseFromOpen\", {}),\r\n\t\t\t\tinvalidateTarget: series\r\n\t\t\t});\r\n\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"dropFromOpen.fill\",\r\n\t\t\t\tkey: \"fill\",\r\n\t\t\t\tadditionalKeys: [\"stroke\"],\r\n\t\t\t\tname: l.translateAny(\"Decrease\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: column!.states.lookup(\"dropFromOpen\")!.get(\"fill\"),\r\n\t\t\t\ttarget: series.columns.template.states.create(\"dropFromOpen\", {}),\r\n\t\t\t\tinvalidateTarget: series\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (series instanceof LineSeries) {\r\n\t\t\tsettings = [{\r\n\t\t\t\tkey: \"stroke\",\r\n\t\t\t\tname: l.translateAny(\"Line\"),\r\n\t\t\t\ttype: \"color\"\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"strokeWidth\",\r\n\t\t\t\tname: l.translateAny(\"Line\"),\r\n\t\t\t\ttype: \"dropdown\",\r\n\t\t\t\toptions: [\r\n\t\t\t\t\t{ value: 1, text: \"1px\" },\r\n\t\t\t\t\t{ value: 2, text: \"2px\" },\r\n\t\t\t\t\t{ value: 4, text: \"4px\" },\r\n\t\t\t\t\t{ value: 10, text: \"10px\" }\r\n\t\t\t\t],\r\n\t\t\t\tcurrentValue: series.strokes.template.get(\"strokeWidth\", 1),\r\n\t\t\t\ttarget: series.strokes.template,\r\n\t\t\t\tinvalidateTarget: series\r\n\t\t\t}];\r\n\t\t\tif (series.fills.template.get(\"visible\")) {\r\n\t\t\t\tsettings.push({\r\n\t\t\t\t\tkey: \"fill\",\r\n\t\t\t\t\tname: l.translateAny(\"Fill\"),\r\n\t\t\t\t\ttype: \"color\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsettings = [{\r\n\t\t\t\tkey: \"stroke\",\r\n\t\t\t\tname: l.translateAny(\"Line\"),\r\n\t\t\t\ttype: \"color\"\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"fill\",\r\n\t\t\t\tname: l.translateAny(\"Fill\"),\r\n\t\t\t\ttype: \"color\"\r\n\t\t\t}];\r\n\t\t}\r\n\t\tthis.initContent(settings, series);\r\n\t}\r\n\r\n\tprivate initContent(settings: ISeriesEditableSetting[], target: any) {\r\n\t\tthis._updatedSettings = {};\r\n\t\tconst content = this.getPrivate(\"content\");\r\n\r\n\t\t// Clear\r\n\t\tthis.clear();\r\n\r\n\t\t// Title\r\n\t\tconst title = document.createElement(\"h1\");\r\n\t\ttitle.innerHTML = target.get(\"name\");\r\n\t\tcontent.appendChild(title);\r\n\r\n\t\t// Add fields\r\n\t\tconst table = document.createElement(\"div\");\r\n\t\ttable.className = \"am5-modal-table\";\r\n\t\tcontent.appendChild(table);\r\n\r\n\t\tconst settingInputs: { [index: string]: HTMLInputElement | HTMLSelectElement } = {};\r\n\t\tconst settingsWithTarget: { [index: string]: any } = {};\r\n\t\tlet prevName = \"\";\r\n\t\tlet prevLine: HTMLDivElement;\r\n\t\t$array.each(settings, (setting) => {\r\n\t\t\tconst key = this._getSettingKey(setting);\r\n\t\t\tconst keyTarget = setting.target || target;\r\n\t\t\tconst currentValue = setting.currentValue || keyTarget.get(setting.key);\r\n\r\n\t\t\tif (setting.target) {\r\n\t\t\t\tsettingsWithTarget[key] = setting;\r\n\t\t\t}\r\n\r\n\t\t\tlet element: HTMLElement | undefined;\r\n\t\t\tswitch (setting.type) {\r\n\t\t\t\tcase \"dropdown\":\r\n\t\t\t\t\telement = this.getDropdown(setting, currentValue);\r\n\t\t\t\t\tsettingInputs[key] = <HTMLSelectElement>element;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"number\":\r\n\t\t\t\t\telement = this.getNumber(setting, currentValue);\r\n\t\t\t\t\tsettingInputs[key] = <HTMLInputElement>element;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"color\":\r\n\t\t\t\t\telement = this.getColor(setting, currentValue);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"checkbox\":\r\n\t\t\t\t\telement = this.getCheckbox(setting, currentValue);\r\n\t\t\t\t\tsettingInputs[key] = <HTMLInputElement>element;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// case \"text\":\r\n\t\t\t\t// \telement = this.getText(setting, currentValue);\r\n\t\t\t\t// \tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (element) {\r\n\r\n\t\t\t\tlet line: HTMLDivElement;\r\n\t\t\t\tif (setting.name == prevName && prevLine) {\r\n\t\t\t\t\tline = prevLine;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tline = document.createElement(\"div\");\r\n\t\t\t\t\tline.className = \"am5-modal-table-row\";\r\n\t\t\t\t\ttable.appendChild(line);\r\n\r\n\t\t\t\t\tconst heading = document.createElement(\"div\");\r\n\t\t\t\t\theading.className = \"am5-modal-table-heading\";\r\n\t\t\t\t\theading.innerHTML = setting.name;\r\n\t\t\t\t\tline.appendChild(heading);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst cell = document.createElement(\"div\");\r\n\t\t\t\tcell.className = \"am5-modal-table-cell\";\r\n\t\t\t\tline.appendChild(cell);\r\n\t\t\t\tcell.appendChild(element);\r\n\r\n\t\t\t\tprevName = setting.name;\r\n\t\t\t\tprevLine = line;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Buttons\r\n\t\tconst saveButton = document.createElement(\"input\");\r\n\t\tsaveButton.type = \"button\";\r\n\t\tsaveButton.value = this._root.language.translateAny(\"Save\");\r\n\t\tsaveButton.className = \"am5-modal-button am5-modal-primary\";\r\n\t\tcontent.appendChild(saveButton);\r\n\r\n\t\t$utils.addEventListener(saveButton, \"click\", () => {\r\n\t\t\t$object.each(settingInputs, (key, element) => {\r\n\t\t\t\tif (element.type == \"checkbox\") {\r\n\t\t\t\t\tthis._updatedSettings[key] = (<HTMLInputElement>element).checked;\r\n\t\t\t\t}\r\n\t\t\t\telse if (element.type == \"number\") {\r\n\t\t\t\t\tthis._updatedSettings[key] = $type.toNumber(element.value);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._updatedSettings[key] = element.value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t$object.each(this._updatedSettings, (key, value) => {\r\n\t\t\t\tconst targetKey = (<string>key).split(\".\").pop();\r\n\t\t\t\tif ($type.isObject(value) && value.value) {\r\n\t\t\t\t\tif (value.setting && value.setting.target) {\r\n\t\t\t\t\t\tvalue.setting.target.set(targetKey, value.value);\r\n\t\t\t\t\t\tif (value.setting.additionalKeys) {\r\n\t\t\t\t\t\t\t$array.each(value.setting.additionalKeys, (additonalKey) => {\r\n\t\t\t\t\t\t\t\tvalue.setting.target.set(additonalKey, value.value);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttarget.set(targetKey, value.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (settingsWithTarget[targetKey!]) {\r\n\t\t\t\t\tsettingsWithTarget[targetKey!].target.set(targetKey, value);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttarget.set(targetKey, value);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (value.setting && value.setting.invalidateTarget) {\r\n\t\t\t\t\tvalue.setting.invalidateTarget.markDirtyValues();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.close();\r\n\t\t});\r\n\r\n\t\tconst cancelButton = document.createElement(\"input\");\r\n\t\tcancelButton.type = \"button\";\r\n\t\tcancelButton.value = this._root.language.translateAny(\"Cancel\");\r\n\t\tcancelButton.className = \"am5-modal-button am5-modal-scondary\";\r\n\t\tcontent.appendChild(cancelButton);\r\n\r\n\t\t$utils.addEventListener(cancelButton, \"click\", () => {\r\n\t\t\tthis.cancel();\r\n\t\t});\r\n\r\n\t\t// Open modal\r\n\t\tthis.open();\r\n\r\n\t}\r\n\r\n\tprivate getDropdown(setting: any, currentValue: any): HTMLSelectElement {\r\n\t\tconst element = document.createElement(\"select\");\r\n\t\t$array.each(setting.options, (option) => {\r\n\t\t\tif (option) {\r\n\t\t\t\tconst optionElement = document.createElement(\"option\");\r\n\t\t\t\tlet value;\r\n\t\t\t\tif ($type.isObject(option)) {\r\n\t\t\t\t\toptionElement.value = <string>((<any>option).value);\r\n\t\t\t\t\toptionElement.text = <string>((<any>option).text);\r\n\t\t\t\t\tvalue = ((<any>option).value);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\toptionElement.value = <string>option;\r\n\t\t\t\t\toptionElement.text = <string>option;\r\n\t\t\t\t\tvalue = option;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (value == currentValue) {\r\n\t\t\t\t\toptionElement.selected = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\telement.appendChild(optionElement);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn element;\r\n\t}\r\n\r\n\tprivate getNumber(_setting: any, currentValue: any): HTMLInputElement {\r\n\t\tconst element = document.createElement(\"input\");\r\n\t\telement.type = \"number\";\r\n\t\telement.value = currentValue;\r\n\t\telement.className = \"am5-modal-input-narrow\"\r\n\t\treturn element;\r\n\t}\r\n\r\n\tprivate getCheckbox(_setting: any, currentValue: any): HTMLInputElement {\r\n\t\tconst element = document.createElement(\"input\");\r\n\t\telement.type = \"checkbox\";\r\n\t\telement.checked = currentValue === true;\r\n\t\treturn element;\r\n\t}\r\n\r\n\tprivate getColor(setting: any, currentValue: any): HTMLDivElement {\r\n\t\tconst control = ColorControl.new(this.root, {\r\n\t\t\tstockChart: this.get(\"stockChart\"),\r\n\t\t\tuseOpacity: false\r\n\t\t});\r\n\t\tcontrol.setPrivate(\"color\", currentValue);\r\n\t\tcontrol.events.on(\"selected\", (ev) => {\r\n\t\t\tthis._updatedSettings[this._getSettingKey(setting)] = {\r\n\t\t\t\tvalue: ev.color,\r\n\t\t\t\tsetting: setting\r\n\t\t\t};\r\n\t\t});\r\n\t\tthis._disposers.push(control);\r\n\t\treturn control.getPrivate(\"button\")!;\r\n\t}\r\n\r\n\t/**\r\n\t * Closes the modal, saving settings.\r\n\t */\r\n\tpublic close(): void {\r\n\t\tsuper.close();\r\n\t\tthis.events.dispatch(\"done\", {\r\n\t\t\ttype: \"done\",\r\n\t\t\tsettings: this._updatedSettings,\r\n\t\t\tsettingsTarget: this._settingsTarget,\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Closes the modal without applying any changes.\r\n\t */\r\n\tpublic cancel(): void {\r\n\t\tsuper.cancel();\r\n\t\tthis.events.dispatch(\"done\", {\r\n\t\t\ttype: \"done\",\r\n\t\t\tsettings: null,\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Clears contents of the modal.\r\n\t */\r\n\tpublic clear(): void {\r\n\t\tconst content = this.getPrivate(\"content\");\r\n\t\tcontent.innerHTML = \"\";\r\n\t\tif (this._colorControl) {\r\n\t\t\tthis._colorControl.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _getSettingKey(setting: ISeriesEditableSetting): string {\r\n\t\treturn setting.id || setting.key;\r\n\t}\r\n\r\n}","import type { StockPanel } from \"./StockPanel\";\nimport type { StockLegend, IStockLegendDataItem } from \"./StockLegend\";\nimport type { Axis } from \"../xy/axes/Axis\";\nimport type { AxisRenderer } from \"../xy/axes/AxisRenderer\";\nimport type { BaseColumnSeries } from \"../xy/series/BaseColumnSeries\";\nimport type { IValueAxisSettings } from \"../xy/axes/ValueAxis\";\nimport type { XYSeries, IXYSeriesDataItem, IXYSeriesSettings } from \"../xy/series/XYSeries\";\nimport type { DataItem } from \"../../core/render/Component\";\nimport type { Indicator } from \"./indicators/Indicator\";\nimport type { DrawingSeries } from \"./drawing/DrawingSeries\";\n\nimport { PanelControls } from \"./PanelControls\";\nimport { StockChartDefaultTheme } from \"./StockChartDefaultTheme\";\nimport { XYChartDefaultTheme } from \"../xy/XYChartDefaultTheme\";\nimport { Container, IContainerPrivate, IContainerSettings, IContainerEvents } from \"../../core/render/Container\";\nimport { ListAutoDispose } from \"../../core/util/List\";\nimport { Rectangle } from \"../../core/render/Rectangle\";\nimport { p100, percent, Percent } from \"../../core/util/Percent\";\nimport { SettingsModal } from \"./SettingsModal\";\nimport { Color } from \"../../core/util/Color\";\nimport { registry } from \"../../core/Registry\";\n\nimport * as $array from \"../../core/util/Array\";\nimport * as $utils from \"../../core/util/Utils\";\nimport * as $object from \"../../core/util/Object\";\n\nexport interface IStockChartSettings extends IContainerSettings {\n\n\t/**\n\t * Main value series.\n\t *\n\t * This series is used to target by settings, as well as calculating\n\t * indicators, and annotations.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Setting_main_series}\n\t */\n\tstockSeries?: XYSeries;\n\n\t/**\n\t * Main volume series.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Setting_main_series}\n\t */\n\tvolumeSeries?: XYSeries;\n\n\t/**\n\t * @ignore\n\t */\n\tcomparingSeriesSettings?: Partial<IXYSeriesSettings>;\n\n\t/**\n\t * Settings to be applied to the the main value series, when chart is\n\t * switched to \"percent scale\".\n\t * \n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/percent-mode/#Configuring} for more info\n\t */\n\tpercentScaleSeriesSettings?: Partial<IXYSeriesSettings>;\n\n\t/**\n\t * Settings to be applied to the [[ValueAxis]] of the main value series,\n\t * when chart is switched to \"percent scale\".\n\t * \n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/percent-mode/#Configuring} for more info\n\t */\n\tpercentScaleValueAxisSettings?: Partial<IValueAxisSettings<AxisRenderer>>;\n\n\t/**\n\t * If set to `true`, the chart will go into \"percent scale\" when compared\n\t * series are added to chart, and will exit it when all of the comparisons\n\t * are removed.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/percent-mode/} for more info\n\t * @default true\n\t */\n\tautoSetPercentScale?: boolean;\n\n\t/**\n\t * This color will be applied to columns/candles on the main value series (series\n\t * set as `stockSeries`) where the open value is lower or equal to the close\n\t * value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Positive_negative_colors} for more info\n\t */\n\tstockPositiveColor?: Color;\n\n\t/**\n\t * This color will be applied to columns/candles on the main value series (series\n\t * set as `stockSeries`) where the open value is higher than the close value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Positive_negative_colors} for more info\n\t */\n\tstockNegativeColor?: Color;\n\n\t/**\n\t * This color will be applied to columns/candles on the main volume series (series\n\t * set as `stockSeries`) where the open value is lower or equal to the close\n\t * value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Positive_negative_colors} for more info\n\t */\n\tvolumePositiveColor?: Color;\n\n\t/**\n\t * This color will be applied to columns/candles on the main volume series (series\n\t * set as `stockSeries`) where the open value is higher than the close value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Positive_negative_colors} for more info\n\t */\n\tvolumeNegativeColor?: Color;\n\n}\n\nexport interface IStockChartPrivate extends IContainerPrivate {\n\n\t/**\n\t * A instance of [[SettingsModal]].\n\t */\n\tsettingsModal: SettingsModal;\n\n\t/**\n\t * Indicates if chart has currently have any \"compared\" series set.\n\t */\n\tcomparing?: boolean;\n\n\t/**\n\t * A list of compared series.\n\t */\n\tcomparedSeries?: XYSeries[];\n\n}\n\nexport interface IStockChartEvents extends IContainerEvents {\n\n}\n\n\n/**\n * A main class for the Stock Chart.\n *\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/} for more info\n * @important\n */\nexport class StockChart extends Container {\n\n\tpublic static className: string = \"StockChart\";\n\tpublic static classNames: Array<string> = Container.classNames.concat([StockChart.className]);\n\n\n\tdeclare public _settings: IStockChartSettings;\n\tdeclare public _privateSettings: IStockChartPrivate;\n\tdeclare public _events: IContainerEvents;\n\n\tprotected _xAxes: Array<Axis<AxisRenderer>> = [];\n\tprotected _downY?: number;\n\tprotected _upperPanel?: StockPanel;\n\tprotected _dhp?: Percent;\n\tprotected _uhp?: Percent;\n\tprotected _downResizer?: Rectangle;\n\n\t/**\n\t * A list of stock panels.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Panels} for more info\n\t */\n\tpublic readonly panels: ListAutoDispose<StockPanel> = new ListAutoDispose();\n\n\t/**\n\t * A list of indicators on chart.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\n\t */\n\tpublic readonly indicators: ListAutoDispose<Indicator> = new ListAutoDispose();\n\n\t/**\n\t * A [[Container]], resiting on top of the charts, suitable for additional\n\t * tools, like [[Scrollbar]].\n\t * \n\t * @default Container.new()\n\t */\n\tpublic readonly toolsContainer: Container = this.children.push(Container.new(this._root, { width: p100, themeTags: [] }));\n\n\t/**\n\t * A [[Container]] where all the stock panels are placed into.\n\t * \n\t * @default Container.new()\n\t */\n\tpublic readonly panelsContainer: Container = this.children.push(Container.new(this._root, { width: p100, height: p100, layout: this._root.verticalLayout, themeTags: [\"chartscontainer\"] }));\n\n\n\tprotected _afterNew() {\n\t\tthis._settings.themeTags = $utils.mergeTags(this._settings.themeTags, [\"stock\"]);\n\t\tthis._defaultThemes.push(StockChartDefaultTheme.new(this._root));\n\t\tthis._defaultThemes.push(XYChartDefaultTheme.new(this._root));\n\n\t\tconst tooltipContainer = this._root.tooltipContainer;\n\t\ttooltipContainer.set(\"themeTags\", $utils.mergeTags(tooltipContainer.get(\"themeTags\", []), [\"stock\"]));\n\n\t\tsuper._afterNew();\n\n\t\tconst children = this.panelsContainer.children;\n\t\tthis._disposers.push(this.panels.events.onAll((change) => {\n\t\t\tif (change.type === \"clear\") {\n\t\t\t\t$array.each(change.oldValues, (chart) => {\n\t\t\t\t\tthis._removePanel(chart);\n\t\t\t\t})\n\t\t\t} else if (change.type === \"push\") {\n\t\t\t\tchildren.moveValue(change.newValue);\n\t\t\t\tthis._processPanel(change.newValue);\n\t\t\t} else if (change.type === \"setIndex\") {\n\t\t\t\tchildren.setIndex(change.index, change.newValue);\n\t\t\t\tthis._processPanel(change.newValue);\n\t\t\t} else if (change.type === \"insertIndex\") {\n\t\t\t\tchildren.insertIndex(change.index, change.newValue);\n\t\t\t\tthis._processPanel(change.newValue);\n\t\t\t} else if (change.type === \"removeIndex\") {\n\t\t\t\tthis._removePanel(change.oldValue);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unknown IListEvent type\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._disposers.push(this.indicators.events.onAll((change) => {\n\t\t\tif (change.type === \"clear\") {\n\t\t\t\t$array.each(change.oldValues, (indicator) => {\n\t\t\t\t\tthis._removeIndicator(indicator);\n\t\t\t\t})\n\t\t\t} else if (change.type === \"push\") {\n\t\t\t\tthis._processIndicator(change.newValue);\n\t\t\t} else if (change.type === \"setIndex\") {\n\t\t\t\tthis._processIndicator(change.newValue);\n\t\t\t} else if (change.type === \"insertIndex\") {\n\t\t\t\tthis._processIndicator(change.newValue);\n\t\t\t} else if (change.type === \"removeIndex\") {\n\t\t\t\tthis._removeIndicator(change.oldValue);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unknown IListEvent type\");\n\t\t\t}\n\t\t}));\n\n\t\tthis.setPrivateRaw(\"settingsModal\", SettingsModal.new(this.root, {\n\t\t\tstockChart: this\n\t\t}));\n\n\t\tlet license = false;\n\t\tfor (let i = 0; i < registry.licenses.length; i++) {\n\t\t\tif (registry.licenses[i].match(/^AM5S.{5,}/i)) {\n\t\t\t\tlicense = true;\n\t\t\t}\n\t\t}\n\t\tif (!license) {\n\t\t\tthis._root._showBranding();\n\t\t}\n\t\telse {\n\t\t\tthis._root._licenseApplied();\n\t\t}\n\t}\n\n\tpublic _prepareChildren() {\n\n\t\tif (this.isDirty(\"volumeNegativeColor\") || this.isDirty(\"volumePositiveColor\")) {\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\n\t\t\tif (volumeSeries && volumeSeries.isType<BaseColumnSeries>(\"BaseColumnSeries\")) {\n\t\t\t\tvolumeSeries.columns.each((column) => {\n\t\t\t\t\tcolumn._markDirtyKey(\"fill\");\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\n\t\tif (this.isDirty(\"stockNegativeColor\") || this.isDirty(\"stockPositiveColor\")) {\n\t\t\tif (stockSeries && stockSeries.isType<BaseColumnSeries>(\"BaseColumnSeries\")) {\n\t\t\t\tconst stockNegativeColor = this.get(\"stockNegativeColor\", this._root.interfaceColors.get(\"negative\"));\n\t\t\t\tconst stockPositiveColor = this.get(\"stockPositiveColor\", this._root.interfaceColors.get(\"positive\"));\n\t\t\t\tlet previous = stockSeries.dataItems[0];\n\t\t\t\t$array.each(stockSeries.dataItems, (dataItem) => {\n\t\t\t\t\tconst column = dataItem.get(\"graphics\");\n\t\t\t\t\tif (column) {\n\t\t\t\t\t\tconst dropFromOpen = column.states.lookup(\"dropFromOpen\");\n\t\t\t\t\t\tif (dropFromOpen) {\n\t\t\t\t\t\t\tdropFromOpen.setAll({ fill: stockNegativeColor, stroke: stockNegativeColor });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst riseFromOpen = column.states.lookup(\"riseFromOpen\");\n\t\t\t\t\t\tif (riseFromOpen) {\n\t\t\t\t\t\t\triseFromOpen.setAll({ fill: stockPositiveColor, stroke: stockPositiveColor });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstockSeries._applyGraphicsStates(dataItem, previous);\n\t\t\t\t\t\tprevious = dataItem;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tstockSeries.markDirtyValues();\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"stockSeries\")) {\n\n\t\t\tif (stockSeries) {\n\t\t\t\tthis.indicators.each((indicator) => {\n\t\t\t\t\tindicator.set(\"stockSeries\", stockSeries);\n\t\t\t\t})\n\t\t\t\tconst mainChart = stockSeries.chart;\n\n\t\t\t\tif (mainChart) {\n\t\t\t\t\tconst previous = this._prevSettings.stockSeries;\n\t\t\t\t\tmainChart.series.each((series) => {\n\t\t\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\t\t\tlet s = series.get(\"series\");\n\t\t\t\t\t\t\tif (s == previous) {\n\t\t\t\t\t\t\t\tseries.set(\"series\", stockSeries);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (this.getPrivate(\"comparing\")) {\n\t\t\t\t\tthis.setPercentScale(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper._prepareChildren();\n\t}\n\n\t/**\n\t * Enables or disables percent scale mode.\n\t *\n\t * If `percentScale` is not set, it will try to determine the status on its own.\n\t *\n\t * In percent scale mode `percentScaleSeriesSettings` and `percentScaleValueAxisSettings` will\n\t * be applied to the regular series on the main panel and its Y axis.\n\t * \n\t * @param  percentScale  Comparison mode active\n\t */\n\tpublic setPercentScale(percentScale?: boolean): void {\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tconst seriesSettings = this.get(\"percentScaleSeriesSettings\");\n\t\tconst axisSettings = this.get(\"percentScaleValueAxisSettings\");\n\t\tif (stockSeries) {\n\t\t\tconst mainChart = stockSeries.chart;\n\t\t\tconst yAxis = stockSeries.get(\"yAxis\");\n\t\t\tthis._maybePrepAxisDefaults();\n\t\t\tif (mainChart) {\n\t\t\t\tconst seriesList: XYSeries[] = [];\n\t\t\t\tmainChart.series.each((series) => {\n\t\t\t\t\tif (series.get(\"yAxis\") == yAxis) {\n\t\t\t\t\t\tseriesList.push(series);\n\t\t\t\t\t\tthis._maybePrepSeriesDefaults(series);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (percentScale == undefined) {\n\t\t\t\t\tpercentScale = this.getPrivate(\"comparedSeries\", []).length > 0;\n\t\t\t\t}\n\n\t\t\t\tthis.setPrivate(\"comparing\", percentScale);\n\n\t\t\t\tif (seriesSettings) {\n\t\t\t\t\t$array.each(seriesList, (series) => {\n\t\t\t\t\t\tif (percentScale) {\n\t\t\t\t\t\t\tseries.setAll(seriesSettings);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tseries.states.apply(\"comparingDefaults\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (axisSettings) {\n\t\t\t\t\tif (percentScale) {\n\t\t\t\t\t\tyAxis.setAll(axisSettings);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tyAxis.states.apply(\"comparingDefaults\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Adds a \"compared\" series to chart. Returns the same series.\n\t *\n\t * @param   series  Compared series\n\t * @return          Compared series\n\t */\n\tpublic addComparingSeries(series: XYSeries): XYSeries {\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tif (stockSeries) {\n\t\t\tconst chart = stockSeries.chart;\n\t\t\tif (chart) {\n\t\t\t\tchart.series.push(series);\n\t\t\t}\n\n\t\t\t// Apply comparingSeriesSettings\n\t\t\tconst comparingSeriesSettings = this.get(\"comparingSeriesSettings\");\n\t\t\tif (comparingSeriesSettings) {\n\t\t\t\tseries.setAll(comparingSeriesSettings);\n\t\t\t}\n\n\t\t\tconst comparedSeries = this.getPrivate(\"comparedSeries\");\n\t\t\tif (comparedSeries) {\n\t\t\t\tcomparedSeries.push(series);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.setPrivate(\"comparedSeries\", [series]);\n\t\t\t}\n\n\t\t\tconst legendDataItem = stockSeries.get(\"legendDataItem\");\n\n\t\t\tif (legendDataItem) {\n\t\t\t\tconst legend = legendDataItem.component;\n\t\t\t\tif (legend.isType<StockLegend>(\"StockLegend\")) {\n\t\t\t\t\tlegend.data.push(series);\n\t\t\t\t\tconst ldi = series.get(\"legendDataItem\") as DataItem<IStockLegendDataItem>;\n\t\t\t\t\tif (ldi) {\n\t\t\t\t\t\tconst closeButton = ldi.get(\"closeButton\");\n\t\t\t\t\t\tcloseButton.set(\"forceHidden\", false);\n\t\t\t\t\t\tcloseButton.events.on(\"click\", () => {\n\t\t\t\t\t\t\tthis.removeComparingSeries(series);\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.get(\"autoSetPercentScale\")) {\n\t\t\t\tthis.setPercentScale(true);\n\t\t\t}\n\n\t\t}\n\t\treturn series;\n\t}\n\n\t/**\n\t * Removes compared series.\n\t * \n\t * @param  series  Compared series\n\t */\n\tpublic removeComparingSeries(series: XYSeries) {\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tif (stockSeries) {\n\t\t\tconst chart = stockSeries.chart;\n\t\t\tif (chart) {\n\t\t\t\tchart.series.removeValue(series);\n\t\t\t}\n\n\t\t\tconst comparedSeries = this.getPrivate(\"comparedSeries\");\n\t\t\tif (comparedSeries) {\n\t\t\t\t$array.remove(comparedSeries, series);\n\t\t\t\tif (comparedSeries.length == 0 && this.get(\"autoSetPercentScale\")) {\n\t\t\t\t\tthis.setPercentScale(true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tconst ldi = series.get(\"legendDataItem\") as DataItem<IStockLegendDataItem>;\n\t\tif (ldi) {\n\t\t\tconst legend = ldi.component;\n\t\t\tlegend.data.removeValue(series);\n\t\t}\n\n\t}\n\n\tprotected _maybePrepSeriesDefaults(series: XYSeries): void {\n\t\tif (!series.states.lookup(\"comparingDefaults\")) {\n\t\t\tconst seriesSettings = this.get(\"percentScaleSeriesSettings\");\n\t\t\tconst defaults: any = {};\n\t\t\t$object.each(seriesSettings, (key, _val) => {\n\t\t\t\tdefaults[key] = (<any>series).get(key);\n\t\t\t});\n\t\t\tseries.states.create(\"comparingDefaults\", defaults);\n\t\t}\n\t}\n\n\tprotected _maybePrepAxisDefaults(): void {\n\t\tconst stockSeries = this.get(\"stockSeries\")!;\n\t\tconst axis = stockSeries.get(\"yAxis\");\n\t\tif (!axis.states.lookup(\"comparingDefaults\")) {\n\t\t\tconst axisSettings = this.get(\"percentScaleValueAxisSettings\");\n\t\t\tconst defaults: any = {};\n\t\t\t$object.each(axisSettings, (key, _val) => {\n\t\t\t\tdefaults[key] = (<any>axis).get(key);\n\t\t\t});\n\t\t\taxis.states.create(\"comparingDefaults\", defaults);\n\t\t}\n\t}\n\n\tprotected _processIndicator(indicator: Indicator) {\n\t\tthis.children.push(indicator);\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tif (stockSeries) {\n\t\t\tindicator.set(\"stockSeries\", stockSeries);\n\t\t}\n\n\t\tconst volumeSeries = this.get(\"volumeSeries\");\n\t\tif (volumeSeries) {\n\t\t\tindicator.set(\"volumeSeries\", volumeSeries);\n\t\t}\n\n\t\tif (this.getPrivate(\"comparing\")) {\n\t\t\tthis.setPercentScale(true);\n\t\t}\n\n\t\tindicator.prepareData();\n\t}\n\n\tprotected _removeIndicator(indicator: Indicator) {\n\t\tthis.children.removeValue(indicator);\n\t}\n\n\tprotected _removePanel(chart: StockPanel) {\n\t\tthis.panelsContainer.children.removeValue(chart);\n\t}\n\n\tpublic _updateControls() {\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tthis.panels.each((panel) => {\n\t\t\tconst panelControls = panel.panelControls;\n\t\t\tconst index = this.panelsContainer.children.indexOf(panel);\n\t\t\tconst len = this.panels.length;\n\n\t\t\tpanelControls.upButton.setPrivate(\"visible\", false);\n\t\t\tpanelControls.downButton.setPrivate(\"visible\", false);\n\t\t\tpanelControls.expandButton.setPrivate(\"visible\", false);\n\t\t\tpanelControls.closeButton.setPrivate(\"visible\", false);\n\n\t\t\tif (len > 1) {\n\t\t\t\tpanelControls.expandButton.setPrivate(\"visible\", true);\n\n\t\t\t\tif (index != 0) {\n\t\t\t\t\tpanelControls.upButton.setPrivate(\"visible\", true);\n\t\t\t\t}\n\t\t\t\tif (index != len - 1) {\n\t\t\t\t\tpanelControls.downButton.setPrivate(\"visible\", true);\n\t\t\t\t}\n\n\t\t\t\tif (!stockSeries || stockSeries.chart != panel) {\n\t\t\t\t\tpanelControls.closeButton.setPrivate(\"visible\", true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (stockSeries) {\n\t\t\t\tthis.indicators.each((indicator) => {\n\t\t\t\t\tindicator.set(\"stockSeries\", stockSeries);\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\n\t}\n\n\tprotected _processPanel(panel: StockPanel) {\n\n\t\tpanel.setPrivate(\"otherCharts\", this.panels.values);\n\t\tpanel.setPrivate(\"stockChart\", this);\n\t\tpanel.panelControls = panel.topPlotContainer.children.push(PanelControls.new(this._root, { stockPanel: panel, stockChart: this }));\n\t\tthis._updateControls();\n\n\t\tif (this.panels.length > 1) {\n\t\t\tconst resizer = panel.children.push(Rectangle.new(this._root, { themeTags: [\"panelresizer\"] }))\n\t\t\tresizer.events.on(\"pointerdown\", (e) => {\n\t\t\t\tconst chartsContainer = this.panelsContainer;\n\t\t\t\tthis._downResizer = e.target;\n\t\t\t\tthis.panels.each((chart) => {\n\t\t\t\t\tchart.set(\"height\", percent(chart.height() / chartsContainer.height() * 100))\n\t\t\t\t})\n\n\t\t\t\tthis._downY = chartsContainer.toLocal(e.point).y;\n\n\t\t\t\tconst upperChart = this.panels.getIndex(this.panels.indexOf(panel) - 1);\n\t\t\t\tthis._upperPanel = upperChart;\n\t\t\t\tif (upperChart) {\n\t\t\t\t\tthis._uhp = upperChart.get(\"height\") as Percent;\n\t\t\t\t}\n\n\t\t\t\tthis._dhp = panel.get(\"height\") as Percent;\n\t\t\t})\n\n\t\t\tresizer.events.on(\"pointerup\", () => {\n\t\t\t\tthis._downResizer = undefined;\n\t\t\t})\n\n\t\t\tresizer.events.on(\"globalpointermove\", (e) => {\n\t\t\t\tif (e.target == this._downResizer) {\n\t\t\t\t\tconst chartsContainer = this.panelsContainer;\n\t\t\t\t\tconst height = chartsContainer.height();\n\t\t\t\t\tconst upperChart = this._upperPanel;\n\n\t\t\t\t\tif (upperChart) {\n\t\t\t\t\t\tconst index = this.panels.indexOf(upperChart) + 2\n\t\t\t\t\t\tlet max = height - panel.get(\"minHeight\", 0);\n\t\t\t\t\t\tconst lowerChart = this.panels.getIndex(index);\n\t\t\t\t\t\tif (lowerChart) {\n\t\t\t\t\t\t\tmax = lowerChart.y() - panel.get(\"minHeight\", 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//console.log(upperChart.get(\"minHeight\", 0))\n\t\t\t\t\t\tconst y = Math.max(upperChart.y() + upperChart.get(\"minHeight\", 0) + upperChart.get(\"paddingTop\", 0), Math.min(chartsContainer.toLocal(e.point).y, max));\n\n\t\t\t\t\t\tconst downY = this._downY;\n\t\t\t\t\t\tconst dhp = this._dhp;\n\t\t\t\t\t\tconst uhp = this._uhp;\n\t\t\t\t\t\tif (downY != null && dhp != null && uhp != null) {\n\t\t\t\t\t\t\tconst diff = (downY - y) / height;\n\t\t\t\t\t\t\tpanel.set(\"height\", percent((dhp.value + diff) * 100));\n\t\t\t\t\t\t\tupperChart.set(\"height\", percent((uhp.value - diff) * 100))\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t\tpanel.xAxes.events.onAll((change) => {\n\t\t\tif (change.type === \"clear\") {\n\t\t\t\t$array.each(change.oldValues, (axis) => {\n\t\t\t\t\tthis._removeXAxis(axis);\n\t\t\t\t})\n\t\t\t} else if (change.type === \"push\") {\n\t\t\t\tthis._processXAxis(change.newValue);\n\t\t\t} else if (change.type === \"setIndex\") {\n\t\t\t\tthis._processXAxis(change.newValue);\n\t\t\t} else if (change.type === \"insertIndex\") {\n\t\t\t\tthis._processXAxis(change.newValue);\n\t\t\t} else if (change.type === \"removeIndex\") {\n\t\t\t\tthis._removeXAxis(change.oldValue);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unknown IListEvent type\");\n\t\t\t}\n\t\t})\n\n\t\tpanel.leftAxesContainer.events.on(\"boundschanged\", () => {\n\t\t\tthis._syncYAxesSize();\n\t\t})\n\n\t\tpanel.rightAxesContainer.events.on(\"boundschanged\", () => {\n\t\t\tthis._syncYAxesSize();\n\t\t})\n\n\t}\n\n\tprotected _syncYAxesSize() {\n\t\tvar maxLeft = 0;\n\t\tvar maxRight = 0;\n\t\tthis.panels.each((chart) => {\n\t\t\tlet lw = chart.leftAxesContainer.width();\n\t\t\tlet rw = chart.rightAxesContainer.width();\n\t\t\tif (lw > maxLeft) {\n\t\t\t\tmaxLeft = lw;\n\t\t\t}\n\t\t\tif (rw > maxRight) {\n\t\t\t\tmaxRight = rw;\n\t\t\t}\n\t\t})\n\t\tthis.panels.each((chart) => {\n\t\t\tchart.leftAxesContainer.set(\"minWidth\", maxLeft);\n\t\t\tchart.rightAxesContainer.set(\"minWidth\", maxRight);\n\t\t})\n\n\t\tthis.toolsContainer.set(\"paddingRight\", maxRight);\n\t\tthis.toolsContainer.set(\"paddingRight\", maxRight);\n\t}\n\n\tprotected _removeXAxis(_axis: Axis<AxisRenderer>) {\n\n\t}\n\n\tprotected _processXAxis(axis: Axis<AxisRenderer>) {\n\t\t$array.move(this._xAxes, axis);\n\t\taxis.on(\"start\", () => {\n\t\t\tif (axis._skipSync != true) {\n\t\t\t\tthis._syncXAxes(axis);\n\t\t\t}\n\t\t})\n\t\taxis.on(\"end\", () => {\n\t\t\tif (axis._skipSync != true) {\n\t\t\t\tthis._syncXAxes(axis);\n\t\t\t}\n\t\t})\n\t}\n\n\tprotected _syncXAxes(axis: Axis<AxisRenderer>) {\n\t\t$array.each(this._xAxes, (xAxis) => {\n\t\t\tif (xAxis != axis) {\n\t\t\t\txAxis._skipSync = true;\n\t\t\t\txAxis.set(\"start\", axis.get(\"start\"));\n\t\t\t\txAxis.set(\"end\", axis.get(\"end\"));\n\t\t\t\txAxis._skipSync = false;\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic getVolumeColor(dataItem: DataItem<IXYSeriesDataItem>, negativeColor?: Color, positiveColor?: Color): Color | undefined {\n\t\tif (dataItem) {\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\t\tconst volumeSeries = dataItem.component;\n\n\t\t\tif (!negativeColor) {\n\t\t\t\tnegativeColor = this.get(\"volumeNegativeColor\", this.root.interfaceColors.get(\"negative\", Color.fromHex(0xff0000)));\n\t\t\t}\n\n\t\t\tif (!positiveColor) {\n\t\t\t\tpositiveColor = this.get(\"volumePositiveColor\", this.root.interfaceColors.get(\"positive\", Color.fromHex(0x00FF00)));\n\t\t\t}\n\n\t\t\tif (stockSeries && volumeSeries) {\n\t\t\t\tconst index = volumeSeries.dataItems.indexOf(dataItem);\n\t\t\t\tif (index > 0) {\n\t\t\t\t\tlet stockDataItem = stockSeries.dataItems[index];\n\t\t\t\t\tif (stockDataItem) {\n\t\t\t\t\t\tlet close = stockDataItem.get(\"valueY\");\n\t\t\t\t\t\tif (close != null) {\n\t\t\t\t\t\t\tfor (let i = index - 1; i >= 0; i--) {\n\t\t\t\t\t\t\t\tlet di = stockSeries.dataItems[i];\n\t\t\t\t\t\t\t\tlet previousClose = di.get(\"valueY\");\n\n\t\t\t\t\t\t\t\tif (previousClose != null) {\n\t\t\t\t\t\t\t\t\tif (close < previousClose) {\n\t\t\t\t\t\t\t\t\t\treturn negativeColor;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\treturn positiveColor;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn positiveColor;\n\t}\n}\n","import type { XYSeries, IXYSeriesDataItem } from \"../../xy/series/XYSeries\";\r\nimport type { StockLegend } from \"../StockLegend\";\r\nimport type { StockChart } from \"../StockChart\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { Container, IContainerSettings, IContainerPrivate, IContainerEvents } from \"../../../core/render/Container\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport { BaseColumnSeries } from \"../../xy/series/BaseColumnSeries\";\r\nimport { MultiDisposer } from \"../../../core/util/Disposer\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IIndicatorEditableSetting {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tkey: string;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tname: string;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\ttype: \"color\" | \"number\" | \"dropdown\" | \"checkbox\";\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\toptions?: Array<string | { value: number | string, text: string }>;\r\n}\r\n\r\nexport interface IIndicatorSettings extends IContainerSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tstockChart: StockChart;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tstockSeries: XYSeries;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tvolumeSeries?: XYSeries;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tlegend?: StockLegend;\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tperiod?: number;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tfield?: \"open\" | \"close\" | \"low\" | \"high\" | \"hl/2\" | \"hlc/3\" | \"hlcc/4\" | \"ohlc/4\";\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tname?: string;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tshortName?: string;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tseriesColor?: Color;\r\n}\r\n\r\nexport interface IIndicatorPrivate extends IContainerPrivate {\r\n}\r\n\r\nexport interface IIndicatorEvents extends IContainerEvents {\r\n\r\n}\r\n\r\n/**\r\n * Base class for [[StockChart]] indicators.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport abstract class Indicator extends Container {\r\n\tpublic static className: string = \"Indicator\";\r\n\tpublic static classNames: Array<string> = Container.classNames.concat([Indicator.className]);\r\n\r\n\tdeclare public _settings: IIndicatorSettings;\r\n\tdeclare public _privateSettings: IIndicatorPrivate;\r\n\tdeclare public _events: IIndicatorEvents;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [];\r\n\r\n\tpublic series!: XYSeries;\r\n\r\n\tprotected _dataDirty = false;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.set(\"position\", \"absolute\");\r\n\t}\r\n\r\n\tprotected _sDP?: MultiDisposer;\r\n\tprotected _vDP?: MultiDisposer;\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tsuper._prepareChildren();\r\n\r\n\t\tif (this.isDirty(\"stockSeries\") || this.isDirty(\"volumeSeries\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst previousS = this._prevSettings.stockSeries;\r\n\t\t\tif (previousS && this._sDP) {\r\n\t\t\t\tthis._sDP.dispose();\r\n\t\t\t}\r\n\t\t\tif (stockSeries) {\r\n\t\t\t\tthis._sDP = new MultiDisposer([\r\n\t\t\t\t\tstockSeries.events.on(\"datavalidated\", () => {\r\n\t\t\t\t\t\tthis.markDataDirty();\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tstockSeries.events.on(\"datasetchanged\", () => {\r\n\t\t\t\t\t\tthis.markDataDirty();\r\n\t\t\t\t\t})\r\n\t\t\t\t])\r\n\t\t\t}\r\n\r\n\t\t\tconst previousV = this._prevSettings.volumeSeries;\r\n\t\t\tif (previousV && this._vDP) {\r\n\t\t\t\tthis._vDP.dispose();\r\n\t\t\t}\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tif (volumeSeries) {\r\n\t\t\t\tthis._vDP = new MultiDisposer([\r\n\t\t\t\t\tvolumeSeries.events.on(\"datavalidated\", () => {\r\n\t\t\t\t\t\tthis.markDataDirty();\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tvolumeSeries.events.on(\"datasetchanged\", () => {\r\n\t\t\t\t\t\tthis.markDataDirty();\r\n\t\t\t\t\t})\r\n\t\t\t\t])\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"field\")) {\r\n\t\t\tif (this.get(\"field\")) {\r\n\t\t\t\tthis._dataDirty = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"period\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t\tthis.setCustomData(\"period\", this.get(\"period\"));\r\n\t\t}\r\n\r\n\t\tif (this._dataDirty) {\r\n\t\t\tthis.prepareData();\r\n\t\t\tthis._dataDirty = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected markDataDirty() {\r\n\t\tthis._dataDirty = true;\r\n\t\tthis.markDirty();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"seriesColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.series, this.get(\"seriesColor\"), \"seriesColor\");\r\n\t\t}\r\n\r\n\t\tthis.setCustomData(\"period\", this.get(\"period\"));\r\n\t\tthis.setCustomData(\"field\", this.get(\"field\"));\r\n\t\tthis.setCustomData(\"name\", this.get(\"name\"));\r\n\t\tthis.setCustomData(\"shortName\", this.get(\"shortName\"));\r\n\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tsuper._dispose();\r\n\t\tif (this._sDP) {\r\n\t\t\tthis._sDP.dispose();\r\n\t\t}\r\n\t\tif (this._vDP) {\r\n\t\t\tthis._vDP.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleLegend(series: XYSeries) {\r\n\t\tconst legend = this.get(\"legend\");\r\n\t\tif (legend) {\r\n\t\t\tlegend.data.push(series);\r\n\r\n\t\t\tvar legendDataItem = legend.dataItems[legend.dataItems.length - 1];\r\n\t\t\tlegendDataItem.get(\"marker\").set(\"forceHidden\", true);\r\n\r\n\t\t\tvar closeButton = legendDataItem.get(\"closeButton\");\r\n\t\t\tcloseButton.set(\"forceHidden\", false);\r\n\t\t\tcloseButton.events.on(\"click\", () => {\r\n\t\t\t\tthis.dispose();\r\n\t\t\t})\r\n\r\n\t\t\tvar settingsButton = legendDataItem.get(\"settingsButton\");\r\n\t\t\tsettingsButton.setPrivate(\"customData\", this);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateSeriesColor(series?: XYSeries, color?: Color, contextName?: string) {\r\n\t\tif (series) {\r\n\t\t\tseries.set(\"stroke\", color);\r\n\t\t\tseries.set(\"fill\", color);\r\n\t\t\tif (series instanceof LineSeries) {\r\n\t\t\t\tseries.strokes.template.set(\"stroke\", color);\r\n\t\t\t}\r\n\r\n\t\t\tif (series instanceof BaseColumnSeries) {\r\n\t\t\t\tseries.columns.template.setAll({ stroke: color, fill: color });\r\n\t\t\t}\r\n\r\n\t\t\tif (contextName && color) {\r\n\t\t\t\tthis.setCustomData(contextName, color.toCSSHex());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tpublic setCustomData(name: string, value?: any) {\r\n\t\tconst customData = this.series.getPrivate(\"customData\");\r\n\t\tif (customData) {\r\n\t\t\tcustomData[name] = value;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\r\n\t}\r\n\r\n\tprotected _getValue(dataItem: DataItem<IXYSeriesDataItem>): number | undefined {\r\n\t\tconst field = this.get(\"field\");\r\n\r\n\t\tlet o = dataItem.get(\"openValueY\") as number;\r\n\t\tlet h = dataItem.get(\"highValueY\") as number;\r\n\t\tlet l = dataItem.get(\"lowValueY\") as number;\r\n\t\tlet c = dataItem.get(\"valueY\") as number;\r\n\r\n\t\tswitch (field) {\r\n\t\t\tcase \"close\":\r\n\t\t\t\treturn c;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"open\":\r\n\t\t\t\treturn o;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"high\":\r\n\t\t\t\treturn h;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"low\":\r\n\t\t\t\treturn l;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"hl/2\":\r\n\t\t\t\treturn (h + l) / 2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"hlc/3\":\r\n\t\t\t\treturn (h + l + c) / 3;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"hlcc/4\":\r\n\t\t\t\treturn (h + l + c + c) / 4;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"ohlc/4\":\r\n\t\t\t\treturn (o + h + l + c) / 4;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tprotected _getDataArray(dataItems: Array<DataItem<any>>): Array<any> {\r\n\t\tconst data: Array<any> = [];\r\n\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\tdata.push({ valueX: dataItem.get(\"valueX\"), value_y: this._getValue(dataItem) });\r\n\t\t})\r\n\t\treturn data;\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tprotected _getTypicalPrice(dataItems: Array<DataItem<any>>): Array<any> {\r\n\t\tconst data: Array<any> = [];\r\n\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\tdata.push({ valueX: dataItem.get(\"valueX\"), value_y: (dataItem.get(\"valueY\", 0) + dataItem.get(\"highValueY\", 0) + dataItem.get(\"lowValueY\", 0)) / 2 });\r\n\t\t})\r\n\t\treturn data;\r\n\t}\r\n\r\n\tprotected _sma(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet index = 0;\r\n\t\tlet ma = 0;\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet value = dataItem[field];\r\n\t\t\tif (value != null) {\r\n\t\t\t\ti++;\r\n\t\t\t\tma += value / period;\r\n\r\n\t\t\t\tif (i >= period) {\r\n\t\t\t\t\tif (i > period) {\r\n\t\t\t\t\t\tlet valueToRemove = data[index - period][field];\r\n\t\t\t\t\t\tif (valueToRemove != null) {\r\n\t\t\t\t\t\t\tma -= valueToRemove / period;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdataItem[toField] = ma;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tindex++;\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _wma(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet index = 0;\r\n\t\tlet ma = 0;\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet value = dataItem[field];\r\n\t\t\tif (value != null) {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i >= period) {\r\n\t\t\t\t\tlet sum = 0;\r\n\t\t\t\t\tlet m = 0;\r\n\t\t\t\t\tlet count = 0;\r\n\t\t\t\t\tlet k = 0\r\n\t\t\t\t\tfor (let n = index; n >= 0; n--) {\r\n\t\t\t\t\t\tlet pValue = data[n][field];\r\n\r\n\t\t\t\t\t\tif (pValue != null) {\r\n\t\t\t\t\t\t\tsum += pValue * (period - m);\r\n\t\t\t\t\t\t\tcount += (period - m);\r\n\t\t\t\t\t\t\tk++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tm++;\r\n\r\n\t\t\t\t\t\tif (k == period) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tma = sum / count;\r\n\t\t\t\t\tdataItem[toField] = ma;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tindex++;\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _ema(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet ma = 0;\r\n\t\tlet multiplier = 2 / (1 + period);\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet value = dataItem[field];\r\n\t\t\tif (value != null) {\r\n\t\t\t\ti++;\r\n\r\n\t\t\t\tif (i > period) {\r\n\t\t\t\t\tma = value * multiplier + ma * (1 - multiplier);\r\n\t\t\t\t\tdataItem[toField] = ma;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tma += value / period;\r\n\t\t\t\t\tif (i == period) {\r\n\t\t\t\t\t\tdataItem[toField] = ma;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _dema(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet ema2 = 0;\r\n\t\tlet multiplier = 2 / (1 + period);\r\n\r\n\t\tthis._ema(data, period, field, \"ema\");\r\n\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet ema = dataItem.ema;\r\n\t\t\tif (ema != null) {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i > period) {\r\n\t\t\t\t\tema2 = ema * multiplier + ema2 * (1 - multiplier);\r\n\t\t\t\t\tdataItem[toField] = 2 * ema - ema2;\r\n\t\t\t\t\tdataItem.ema2 = ema2;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tema2 += ema / period;\r\n\t\t\t\t\tif (i == period) {\r\n\t\t\t\t\t\tdataItem[toField] = 2 * ema - ema2;\r\n\t\t\t\t\t\tdataItem.ema2 = ema2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _tema(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet ema3 = 0;\r\n\t\tlet multiplier = 2 / (1 + period);\r\n\r\n\t\tthis._dema(data, period, field, \"dema\");\r\n\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet ema = dataItem.ema;\r\n\t\t\tlet ema2 = dataItem.ema2;\r\n\r\n\t\t\tif (ema2 != null) {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i > period) {\r\n\t\t\t\t\tema3 = ema2 * multiplier + ema3 * (1 - multiplier);\r\n\t\t\t\t\tdataItem[toField] = 3 * ema - 3 * ema2 + ema3;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tema3 += ema2 / period;\r\n\t\t\t\t\tif (i == period) {\r\n\t\t\t\t\t\tdataItem[toField] = 3 * ema - 3 * ema2 + ema3;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}","import type { DataItem } from \"../../core/render/Component\";\r\nimport type { StockChart } from \"./StockChart\";\r\nimport type { StockPanel } from \"./StockPanel\";\r\n\r\nimport { Legend, ILegendPrivate, ILegendSettings, ILegendEvents, ILegendDataItem } from \"../../core/render/Legend\";\r\nimport { Button } from \"../../core/render/Button\";\r\nimport { Graphics } from \"../../core/render/Graphics\";\r\nimport { Template } from \"../../core/util/Template\";\r\nimport { ListTemplate } from \"../../core/util/List\";\r\nimport { Indicator } from \"./indicators/Indicator\";\r\n\r\nimport * as $utils from \"../../core/util/Utils\";\r\n\r\nexport interface IStockLegendDataItem extends ILegendDataItem {\r\n\r\n\t/**\r\n\t * Legend item \"close\" [[Button]].\r\n\t */\r\n\tcloseButton: Button;\r\n\r\n\t/**\r\n\t * Legend item \"settings\" [[Button]].\r\n\t */\r\n\tsettingsButton: Button;\r\n\r\n\t/**\r\n\t * Target [[StockPanel]] legend item is attached to.\r\n\t */\r\n\tpanel: StockPanel;\r\n\r\n}\r\n\r\n\r\nexport interface IStockLegendSettings extends ILegendSettings {\r\n\r\n\t/**\r\n\t * A target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n}\r\n\r\nexport interface IStockLegendPrivate extends ILegendPrivate {\r\n}\r\n\r\nexport interface IStockLegendEvents extends ILegendEvents {\r\n}\r\n\r\n/**\r\n * A legend, specifically designed for use in a [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Legend} for more info\r\n * @important\r\n */\r\nexport class StockLegend extends Legend {\r\n\r\n\tpublic static className: string = \"StockLegend\";\r\n\tpublic static classNames: Array<string> = Legend.classNames.concat([StockLegend.className]);\r\n\r\n\tdeclare public _settings: IStockLegendSettings;\r\n\tdeclare public _privateSettings: IStockLegendPrivate;\r\n\tdeclare public _events: IStockLegendEvents;\r\n\tdeclare public _dataItemSettings: IStockLegendDataItem;\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._settings.themeTags = $utils.mergeTags(this._settings.themeTags, [\"stocklegend\"]);\r\n\t\tsuper._afterNew();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeCloseButton(): Button {\r\n\t\tconst button = this.closeButtons.make();\r\n\t\tthis.closeButtons.push(button);\r\n\t\treturn button;\r\n\t}\r\n\r\n\t/**\r\n\t * A list of \"close\" buttons in legend items.\r\n\t *\r\n\t * @default new ListTemplate<Button>()\r\n\t */\r\n\tpublic readonly closeButtons: ListTemplate<Button> = new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Button._new(this._root, {\r\n\t\t\tthemeTags: $utils.mergeTags(this.closeButtons.template.get(\"themeTags\", []), [\"control\", \"close\"]),\r\n\t\t\ticon: Graphics.new(this._root, {\r\n\t\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t\t})\r\n\t\t}, [this.closeButtons.template])\r\n\t);\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeSettingsButton(): Button {\r\n\t\tconst button = this.settingsButtons.make();\r\n\t\tthis.settingsButtons.push(button);\r\n\r\n\t\tbutton.events.on(\"click\", () => {\r\n\r\n\t\t\tconst dataItem = button.dataItem as DataItem<IStockLegendDataItem>;\r\n\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\t\tif (stockChart) {\r\n\t\t\t\t\tconst indicator = button.getPrivate(\"customData\");\r\n\t\t\t\t\tif (indicator instanceof Indicator) {\r\n\t\t\t\t\t\tstockChart.getPrivate(\"settingsModal\").openIndicator(indicator);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tstockChart.getPrivate(\"settingsModal\").openSeries(dataItem.dataContext as any);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn button;\r\n\t}\r\n\r\n\t/**\r\n\t * A list of \"settings\" buttons in legend items.\r\n\t *\r\n\t * @default new ListTemplate<Button>()\r\n\t */\r\n\tpublic readonly settingsButtons: ListTemplate<Button> = new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Button._new(this._root, {\r\n\t\t\tthemeTags: $utils.mergeTags(this.settingsButtons.template.get(\"themeTags\", []), [\"control\", \"settings\"]),\r\n\t\t\ticon: Graphics.new(this._root, {\r\n\t\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t\t})\r\n\t\t}, [this.settingsButtons.template])\r\n\t);\r\n\r\n\r\n\tprotected processDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.processDataItem(dataItem);\r\n\r\n\t\tconst itemContainer = dataItem.get(\"itemContainer\");\r\n\r\n\t\tconst settingsButton = this.makeSettingsButton();\r\n\t\titemContainer.children.push(settingsButton);\r\n\t\tsettingsButton._setDataItem(dataItem);\r\n\t\tdataItem.set(\"settingsButton\", settingsButton);\r\n\r\n\t\tconst closeButton = this.makeCloseButton();\r\n\t\titemContainer.children.push(closeButton);\r\n\t\tcloseButton._setDataItem(dataItem);\r\n\t\tdataItem.set(\"closeButton\", closeButton);\r\n\t}\r\n}\r\n","import type { PanelControls } from \"./PanelControls\";\r\nimport type { StockChart } from \"./StockChart\"\r\n\r\nimport { XYChart, IXYChartPrivate, IXYChartSettings } from \"../xy/XYChart\";\r\nimport type { XYSeries } from \"../xy/series/XYSeries\";\r\n\r\nimport * as $array from \"../../core/util/Array\";\r\nimport { ListAutoDispose } from \"../../core/util/List\";\r\n\r\nexport interface IStockPanelSettings extends IXYChartSettings {\r\n}\r\n\r\nexport interface IStockPanelPrivate extends IXYChartPrivate {\r\n\r\n\t/**\r\n\t * A target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n}\r\n\r\n/**\r\n * A panel instance for the [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/panels/} for more info\r\n * @important\r\n */\r\nexport class StockPanel extends XYChart {\r\n\tpublic static className: string = \"StockPanel\";\r\n\tpublic static classNames: Array<string> = XYChart.classNames.concat([StockPanel.className]);\r\n\r\n\tdeclare public _settings: IStockPanelSettings;\r\n\tdeclare public _privateSettings: IStockPanelPrivate;\r\n\r\n\t/**\r\n\t * An instance of [[PanelControls]].\r\n\t */\r\n\tpublic panelControls!: PanelControls;\r\n\r\n\r\n\t/**\r\n\t * A list of drawings on panel.\r\n\t *\r\n\t */\r\n\tpublic readonly drawings: ListAutoDispose<XYSeries> = new ListAutoDispose();\t\r\n\r\n\tprotected _afterNew() {\t\t\r\n\t\tsuper._afterNew();\r\n\t\t\r\n\t\tthis._disposers.push(this.drawings.events.onAll((change) => {\r\n\t\t\tif (change.type === \"clear\") {\r\n\t\t\t\t$array.each(change.oldValues, (series) => {\r\n\t\t\t\t\tthis.series.removeValue(series);\r\n\t\t\t\t})\t\t\t\t\r\n\t\t\t} else if (change.type === \"push\") {\t\t\t\t\r\n\t\t\t\tthis.series.push(change.newValue);\r\n\t\t\t} else if (change.type === \"setIndex\") {\r\n\t\t\t\tthis.series.setIndex(change.index, change.newValue);\r\n\t\t\t} else if (change.type === \"insertIndex\") {\r\n\t\t\t\tthis.series.insertIndex(change.index, change.newValue);\r\n\t\t\t} else if (change.type === \"removeIndex\") {\r\n\t\t\t\tthis.series.removeIndex(change.index);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"Unknown IListEvent type\");\r\n\t\t\t}\r\n\t\t}));\r\n\t}\t\r\n\r\n\t/**\r\n\t * Moves panel up.\r\n\t */\r\n\tpublic moveUp(): void {\r\n\t\tconst stockChart = this.getPrivate(\"stockChart\");\r\n\t\tconst children = stockChart.panelsContainer.children;\r\n\r\n\t\tconst index = children.indexOf(this);\r\n\t\tif (index > 0) {\r\n\t\t\tchildren.moveValue(this, index - 1);\r\n\t\t}\r\n\r\n\t\tstockChart._updateControls();\r\n\t}\r\n\r\n\t/**\r\n\t * Moves panel down.\r\n\t */\r\n\tpublic moveDown(): void {\r\n\t\tconst stockChart = this.getPrivate(\"stockChart\");\r\n\t\tconst children = stockChart.panelsContainer.children;\r\n\r\n\t\tconst index = children.indexOf(this);\r\n\t\tif (index < children.length - 1) {\r\n\t\t\tchildren.moveValue(this, index + 1);\r\n\t\t}\r\n\t\tstockChart._updateControls();\r\n\t}\r\n\r\n\t/**\r\n\t * Closes panel.\r\n\t */\r\n\tpublic close(): void {\r\n\t\tconst stockChart = this.getPrivate(\"stockChart\");\r\n\t\tstockChart.panels.removeValue(this);\r\n\t\tstockChart._updateControls();\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles \"full screen\" mode of the panel on and off.\r\n\t */\r\n\tpublic expand(): void {\r\n\t\tconst stockChart = this.getPrivate(\"stockChart\");\r\n\r\n\t\tconst panels: Array<StockPanel> = [];\r\n\t\tstockChart.panels.each((panel) => {\r\n\t\t\tif (!panel.isVisible()) {\r\n\t\t\t\tpanels.push(panel);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t$array.each(panels, (panel) => {\r\n\t\t\tpanel.setPrivate(\"visible\", true);\r\n\t\t})\r\n\r\n\t\tif (panels.length == 0) {\r\n\t\t\tstockChart.panels.each((panel) => {\r\n\t\t\t\tif (panel != this) {\r\n\t\t\t\t\tpanel.setPrivate(\"visible\", false);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tstockChart._updateControls();\r\n\r\n\t\tif (panels.length == 0) {\r\n\t\t\tconst panelControls = this.panelControls;\r\n\t\t\tpanelControls.upButton.setPrivate(\"visible\", false);\r\n\t\t\tpanelControls.downButton.setPrivate(\"visible\", false);\r\n\t\t\tpanelControls.closeButton.setPrivate(\"visible\", false);\r\n\t\t}\r\n\t}\r\n}\r\n","import type { XYSeries } from \"../../xy/series/XYSeries\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\n\r\nimport { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents } from \"./Indicator\";\r\nimport { StockPanel } from \"../StockPanel\";\r\nimport { XYCursor } from \"../../xy/XYCursor\";\r\nimport { DateAxis } from \"../../xy/axes/DateAxis\";\r\nimport { GaplessDateAxis } from \"../../xy/axes/GaplessDateAxis\";\r\nimport { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport { AxisRendererX } from \"../../xy/axes/AxisRendererX\";\r\nimport { AxisRendererY } from \"../../xy/axes/AxisRendererY\";\r\nimport { Tooltip } from \"../../../core/render/Tooltip\";\r\nimport { StockLegend } from \"../StockLegend\";\r\n\r\n\r\nexport interface IChartIndicatorSettings extends IIndicatorSettings {\r\n}\r\n\r\nexport interface IChartIndicatorPrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IChartIndicatorEvents extends IIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * A base class for chart-based [[StockChart]] indicators.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport abstract class ChartIndicator extends Indicator {\r\n\tpublic static className: string = \"ChartIndicator\";\r\n\tpublic static classNames: Array<string> = Indicator.classNames.concat([ChartIndicator.className]);\r\n\r\n\tdeclare public _settings: IChartIndicatorSettings;\r\n\tdeclare public _privateSettings: IChartIndicatorPrivate;\r\n\tdeclare public _events: IChartIndicatorEvents;\r\n\r\n\tpublic panel!: StockPanel;\r\n\tpublic xAxis!: DateAxis<AxisRenderer>;\r\n\tpublic yAxis!: ValueAxis<AxisRenderer>;\r\n\tpublic cursor!: XYCursor;\r\n\tpublic legend!: StockLegend;\r\n\r\n\tprotected _themeTag?: string;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst seriesChart = stockSeries.chart;\r\n\t\tconst root = this._root;\r\n\t\tif (stockChart && seriesChart) {\r\n\t\t\t// make chart\r\n\t\t\tlet themeTags = [\"indicator\"];\r\n\t\t\tif (this._themeTag) {\r\n\t\t\t\tthemeTags.push(this._themeTag);\r\n\t\t\t}\r\n\t\t\tconst chart = stockChart.panels.push(StockPanel.new(root, { wheelY: \"zoomX\", panX: true, panY: false, themeTags: themeTags }));\r\n\t\t\tchart.addTag(\"indicator\");\r\n\t\t\tthis.panel = chart;\r\n\r\n\t\t\tconst seriesXAxis = stockSeries.get(\"xAxis\") as any;\r\n\r\n\t\t\t// xAxis\r\n\t\t\tconst xRenderer = AxisRendererX.new(root, {});\r\n\t\t\tlet xAxis: DateAxis<AxisRenderer> | GaplessDateAxis<AxisRenderer> | undefined;\r\n\t\t\tlet baseInterval = seriesXAxis.get(\"baseInterval\");\r\n\t\t\tlet start = seriesXAxis.get(\"start\");\r\n\t\t\tlet end = seriesXAxis.get(\"end\");\r\n\r\n\t\t\tif (seriesXAxis instanceof GaplessDateAxis) {\r\n\t\t\t\txAxis = chart.xAxes.push(GaplessDateAxis.new(root, { renderer: xRenderer, baseInterval: baseInterval }));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\txAxis = chart.xAxes.push(DateAxis.new(root, { renderer: xRenderer, baseInterval: baseInterval }));\r\n\t\t\t}\r\n\r\n\t\t\txAxis.set(\"groupData\", seriesXAxis.get(\"groupData\"));\r\n\t\t\txAxis.set(\"groupCount\", seriesXAxis.get(\"groupCount\"));\r\n\r\n\t\t\txAxis.set(\"tooltip\", Tooltip.new(root, { forceHidden: true }));\r\n\r\n\t\t\txAxis.setAll({ start: start, end: end })\r\n\t\t\tthis.xAxis = xAxis;\r\n\r\n\t\t\t// yAxis\r\n\t\t\tconst yRenderer = AxisRendererY.new(root, {});\r\n\t\t\tconst yAxis = chart.yAxes.push(ValueAxis.new(root, {\r\n\t\t\t\trenderer: yRenderer,\r\n\t\t\t\ttooltip: Tooltip.new(root, { forceHidden: true })\r\n\t\t\t}))\r\n\t\t\tthis.yAxis = yAxis;\r\n\r\n\t\t\tconst series = this._createSeries();\r\n\t\t\tthis.series = series;\r\n\r\n\t\t\t// legend\r\n\t\t\tconst legend = chart.topPlotContainer.children.insertIndex(0,\r\n\t\t\t\tStockLegend.new(root, { stockChart: this.get(\"stockChart\") })\r\n\t\t\t);\r\n\r\n\t\t\tlegend.data.push(series);\r\n\r\n\t\t\tconst legendDataItem = legend.dataItems[legend.dataItems.length - 1];\r\n\t\t\tlegendDataItem.set(\"panel\", chart);\r\n\t\t\tlegendDataItem.get(\"marker\").set(\"forceHidden\", true);\r\n\r\n\t\t\tlegendDataItem.get(\"settingsButton\").setPrivate(\"customData\", this);\r\n\r\n\t\t\tchart.set(\"cursor\", XYCursor.new(root, { yAxis: yAxis, xAxis: xAxis }));\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.panels.removeValue(this.panel);\r\n\t}\r\n\r\n\tprotected abstract _createSeries(): XYSeries;\r\n}","import type { DateAxis } from \"../../xy/axes/DateAxis\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\n\r\nimport { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents, IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMovingAverageSettings extends IIndicatorSettings {\r\n\r\n\t/**\r\n\t * Type of the moving average.\r\n\t *\r\n\t * @default \"simple\"\r\n\t */\r\n\ttype?: \"simple\" | \"weighted\" | \"exponential\" | \"dema\" | \"tema\";\r\n\r\n\t/**\r\n\t * Offset.\r\n\t * \r\n\t * @defaul 0\r\n\t */\r\n\toffset?: number;\r\n\r\n}\r\n\r\nexport interface IMovingAveragePrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IMovingAverageEvents extends IIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MovingAverage extends Indicator {\r\n\tpublic static className: string = \"MovingAverage\";\r\n\tpublic static classNames: Array<string> = Indicator.classNames.concat([MovingAverage.className]);\r\n\r\n\tdeclare public _settings: IMovingAverageSettings;\r\n\tdeclare public _privateSettings: IMovingAveragePrivate;\r\n\tdeclare public _events: IMovingAverageEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"offset\",\r\n\t\tname: this.root.language.translateAny(\"Offset\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}, {\r\n\t\tkey: \"type\",\r\n\t\tname: this.root.language.translateAny(\"Type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t}];\r\n\r\n\tpublic _prepareChildren() {\r\n\r\n\t\tif (this.isDirty(\"type\") || this.isDirty(\"offset\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t\tthis.setCustomData(\"type\", this.get(\"type\"));\r\n\t\t\tthis.setCustomData(\"offset\", this.get(\"offset\", 0));\r\n\t\t}\r\n\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst series = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"ma\",\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tthemeTags: [\"indicator\", \"movingaverage\"],\r\n\t\t\t\tname: \"MA\"\r\n\t\t\t}))\r\n\r\n\t\t\tseries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.series = series;\r\n\r\n\t\t\tthis._handleLegend(series);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\r\n\t\tconst series = this.series;\r\n\t\tseries.dispose();\r\n\r\n\t\tif (stockChart) {\r\n\t\t\tconst legend = this.get(\"legend\");\r\n\t\t\tif (legend) {\r\n\t\t\t\tconst legendDataItem = series.get(\"legendDataItem\");\r\n\t\t\t\tif (legendDataItem) {\r\n\t\t\t\t\tlegend.disposeDataItem(legendDataItem as any);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstockChart.indicators.removeValue(this);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tlet period = this.get(\"period\", 50);\r\n\t\t\tconst type = this.get(\"type\");\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase \"simple\":\r\n\t\t\t\t\tthis._sma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"weighted\":\r\n\t\t\t\t\tthis._wma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"exponential\":\r\n\t\t\t\t\tthis._ema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dema\":\r\n\t\t\t\t\tthis._dema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tema\":\r\n\t\t\t\t\tthis._tema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tconst offset = this.get(\"offset\", 0);\r\n\r\n\r\n\t\t\tif (offset != 0) {\r\n\t\t\t\tlet i = 0;\r\n\t\t\t\tconst baseDuration = (this.series.get(\"xAxis\") as DateAxis<AxisRenderer>).baseDuration();\r\n\t\t\t\tconst len = dataItems.length;\r\n\t\t\t\tconst firstTime = dataItems[0].get(\"valueX\", 0);\r\n\t\t\t\tconst lastTime = dataItems[len - 1].get(\"valueX\", 0);\r\n\r\n\t\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\t\tlet newX: number = 0;\r\n\r\n\t\t\t\t\tif (i + offset >= len) {\r\n\t\t\t\t\t\tnewX = lastTime + (offset - len + i + 1) * baseDuration;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (i + offset < 0) {\r\n\t\t\t\t\t\tnewX = firstTime + (i + offset) * baseDuration;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tnewX = dataItems[i + offset].get(\"valueX\", 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdataItem.valueX = newX;\r\n\r\n\t\t\t\t\ti++;\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { MovingAverage, IMovingAverageSettings, IMovingAveragePrivate, IMovingAverageEvents } from \"./MovingAverage\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMovingAverageEnvelopeSettings extends IMovingAverageSettings {\r\n\r\n\t/**\r\n\t * Shift.\r\n\t *\r\n\t * @default 5\r\n\t */\r\n\tshift?: number;\r\n\r\n\t/**\r\n\t * Type of the shift.\r\n\t *\r\n\t * @default \"percent\"\r\n\t */\r\n\tshiftType?: \"percent\" | \"points\";\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tupperColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tlowerColor?: Color;\r\n\r\n}\r\n\r\nexport interface IMovingAverageEnvelopePrivate extends IMovingAveragePrivate {\r\n}\r\n\r\nexport interface IMovingAverageEnvelopeEvents extends IMovingAverageEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MovingAverageEnvelope extends MovingAverage {\r\n\tpublic static className: string = \"MovingAverageEnvelope\";\r\n\tpublic static classNames: Array<string> = MovingAverage.classNames.concat([MovingAverageEnvelope.className]);\r\n\r\n\tdeclare public _settings: IMovingAverageEnvelopeSettings;\r\n\tdeclare public _privateSettings: IMovingAverageEnvelopePrivate;\r\n\tdeclare public _events: IMovingAverageEnvelopeEvents;\r\n\r\n\t/**\r\n\t * Indicator series for the upper band.\r\n\t */\r\n\tpublic upperBandSeries!: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the lower band.\r\n\t */\r\n\tpublic lowerBandSeries!: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"type\",\r\n\t\tname: this.root.language.translateAny(\"Type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}, {\r\n\t\tkey: \"shiftType\",\r\n\t\tname: this.root.language.translateAny(\"Shift type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"percent\", \"points\"]\r\n\t}, {\r\n\t\tkey: \"shift\",\r\n\t\tname: this.root.language.translateAny(\"Shift\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"offset\",\r\n\t\tname: this.root.language.translateAny(\"Offset\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"upperColor\",\r\n\t\tname: this.root.language.translateAny(\"Top\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Median\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"lowerColor\",\r\n\t\tname: this.root.language.translateAny(\"Bottom\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst upperBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"upper\",\r\n\t\t\t\topenValueYField: \"lower\",\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\tthemeTags: [\"movingaverageenvelope\", \"upper\"]\r\n\t\t\t}))\r\n\r\n\t\t\tupperBandSeries.fills.template.set(\"visible\", true);\r\n\t\t\tupperBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\r\n\t\t\tthis.upperBandSeries = upperBandSeries;\r\n\r\n\t\t\tconst lowerBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"lower\",\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\tthemeTags: [\"movingaverageenvelope\", \"lower\"]\r\n\t\t\t}))\r\n\r\n\t\t\tlowerBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.lowerBandSeries = lowerBandSeries;\r\n\t\t}\r\n\r\n\t\tsuper._afterNew();\r\n\t\tthis.series.addTag(\"movingaverageenvelope\");\r\n\t\tthis.series._applyThemes();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\t\tif (this.isDirty(\"upperColor\")) {\r\n\t\t\tconst color = this.get(\"upperColor\");\r\n\t\t\tconst upperBandSeries = this.upperBandSeries;\r\n\t\t\tupperBandSeries.set(\"stroke\", color);\r\n\t\t\tupperBandSeries.set(\"fill\", color);\r\n\t\t\tupperBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n\t\t\tthis._updateSeriesColor(upperBandSeries, color, \"upperColor\");\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"lowerColor\")) {\r\n\t\t\tconst color = this.get(\"lowerColor\");\r\n\t\t\tconst lowerBandSeries = this.lowerBandSeries;\r\n\t\t\tlowerBandSeries.set(\"stroke\", color);\r\n\t\t\tlowerBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n\t\t\tthis._updateSeriesColor(lowerBandSeries, color, \"lowerColor\");\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"shiftType\") || this.isDirty(\"shift\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t\tthis.setCustomData(\"shift\", this.get(\"shift\"));\r\n\t\t\tthis.setCustomData(\"shiftType\", this.get(\"shiftType\"));\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tsuper.prepareData();\r\n\r\n\t\tif (this.series) {\r\n\t\t\tlet smaData = this.series.data.values as any;\r\n\t\t\tlet shift = Number(this.get(\"shift\", 5));\r\n\t\t\tlet shiftType = this.get(\"shiftType\");\r\n\r\n\t\t\t$array.each(smaData, (dataItem: any) => {\r\n\t\t\t\tlet value = dataItem.ma;\r\n\t\t\t\tif (value != null) {\r\n\t\t\t\t\tlet upper = value;\r\n\t\t\t\t\tlet lower = value;\r\n\t\t\t\t\tif (shiftType == \"points\") {\r\n\t\t\t\t\t\tupper += shift;\r\n\t\t\t\t\t\tlower -= shift;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tupper += upper * shift / 100;\r\n\t\t\t\t\t\tlower -= lower * shift / 100;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdataItem.upper = upper;\r\n\t\t\t\t\tdataItem.lower = lower;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.upperBandSeries.data.setAll(smaData);\r\n\t\t\tthis.lowerBandSeries.data.setAll(smaData);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tthis.upperBandSeries.dispose();\r\n\t\tthis.lowerBandSeries.dispose();\r\n\t\tsuper._dispose();\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { Color } from \"../../../core/util/Color\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMovingAverageDeviationSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tincreasingColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tdecreasingColor?: Color;\r\n\r\n\t/**\r\n\t * Type of the moving average.\r\n\t *\r\n\t * @default \"simple\"\r\n\t */\r\n\ttype?: \"simple\" | \"weighted\" | \"exponential\" | \"dema\" | \"tema\";\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tunit?: \"points\" | \"percent\"\r\n\r\n}\r\n\r\nexport interface IMovingAverageDeviationPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IMovingAverageDeviationEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MovingAverageDeviation extends ChartIndicator {\r\n\tpublic static className: string = \"MovingAverageDeviation\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([MovingAverageDeviation.className]);\r\n\r\n\tdeclare public _settings: IMovingAverageDeviationSettings;\r\n\tdeclare public _privateSettings: IMovingAverageDeviationPrivate;\r\n\tdeclare public _events: IMovingAverageDeviationEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [\r\n\t\t{\r\n\t\t\tkey: \"period\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"field\",\r\n\t\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t\t}, {\r\n\t\t\tkey: \"type\",\r\n\t\t\tname: this.root.language.translateAny(\"Type\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t\t}, {\r\n\t\t\tkey: \"unit\",\r\n\t\t\tname: this.root.language.translateAny(\"Points/Percent\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"points\", \"percent\"]\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"increasingColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Increasing\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"decreasingColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Decreasing\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}];\r\n\r\n\tprotected _themeTag: string = \"movingaveragedeviation\";\r\n\r\n\tpublic _createSeries(): ColumnSeries {\r\n\t\treturn this.panel.series.push(ColumnSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"deviation\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"increasingColor\") || this.isDirty(\"decreasingColor\")) {\r\n\t\t\tconst template = this.series.columns.template;\r\n\t\t\tconst increasing = this.get(\"increasingColor\");\r\n\t\t\tconst decreasing = this.get(\"decreasingColor\");\r\n\t\t\ttemplate.states.create(\"riseFromPrevious\", { fill: increasing, stroke: increasing });\r\n\t\t\ttemplate.states.create(\"dropFromPrevious\", { fill: decreasing, stroke: decreasing });\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"type\") || this.isDirty(\"unit\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\r\n\t\t\tlet decreasingColor = this.get(\"decreasingColor\", Color.fromHex(0xff0000)).toCSSHex();\r\n\t\t\tlet increasingColor = this.get(\"increasingColor\", Color.fromHex(0x00ff00)).toCSSHex();\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = this.get(\"period\", 50);\r\n\t\t\tconst type = this.get(\"type\");\r\n\t\t\tconst unit = this.get(\"unit\");\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase \"simple\":\r\n\t\t\t\t\tthis._sma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"weighted\":\r\n\t\t\t\t\tthis._wma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"exponential\":\r\n\t\t\t\t\tthis._ema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dema\":\r\n\t\t\t\t\tthis._dema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tema\":\r\n\t\t\t\t\tthis._tema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tlet previous = -Infinity;\r\n\t\t\tlet i = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i >= period) {\r\n\t\t\t\t\tlet deviation = dataItem.value_y - dataItem.ma;\r\n\t\t\t\t\tif (unit == \"percent\") {\r\n\t\t\t\t\t\tdeviation = (dataItem.value_y / dataItem.ma - 1) * 100;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet color = increasingColor;\r\n\r\n\t\t\t\t\tif (deviation < previous) {\r\n\t\t\t\t\t\tcolor = decreasingColor;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdataItem.deviation = deviation;\r\n\t\t\t\t\tdataItem.deviationColor = color;\r\n\t\t\t\t\tprevious = deviation;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { MovingAverage, IMovingAverageSettings, IMovingAveragePrivate, IMovingAverageEvents } from \"./MovingAverage\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IBollingerBandsSettings extends IMovingAverageSettings {\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tstandardDeviations?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tupperColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tlowerColor?: Color;\r\n\r\n}\r\n\r\nexport interface IBollingerBandsPrivate extends IMovingAveragePrivate {\r\n}\r\n\r\nexport interface IBollingerBandsEvents extends IMovingAverageEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class BollingerBands extends MovingAverage {\r\n\tpublic static className: string = \"BollingerBands\";\r\n\tpublic static classNames: Array<string> = MovingAverage.classNames.concat([BollingerBands.className]);\r\n\r\n\tdeclare public _settings: IBollingerBandsSettings;\r\n\tdeclare public _privateSettings: IBollingerBandsPrivate;\r\n\tdeclare public _events: IBollingerBandsEvents;\r\n\r\n\t/**\r\n\t * Indicator series for the upper band.\r\n\t */\r\n\tpublic upperBandSeries!: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the lower band.\r\n\t */\r\n\tpublic lowerBandSeries!: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"upperColor\",\r\n\t\tname: this.root.language.translateAny(\"Upper\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Average\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"lowerColor\",\r\n\t\tname: this.root.language.translateAny(\"Lower\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}, {\r\n\t\tkey: \"type\",\r\n\t\tname: this.root.language.translateAny(\"Type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t}];\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst upperBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"upper\",\r\n\t\t\t\topenValueYField: \"lower\",\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"bollingerbands\", \"upper\"]\r\n\t\t\t}))\r\n\r\n\t\t\tupperBandSeries.fills.template.set(\"visible\", true);\r\n\t\t\tupperBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\r\n\t\t\tthis.upperBandSeries = upperBandSeries;\r\n\r\n\t\t\tconst lowerBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"lower\",\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"bollingerbands\", \"lower\"]\r\n\t\t\t}))\r\n\r\n\t\t\tlowerBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.lowerBandSeries = lowerBandSeries;\r\n\t\t}\r\n\r\n\t\tsuper._afterNew();\r\n\t\tthis.series.addTag(\"bollingerbands\");\r\n\t\tthis.series._applyThemes();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\t\tif (this.isDirty(\"upperColor\")) {\r\n\t\t\tconst color = this.get(\"upperColor\");\r\n\t\t\tconst upperBandSeries = this.upperBandSeries;\r\n\t\t\tupperBandSeries.set(\"stroke\", color);\r\n\t\t\tupperBandSeries.set(\"fill\", color);\r\n\t\t\tupperBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n\t\t\tthis._updateSeriesColor(upperBandSeries, color, \"upperColor\");\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"lowerColor\")) {\r\n\t\t\tconst color = this.get(\"lowerColor\");\r\n\t\t\tconst lowerBandSeries = this.lowerBandSeries;\r\n\t\t\tlowerBandSeries.set(\"stroke\", color);\r\n\t\t\tlowerBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n\t\t\tthis._updateSeriesColor(lowerBandSeries, color, \"lowerColor\");\r\n\t\t}\r\n\r\n\t\tthis.setCustomData(\"standardDeviations\", this.get(\"standardDeviations\"));\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tsuper.prepareData();\r\n\r\n\t\tif (this.series) {\r\n\r\n\t\t\tlet period = this.get(\"period\", 20);\r\n\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet standardDeviations = this.get(\"standardDeviations\", 2);\r\n\r\n\t\t\tlet smaData = this.series.data.values as any;\r\n\r\n\t\t\tlet i = 0;\r\n\r\n\t\t\t$array.each(smaData, (dataItem: any) => {\r\n\t\t\t\tif (i >= period - 1) {\r\n\t\t\t\t\tlet mean = dataItem.ma;\r\n\r\n\t\t\t\t\tlet stdSum = 0;\r\n\t\t\t\t\tfor (let j = i - period + 1; j <= i; j++) {\r\n\t\t\t\t\t\tlet di = dataItems[j];\r\n\t\t\t\t\t\tlet diValue = this._getValue(di);\r\n\t\t\t\t\t\tif (diValue != null) {\r\n\t\t\t\t\t\t\tstdSum += Math.pow(diValue - mean, 2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet std = Math.sqrt(stdSum / period);\r\n\r\n\t\t\t\t\tconst lower = mean - standardDeviations * std;\r\n\t\t\t\t\tconst upper = mean + standardDeviations * std;\r\n\r\n\t\t\t\t\tdataItem.upper = upper;\r\n\t\t\t\t\tdataItem.lower = lower;\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tthis.upperBandSeries.data.setAll(smaData);\r\n\t\t\tthis.lowerBandSeries.data.setAll(smaData);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tthis.upperBandSeries.dispose();\r\n\t\tthis.lowerBandSeries.dispose();\r\n\t\tsuper._dispose();\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { IValueAxisDataItem } from \"../../xy/axes/ValueAxis\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries, ILineSeriesAxisRange } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IRelativeStrengthIndexSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\toverBought?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\toverSold?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\toverBoughtColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\toverSoldColor?: Color;\r\n\r\n}\r\n\r\nexport interface IRelativeStrengthIndexPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IRelativeStrengthIndexEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class RelativeStrengthIndex extends ChartIndicator {\r\n\tpublic static className: string = \"RelativeStrengthIndex\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([RelativeStrengthIndex.className]);\r\n\r\n\tdeclare public _settings: IRelativeStrengthIndexSettings;\r\n\tdeclare public _privateSettings: IRelativeStrengthIndexPrivate;\r\n\tdeclare public _events: IRelativeStrengthIndexEvents;\r\n\r\n\tpublic overBought!: DataItem<IValueAxisDataItem>;\r\n\tpublic overSold!: DataItem<IValueAxisDataItem>;\r\n\r\n\tpublic overSoldRange!: ILineSeriesAxisRange;\r\n\tpublic overBoughtRange!: ILineSeriesAxisRange;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [\r\n\t\t{\r\n\t\t\tkey: \"period\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"field\",\r\n\t\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\t\ttype: \"color\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"overBought\",\r\n\t\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"overSold\",\r\n\t\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"overBought\",\r\n\t\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"overSold\",\r\n\t\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"overBoughtColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"overSoldColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}];\r\n\r\n\tprotected _themeTag: string = \"rsi\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.yAxis.setAll({ min: 0, max: 100, strictMinMax: true });\r\n\r\n\t\t// overbought range\r\n\t\tconst overBought = this.yAxis.makeDataItem({});\r\n\t\tthis.overBought = overBought;\r\n\r\n\t\toverBought.set(\"endValue\", 100);\r\n\t\tconst overBoughtRange = this.series.createAxisRange(overBought);\r\n\t\tthis.overBoughtRange = overBoughtRange;\r\n\t\tconst overBoughtFills = overBoughtRange.fills;\r\n\t\tif (overBoughtFills) {\r\n\t\t\toverBoughtFills.template.set(\"themeTags\", [\"overbought\", \"fill\"]);\r\n\t\t}\r\n\r\n\t\tconst overBoughtGrid = overBought.get(\"grid\");\r\n\t\tif (overBoughtGrid) {\r\n\t\t\toverBoughtGrid.setAll({ themeTags: [\"overbought\"], visible: true });\r\n\t\t\toverBoughtGrid._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overBoughtLabel = overBought.get(\"label\");\r\n\t\tif (overBoughtLabel) {\r\n\t\t\toverBoughtLabel.setAll({ themeTags: [\"overbought\"], visible: true, location: 0 });\r\n\t\t\toverBoughtLabel._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overSold = this.yAxis.makeDataItem({});\r\n\t\tthis.overSold = overSold;\r\n\r\n\t\toverSold.set(\"endValue\", 0);\r\n\t\tconst overSoldRange = this.series.createAxisRange(overSold);\r\n\t\tthis.overSoldRange = overSoldRange;\r\n\t\tconst overSoldFills = overSoldRange.fills;\r\n\t\tif (overSoldFills) {\r\n\t\t\toverSoldFills.template.set(\"themeTags\", [\"oversold\", \"fill\"]);\r\n\t\t}\r\n\r\n\t\tconst overSoldGrid = overSold.get(\"grid\");\r\n\t\tif (overSoldGrid) {\r\n\t\t\toverSoldGrid.setAll({ themeTags: [\"oversold\"], visible: true });\r\n\t\t\toverSoldGrid._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overSoldLabel = overSold.get(\"label\");\r\n\t\tif (overSoldLabel) {\r\n\t\t\toverSoldLabel.setAll({ themeTags: [\"oversold\"], visible: true, location: 0 });\r\n\t\t\toverSoldLabel._applyThemes();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"valueY\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tconst overSoldValue = this.get(\"overSold\", 20);\r\n\t\tconst overBoughtValue = this.get(\"overBought\", 80);\r\n\r\n\t\tif (this.isDirty(\"overBought\")) {\r\n\t\t\tthis.overBought.set(\"value\", overBoughtValue);\r\n\r\n\t\t\tconst label = this.overBought.get(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"text\", this.getNumberFormatter().format(overBoughtValue));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overSold\")) {\r\n\t\t\tthis.overSold.set(\"value\", overSoldValue);\r\n\r\n\t\t\tconst label = this.overSold.get(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"text\", this.getNumberFormatter().format(overSoldValue));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overSoldColor\")) {\r\n\t\t\tconst color = this.get(\"overSoldColor\");\r\n\t\t\tconst label = this.overSold.get(\"label\");\r\n\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"fill\", color);\r\n\t\t\t}\r\n\r\n\t\t\tthis.overSold.get(\"grid\")!.set(\"stroke\", color);\r\n\t\t\tthis.overSoldRange.fills!.template.set(\"fill\", color);\r\n\t\t\tthis.overSoldRange.strokes!.template.set(\"stroke\", color);\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overBoughtColor\")) {\r\n\t\t\tconst color = this.get(\"overBoughtColor\");\r\n\t\t\tconst label = this.overBought.get(\"label\");\r\n\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"fill\", color);\r\n\t\t\t}\r\n\r\n\t\t\tthis.overBought.get(\"grid\")!.set(\"stroke\", color);\r\n\t\t\tthis.overBoughtRange.fills!.template.set(\"fill\", color);\r\n\t\t\tthis.overBoughtRange.strokes!.template.set(\"stroke\", color);\r\n\t\t}\r\n\r\n\t\tthis.series.get(\"yAxis\").set(\"baseValue\", overSoldValue + (overBoughtValue - overSoldValue) / 2);\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst period = this.get(\"period\", 14);\r\n\t\t\tconst data: Array<any> = [];\r\n\t\t\tlet i = 0;\r\n\t\t\tlet averageGain = 0;\r\n\t\t\tlet averageLoss = 0;\r\n\t\t\tlet prevAverageGain = 0;\r\n\t\t\tlet prevAverageLoss = 0;\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tlet rsi = null;\r\n\t\t\t\ti++;\r\n\r\n\t\t\t\tif (i == period + 1) {\r\n\t\t\t\t\tfor (let j = 1; j <= period; j++) {\r\n\t\t\t\t\t\tlet value = dataItems[j].get(\"valueY\", 0)\r\n\t\t\t\t\t\tlet prevValue = dataItems[j - 1].get(\"valueY\", 0);\r\n\t\t\t\t\t\tlet change = value - prevValue;\r\n\r\n\t\t\t\t\t\tif (change > 0) {\r\n\t\t\t\t\t\t\taverageGain += change / period;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\taverageLoss += Math.abs(change) / period;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trsi = 100 - (100 / (1 + averageGain / averageLoss));\r\n\t\t\t\t}\r\n\t\t\t\telse if (i > period) {\r\n\t\t\t\t\tlet value = dataItem.get(\"valueY\", 0);\r\n\t\t\t\t\tlet prevValue = dataItems[i - 2].get(\"valueY\", 0);\r\n\r\n\t\t\t\t\tlet change = value - prevValue;\r\n\r\n\t\t\t\t\tlet gain = 0;\r\n\t\t\t\t\tlet loss = 0;\r\n\r\n\t\t\t\t\tif (change > 0) {\r\n\t\t\t\t\t\tgain = change;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tloss = -change;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\taverageGain = (prevAverageGain * (period - 1) + gain) / period;\r\n\t\t\t\t\taverageLoss = (prevAverageLoss * (period - 1) + loss) / period;\r\n\r\n\t\t\t\t\trsi = 100 - (100 / (1 + averageGain / averageLoss));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdata.push({ valueX: dataItem.get(\"valueX\"), valueY: rsi });\r\n\r\n\t\t\t\tprevAverageGain = averageGain;\r\n\t\t\t\tprevAverageLoss = averageLoss;\r\n\t\t\t})\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IAccumulationDistributionSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Main volume series of the [[StockChart]].\r\n\t */\r\n\tvolumeSeries?: XYSeries;\r\n\r\n\t/**\r\n\t * Use volume series (if set)?\r\n\t */\r\n\tuseVolume?: boolean;\r\n\r\n}\r\n\r\nexport interface IAccumulationDistributionPrivate extends IChartIndicatorPrivate {\r\n\r\n}\r\n\r\nexport interface IAccumulationDistributionEvents extends IChartIndicatorEvents {\r\n\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class AccumulationDistribution extends ChartIndicator {\r\n\tpublic static className: string = \"AccumulationDistribution\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([AccumulationDistribution.className]);\r\n\r\n\tdeclare public _settings: IAccumulationDistributionSettings;\r\n\tdeclare public _privateSettings: IAccumulationDistributionPrivate;\r\n\tdeclare public _events: IAccumulationDistributionEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"useVolume\",\r\n\t\tname: this.root.language.translateAny(\"Use Volume\"),\r\n\t\ttype: \"checkbox\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"accumulationdistribution\";\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"ad\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"useVolume\") || this.isDirty(\"volumeSeries\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t\tthis.setCustomData(\"useVolume\", this.get(\"useVolume\") ? \"Y\" : \"N\");\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet prevAD = 0;\r\n\t\t\tlet useVolume = this.get(\"useVolume\");\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tlet close = dataItem.get(\"valueY\") as number;\r\n\t\t\t\tif (close != null) {\r\n\t\t\t\t\tlet low = dataItem.get(\"lowValueY\", close) as number;\r\n\t\t\t\t\tlet high = dataItem.get(\"highValueY\", close) as number;\r\n\r\n\t\t\t\t\tlet volume = 1;\r\n\t\t\t\t\tif (volumeSeries && useVolume) {\r\n\t\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet mf = ((close - low) - (high - close)) / (high - low)\r\n\t\t\t\t\tif (high == low) {\r\n\t\t\t\t\t\tmf = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet ad = prevAD + mf * volume;\r\n\t\t\t\t\tdata[i].ad = ad;\r\n\r\n\t\t\t\t\tprevAD = ad\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport * as $type from \"../../../core/util/Type\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport { Color } from \"../../../core/util/Color\";\r\nimport type { ILineSeriesAxisRange } from \"../../xy/series/LineSeries\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { IValueAxisDataItem } from \"../../xy/axes/ValueAxis\";\r\n\r\nexport interface IAccumulativeSwingIndexSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tlimitMoveValue?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tpositiveColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tnegativeColor?: Color;\r\n\r\n}\r\n\r\nexport interface IAccumulativeSwingIndexPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IAccumulativeSwingIndexEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class AccumulativeSwingIndex extends ChartIndicator {\r\n\tpublic static className: string = \"AccumulativeSwingIndex\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([AccumulativeSwingIndex.className]);\r\n\r\n\tdeclare public _settings: IAccumulativeSwingIndexSettings;\r\n\tdeclare public _privateSettings: IAccumulativeSwingIndexPrivate;\r\n\tdeclare public _events: IAccumulativeSwingIndexEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"positiveColor\",\r\n\t\tname: this.root.language.translateAny(\"Positive color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"negativeColor\",\r\n\t\tname: this.root.language.translateAny(\"Negative color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"limitMoveValue\",\r\n\t\tname: this.root.language.translateAny(\"Limit move value\"),\r\n\t\ttype: \"number\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"accumulativeswingindex\";\r\n\r\n\tprotected _axisRange?: ILineSeriesAxisRange;\r\n\tprotected _axisRangeDI?: DataItem<IValueAxisDataItem>;\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\tconst series = this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"asi\"\r\n\t\t}))\r\n\r\n\t\tconst dataItem = this.yAxis.makeDataItem({})\r\n\t\tthis._axisRangeDI = dataItem;\r\n\t\tdataItem.set(\"value\", 0);\r\n\t\tdataItem.set(\"endValue\", -100);\r\n\t\tthis._axisRange = series.createAxisRange(dataItem);\r\n\r\n\t\tthis.yAxis.onPrivate(\"min\", (min) => {\r\n\t\t\tdataItem.set(\"endValue\", min);\r\n\t\t})\r\n\r\n\t\treturn series;\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"limitMoveValue\")) {\r\n\t\t\tthis.setCustomData(\"limitMoveValue\", this.get(\"limitMoveValue\"))\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\r\n\t\tconst series = this.series;\r\n\t\tif (this.isDirty(\"positiveColor\")) {\r\n\t\t\tlet color = this.get(\"positiveColor\");\r\n\t\t\tseries.setAll({ fill: color, stroke: color });\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"negativeColor\")) {\r\n\t\t\tlet color = this.get(\"negativeColor\");\r\n\t\t\tlet axisRange = this._axisRange;\r\n\t\t\tif (axisRange) {\r\n\t\t\t\tconst fills = axisRange.fills;\r\n\t\t\t\tif (fills) {\r\n\t\t\t\t\tfills.template.set(\"fill\", color);\r\n\t\t\t\t}\r\n\t\t\t\tconst strokes = axisRange.strokes;\r\n\t\t\t\tif (strokes) {\r\n\t\t\t\t\tstrokes.template.set(\"stroke\", color);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\r\n\t\t\tlet t = this.get(\"limitMoveValue\", 0.5);\r\n\r\n\t\t\tlet asi = 0;\r\n\r\n\t\t\tlet negativeColor = this.get(\"negativeColor\", Color.fromHex(0xff0000)).toCSSHex();\r\n\t\t\tlet positiveColor = this.get(\"positiveColor\", Color.fromHex(0x00ff00)).toCSSHex();\r\n\r\n\t\t\tif (dataItems.length > 2) {\r\n\r\n\t\t\t\tdata[0].asi = 0;\r\n\t\t\t\tdata[0].swingColor = positiveColor;\r\n\r\n\t\t\t\tfor (let i = 1, len = dataItems.length; i < len; i++) {\r\n\t\t\t\t\tconst dataItem = dataItems[i];\r\n\t\t\t\t\tconst yDataItem = dataItems[i - 1];\r\n\r\n\t\t\t\t\tlet c = dataItem.get(\"valueY\");\r\n\t\t\t\t\tif ($type.isNumber(c)) {\r\n\t\t\t\t\t\tlet cy = yDataItem.get(\"valueY\", c);\r\n\r\n\t\t\t\t\t\tlet h = dataItem.get(\"highValueY\", c);\r\n\t\t\t\t\t\tlet l = dataItem.get(\"lowValueY\", c);\r\n\t\t\t\t\t\tlet o = dataItem.get(\"openValueY\", c);\r\n\t\t\t\t\t\tlet oy = yDataItem.get(\"openValueY\", c);\r\n\r\n\t\t\t\t\t\tlet hl = h - l;\r\n\t\t\t\t\t\tlet hc = Math.abs(h - cy);\r\n\t\t\t\t\t\tlet lc = Math.abs(l - cy);\r\n\t\t\t\t\t\tlet tr = Math.max(hc, lc, hl);\r\n\r\n\t\t\t\t\t\tlet er = 0;\r\n\t\t\t\t\t\tif (cy > h) {\r\n\t\t\t\t\t\t\ter = hc;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cy < l) {\r\n\t\t\t\t\t\t\ter = lc;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet k = Math.max(hc, lc);\r\n\r\n\t\t\t\t\t\tlet sh = Math.abs(cy - oy);\r\n\r\n\t\t\t\t\t\tlet r = tr - er / 2 + sh / 4;\r\n\r\n\t\t\t\t\t\tasi += 50 * (c - cy + (c - o) / 2 + (cy - oy) / 4) / r * k / t;\r\n\r\n\t\t\t\t\t\tlet color = positiveColor;\r\n\t\t\t\t\t\tif (asi < 0) {\r\n\t\t\t\t\t\t\tcolor = negativeColor;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdata[i].asi = asi;\r\n\t\t\t\t\t\tdata[i].swingColor = color;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { Color } from \"../../../core/util/Color\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IAroonSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tupColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tdownColor?: Color;\r\n\r\n}\r\n\r\nexport interface IAroonPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IAroonEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class Aroon extends ChartIndicator {\r\n\tpublic static className: string = \"Aroon\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([Aroon.className]);\r\n\r\n\tdeclare public _settings: IAroonSettings;\r\n\tdeclare public _privateSettings: IAroonPrivate;\r\n\tdeclare public _events: IAroonEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for downs.\r\n\t */\r\n\tdeclare public downSeries: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"upColor\",\r\n\t\tname: this.root.language.translateAny(\"Aroon up\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"downColor\",\r\n\t\tname: this.root.language.translateAny(\"Aroon down\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"aroon\";\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"up\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.downSeries = this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"down\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\r\n\t\tthis.yAxis.setAll({ min: -1, max: 101, strictMinMax: true });\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"upColor\")) {\r\n\t\t\tlet color = this.get(\"upColor\", Color.fromHex(0x00ff00));\r\n\t\t\tthis._updateSeriesColor(this.series, color);\r\n\t\t\tthis.setCustomData(\"upColor\", color);\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"downColor\")) {\r\n\t\t\tlet color = this.get(\"downColor\", Color.fromHex(0xff0000));\r\n\t\t\tthis._updateSeriesColor(this.downSeries, color);\r\n\t\t\tthis.setCustomData(\"downColor\", color);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tthis.set(\"field\", \"close\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = this.get(\"period\", 14);\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet b = Math.max(0, i - period);\r\n\t\t\t\tlet h = -Infinity;\r\n\t\t\t\tlet l = Infinity;\r\n\r\n\t\t\t\tlet li = 0;\r\n\t\t\t\tlet hi = 0;\r\n\r\n\t\t\t\tfor (let j = b; j <= i; j++) {\r\n\t\t\t\t\tlet vh = dataItems[j].get(\"highValueY\", 0);\r\n\t\t\t\t\tif (vh >= h) {\r\n\t\t\t\t\t\th = vh;\r\n\t\t\t\t\t\thi = j;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet vl = dataItems[j].get(\"lowValueY\", 0);\r\n\t\t\t\t\tif (vl <= l) {\r\n\t\t\t\t\t\tl = vl;\r\n\t\t\t\t\t\tli = j;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdataItem.up = (period - (i - hi)) / period * 100;\r\n\t\t\t\tdataItem.down = (period - (i - li)) / period * 100;\r\n\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t\tthis.downSeries.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { color, Color } from \"../../../core/util/Color\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMACDSettings extends IChartIndicatorSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tincreasingColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tdecreasingColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tsignalColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tfastPeriod?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tslowPeriod?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tsignalPeriod?: number;\r\n\r\n}\r\n\r\nexport interface IMACDPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IMACDEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MACD extends ChartIndicator {\r\n\tpublic static className: string = \"MACD\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([MACD.className]);\r\n\r\n\tdeclare public _settings: IMACDSettings;\r\n\tdeclare public _privateSettings: IMACDPrivate;\r\n\tdeclare public _events: IMACDEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the signal.\r\n\t */\r\n\tpublic signalSeries!: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the difference.\r\n\t */\r\n\tpublic differenceSeries!: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"fastPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Fast MA period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"slowPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Slow MA period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"signalPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Signal period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"MACD\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"signalColor\",\r\n\t\tname: this.root.language.translateAny(\"Signal\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"increasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Increasing\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"decreasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Decreasing\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"macd\";\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"macd\",\r\n\t\t\tgroupDataDisabled: true,\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst chart = this.panel;\r\n\r\n\t\tif (chart) {\r\n\r\n\t\t\tconst signalSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"signal\",\r\n\t\t\t\txAxis: this.xAxis,\r\n\t\t\t\tyAxis: this.yAxis,\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"signal\"]\r\n\t\t\t}))\r\n\r\n\t\t\tthis.signalSeries = signalSeries;\r\n\r\n\t\t\tconst differenceSeries = chart.series.push(ColumnSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"difference\",\r\n\t\t\t\txAxis: this.xAxis,\r\n\t\t\t\tyAxis: this.yAxis,\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"difference\"]\r\n\t\t\t}))\r\n\r\n\t\t\tthis.differenceSeries = differenceSeries;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"fastPeriod\") || this.isDirty(\"slowPeriod\") || this.isDirty(\"signalPeriod\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t\tthis.setCustomData(\"fastPeriod\", this.get(\"fastPeriod\"));\r\n\t\t\tthis.setCustomData(\"slowPeriod\", this.get(\"slowPeriod\"));\r\n\t\t\tthis.setCustomData(\"signalPeriod\", this.get(\"signalPeriod\"));\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"increasingColor\") || this.isDirty(\"decreasingColor\")) {\r\n\t\t\tconst template = this.differenceSeries.columns.template;\r\n\t\t\tconst increasing = this.get(\"increasingColor\");\r\n\t\t\tconst decreasing = this.get(\"decreasingColor\");\r\n\t\t\ttemplate.states.create(\"riseFromPrevious\", { fill: increasing, stroke: increasing });\r\n\t\t\ttemplate.states.create(\"dropFromPrevious\", { fill: decreasing, stroke: decreasing });\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"signalColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.signalSeries, this.get(\"signalColor\"), \"signalColor\");\r\n\t\t}\r\n\r\n\t\tconst dataItem = this.series.dataItem;\r\n\t\tif (dataItem) {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext) {\r\n\t\t\t\tdataContext.fastPeriod = this.get(\"fastPeriod\");\r\n\t\t\t\tdataContext.slowPeriod = this.get(\"slowPeriod\");\r\n\t\t\t\tdataContext.signalPeriod = this.get(\"signalPeriod\");\r\n\r\n\t\t\t\tconst seriesColor = this.get(\"seriesColor\");\r\n\t\t\t\tif (seriesColor) {\r\n\t\t\t\t\tdataContext.seriesColor = seriesColor.toCSSHex();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst signalColor = this.get(\"signalColor\");\r\n\t\t\t\tif (signalColor) {\r\n\t\t\t\t\tdataContext.signalColor = signalColor.toCSSHex();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = this.get(\"fastPeriod\", 12);\r\n\r\n\t\t\tthis._ema(data, period, \"value_y\", \"emaFast\");\r\n\r\n\t\t\tperiod = this.get(\"slowPeriod\", 26);\r\n\t\t\tthis._ema(data, period, \"value_y\", \"emaSlow\");\r\n\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet emaFast = dataItem.emaFast;\r\n\t\t\t\tlet emaSlow = dataItem.emaSlow;\r\n\r\n\t\t\t\tif (emaFast != null && emaSlow != null) {\r\n\t\t\t\t\tdataItem.macd = emaFast - emaSlow;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tperiod = this.get(\"signalPeriod\", 9);\r\n\t\t\tthis._ema(data, period, \"macd\", \"signal\");\r\n\r\n\t\t\tconst increasingColor = this.get(\"increasingColor\", color(0x00ff00)).toCSSHex();\r\n\t\t\tconst decreasingColor = this.get(\"decreasingColor\", color(0xff0000)).toCSSHex();\r\n\r\n\t\t\tlet p = -Infinity;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet macd = dataItem.macd\r\n\t\t\t\tlet signal = dataItem.signal;\r\n\t\t\t\tif (macd != null && signal != null) {\r\n\t\t\t\t\tlet difference = macd - signal;\r\n\t\t\t\t\tdataItem.difference = difference;\r\n\r\n\t\t\t\t\tlet color = increasingColor;\r\n\r\n\t\t\t\t\tif (difference < p) {\r\n\t\t\t\t\t\tcolor = decreasingColor;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdataItem.differenceColor = color;\r\n\t\t\t\t\tp = difference;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.differenceSeries.data.setAll(data);\r\n\t\t\tthis.signalSeries.data.setAll(data);\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IChaikinMoneyFlowSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Main volume series of the [[StockChart]].\r\n\t */\r\n\tvolumeSeries: XYSeries;\r\n\r\n}\r\n\r\nexport interface IChaikinMoneyFlowPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IChaikinMoneyFlowEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class ChaikinMoneyFlow extends ChartIndicator {\r\n\tpublic static className: string = \"ChaikinMoneyFlow\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([ChaikinMoneyFlow.className]);\r\n\r\n\tdeclare public _settings: IChaikinMoneyFlowSettings;\r\n\tdeclare public _privateSettings: IChaikinMoneyFlowPrivate;\r\n\tdeclare public _events: IChaikinMoneyFlowEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"chaikinmoneyflow\";\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"cmf\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"volumeSeries\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet i = 0;\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tlet close = dataItem.get(\"valueY\") as number;\r\n\t\t\t\tif (close != null) {\r\n\t\t\t\t\tlet low = dataItem.get(\"lowValueY\", close) as number;\r\n\t\t\t\t\tlet high = dataItem.get(\"highValueY\", close) as number;\r\n\r\n\t\t\t\t\tlet volume = 1;\r\n\r\n\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet mf = ((close - low) - (high - close)) / (high - low)\r\n\t\t\t\t\tif (high == low) {\r\n\t\t\t\t\t\tmf = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet mfv = mf * volume;\r\n\t\t\t\t\tdata[i].mfv = mfv;\r\n\t\t\t\t\tdata[i].volume = volume;\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tconst period = this.get(\"period\", 20);\r\n\t\t\ti = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tif (i >= period - 1) {\r\n\t\t\t\t\tlet mfv = 0;\r\n\t\t\t\t\tlet volume = 0;\r\n\r\n\t\t\t\t\tfor (let j = i; j > i - period; j--) {\r\n\t\t\t\t\t\tmfv += data[j].mfv;\r\n\t\t\t\t\t\tvolume += data[j].volume;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdataItem.cmf = mfv / volume;\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IChaikinOscillatorSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Main volume series of the [[StockChart]].\r\n\t */\r\n\tvolumeSeries: XYSeries;\r\n\r\n\t/**\r\n\t * Slow period setting.\r\n\t */\r\n\tslowPeriod?: number;\r\n\r\n}\r\n\r\nexport interface IChaikinOscillatorPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IChaikinOscillatorEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class ChaikinOscillator extends ChartIndicator {\r\n\tpublic static className: string = \"ChaikinOscillator\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([ChaikinOscillator.className]);\r\n\r\n\tdeclare public _settings: IChaikinOscillatorSettings;\r\n\tdeclare public _privateSettings: IChaikinOscillatorPrivate;\r\n\tdeclare public _events: IChaikinOscillatorEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Fast period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"slowPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Slow period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"chaikinoscillator\";\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"cmf\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"volumeSeries\") || this.isDirty(\"slowPeriod\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t\tthis.setCustomData(\"slowPeriod\", this.get(\"slowPeriod\"));\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet prevAD = 0;\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tlet close = dataItem.get(\"valueY\") as number;\r\n\t\t\t\tif (close != null) {\r\n\t\t\t\t\tlet low = dataItem.get(\"lowValueY\", close) as number;\r\n\t\t\t\t\tlet high = dataItem.get(\"highValueY\", close) as number;\r\n\r\n\t\t\t\t\tlet volume = 1;\r\n\r\n\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet mf = ((close - low) - (high - close)) / (high - low)\r\n\t\t\t\t\tif (high == low) {\r\n\t\t\t\t\t\tmf = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet ad = prevAD + mf * volume;\r\n\t\t\t\t\tdata[i].ad = ad;\r\n\r\n\t\t\t\t\tprevAD = ad\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tthis._ema(data, this.get(\"slowPeriod\", 10), \"ad\", \"emaSlow\");\r\n\t\t\tthis._ema(data, this.get(\"period\", 3), \"ad\", \"emaFast\");\r\n\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tconst emaSlow = dataItem.emaSlow;\r\n\t\t\t\tconst emaFast = dataItem.emaFast;\r\n\t\t\t\tif (emaSlow != null && emaFast != null) {\r\n\t\t\t\t\tdataItem.cmf = emaFast - emaSlow;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nexport interface IOnBalanceVolumeSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Chart's main volume series.\r\n\t */\r\n\tvolumeSeries: XYSeries;\r\n\r\n}\r\n\r\nexport interface IOnBalanceVolumePrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IOnBalanceVolumeEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class OnBalanceVolume extends ChartIndicator {\r\n\tpublic static className: string = \"OnBalanceVolume\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([OnBalanceVolume.className]);\r\n\r\n\tdeclare public _settings: IOnBalanceVolumeSettings;\r\n\tdeclare public _privateSettings: IOnBalanceVolumePrivate;\r\n\tdeclare public _events: IOnBalanceVolumeEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"onbalancevolume\";\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"obv\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"volumeSeries\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet previous = 0;\r\n\t\t\tlet len = data.length;\r\n\r\n\t\t\tif (volumeSeries && len > 1) {\r\n\t\t\t\tlet cy = data[0].value_y as number;\r\n\r\n\t\t\t\tfor (let i = 1; i < len; i++) {\r\n\t\t\t\t\tconst dataItem = data[i];\r\n\r\n\t\t\t\t\tlet c = dataItem.value_y;\r\n\r\n\t\t\t\t\tif (c != null) {\r\n\t\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\t\tlet volume = 0;\r\n\t\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet obv = previous;\r\n\t\t\t\t\t\tif (c > cy) {\r\n\t\t\t\t\t\t\tobv += volume;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (c < cy) {\r\n\t\t\t\t\t\t\tobv -= volume;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdataItem.obv = obv;\r\n\r\n\t\t\t\t\t\tprevious = obv;\r\n\t\t\t\t\t\tcy = c;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { IValueAxisDataItem } from \"../../xy/axes/ValueAxis\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IStochasticOscillatorSettings extends IChartIndicatorSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverBought?: number;\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverSold?: number;\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tslowColor?: Color;\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tkSmoothing?: number;\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tdSmoothing?: number;\r\n}\r\n\r\nexport interface IStochasticOscillatorPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IStochasticOscillatorEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class StochasticOscillator extends ChartIndicator {\r\n\tpublic static className: string = \"StochasticOscillator\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([StochasticOscillator.className]);\r\n\r\n\tdeclare public _settings: IStochasticOscillatorSettings;\r\n\tdeclare public _privateSettings: IStochasticOscillatorPrivate;\r\n\tdeclare public _events: IStochasticOscillatorEvents;\r\n\r\n\tpublic overBought!: DataItem<IValueAxisDataItem>;\r\n\tpublic overSold!: DataItem<IValueAxisDataItem>;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tpublic slowSeries!: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"kSmoothing\",\r\n\t\tname: this.root.language.translateAny(\"%K Smoothing\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"dSmoothing\",\r\n\t\tname: this.root.language.translateAny(\"%D Smoothing\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"overBought\",\r\n\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"overSold\",\r\n\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Fast\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"slowColor\",\r\n\t\tname: this.root.language.translateAny(\"Slow\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"stochastic\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.yAxis.setAll({ min: 0, max: 100, strictMinMax: true });\r\n\r\n\t\t// overbought range\r\n\t\tconst overBought = this.yAxis.makeDataItem({});\r\n\t\tthis.overBought = overBought;\r\n\t\tthis.yAxis.createAxisRange(overBought);\r\n\r\n\t\tconst overBoughtGrid = overBought.get(\"grid\");\r\n\t\tif (overBoughtGrid) {\r\n\t\t\toverBoughtGrid.setAll({ themeTags: [\"overbought\"], visible: true });\r\n\t\t\toverBoughtGrid._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overBoughtLabel = overBought.get(\"label\");\r\n\t\tif (overBoughtLabel) {\r\n\t\t\toverBoughtLabel.setAll({ themeTags: [\"overbought\"], visible: true, location: 0 });\r\n\t\t\toverBoughtLabel._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overSold = this.yAxis.makeDataItem({});\r\n\t\tthis.overSold = overSold;\r\n\t\tthis.yAxis.createAxisRange(overSold);\r\n\r\n\t\tconst overSoldGrid = overSold.get(\"grid\");\r\n\t\tif (overSoldGrid) {\r\n\t\t\toverSoldGrid.setAll({ themeTags: [\"oversold\"], visible: true });\r\n\t\t\toverSoldGrid._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overSoldLabel = overSold.get(\"label\");\r\n\t\tif (overSoldLabel) {\r\n\t\t\toverSoldLabel.setAll({ themeTags: [\"oversold\"], visible: true, location: 0 });\r\n\t\t\toverSoldLabel._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst slowSeries = this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"slow\",\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tgroupDataDisabled: true,\r\n\t\t\tthemeTags: [\"slow\"]\r\n\t\t}))\r\n\r\n\t\tthis.slowSeries = slowSeries;\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"fast\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"kSmoothing\") || this.isDirty(\"dSmoothing\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tconst overSoldValue = this.get(\"overSold\", 20);\r\n\t\tconst overBoughtValue = this.get(\"overBought\", 80);\r\n\r\n\t\tif (this.isDirty(\"overBought\")) {\r\n\t\t\tthis.overBought.set(\"value\", overBoughtValue);\r\n\r\n\t\t\tconst label = this.overBought.get(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"text\", this.getNumberFormatter().format(overBoughtValue));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overSold\")) {\r\n\t\t\tthis.overSold.set(\"value\", overSoldValue);\r\n\r\n\t\t\tconst label = this.overSold.get(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"text\", this.getNumberFormatter().format(overSoldValue));\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.series.get(\"yAxis\").set(\"baseValue\", overSoldValue + (overBoughtValue - overSoldValue) / 2);\r\n\r\n\t\tif (this.isDirty(\"slowColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.slowSeries, this.get(\"slowColor\"), \"slowColor\")\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet period = this.get(\"period\", 14);\r\n\t\t\tlet data: Array<any> = [];\r\n\t\t\tlet index = 0;\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tconst valueX = dataItem.get(\"valueX\");\r\n\t\t\t\tlet k;\r\n\t\t\t\tif (index >= period - 1) {\r\n\t\t\t\t\tlet value = this._getValue(dataItem);\r\n\r\n\t\t\t\t\tif (value != null) {\r\n\t\t\t\t\t\tlet lp = Infinity;\r\n\t\t\t\t\t\tlet hp = -lp;\r\n\t\t\t\t\t\tfor (let j = index; j > index - period; j--) {\r\n\t\t\t\t\t\t\tlet h = dataItems[j].get(\"highValueY\");\r\n\t\t\t\t\t\t\tlet l = dataItems[j].get(\"lowValueY\");\r\n\r\n\t\t\t\t\t\t\tif (h != null && l != null) {\r\n\t\t\t\t\t\t\t\tif (l < lp) {\r\n\t\t\t\t\t\t\t\t\tlp = l;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (h > hp) {\r\n\t\t\t\t\t\t\t\t\thp = h;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tk = (value - lp) / (hp - lp) * 100;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (k == null) {\r\n\t\t\t\t\tdata.push({ valueX: valueX });\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdata.push({ valueX: valueX, value_y: k });\r\n\t\t\t\t}\r\n\t\t\t\tindex++;\r\n\t\t\t})\r\n\r\n\t\t\tperiod = this.get(\"kSmoothing\", 1);\r\n\t\t\tthis._sma(data, period, \"value_y\", \"fast\");\r\n\r\n\t\t\tperiod = this.get(\"dSmoothing\", 3);\r\n\t\t\tthis._sma(data, period, \"fast\", \"slow\");\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t\tthis.slowSeries.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { Color } from \"../../../core/util/Color\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IAwesomeOscillatorSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tincreasingColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tdecreasingColor?: Color;\r\n\r\n}\r\n\r\nexport interface IAwesomeOscillatorPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IAwesomeOscillatorEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class AwesomeOscillator extends ChartIndicator {\r\n\tpublic static className: string = \"AwesomeOscillator\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([AwesomeOscillator.className]);\r\n\r\n\tdeclare public _settings: IAwesomeOscillatorSettings;\r\n\tdeclare public _privateSettings: IAwesomeOscillatorPrivate;\r\n\tdeclare public _events: IAwesomeOscillatorEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"increasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Increasing\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"decreasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Decreasing\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"awesomeoscillator\";\r\n\r\n\tpublic _createSeries(): ColumnSeries {\r\n\t\treturn this.panel.series.push(ColumnSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"ao\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"increasingColor\") || this.isDirty(\"decreasingColor\")) {\r\n\t\t\tconst template = this.series.columns.template;\r\n\t\t\tconst increasing = this.get(\"increasingColor\");\r\n\t\t\tconst decreasing = this.get(\"decreasingColor\");\r\n\t\t\ttemplate.states.create(\"riseFromPrevious\", { fill: increasing, stroke: increasing });\r\n\t\t\ttemplate.states.create(\"dropFromPrevious\", { fill: decreasing, stroke: decreasing });\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tthis.set(\"field\", \"hl/2\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\r\n\t\t\tlet decreasingColor = this.get(\"decreasingColor\", Color.fromHex(0xff0000)).toCSSHex();\r\n\t\t\tlet increasingColor = this.get(\"increasingColor\", Color.fromHex(0x00ff00)).toCSSHex();\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = 5;\r\n\t\t\tthis._sma(data, 5, \"value_y\", \"sma5\");\r\n\r\n\t\t\tperiod = 34;\r\n\t\t\tthis._sma(data, 34, \"value_y\", \"sma34\");\r\n\r\n\t\t\tlet po = -Infinity;\r\n\t\t\tlet i = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i >= period) {\r\n\t\t\t\t\tlet o = dataItem.sma5 - dataItem.sma34\r\n\t\t\t\t\tlet color = increasingColor;\r\n\r\n\t\t\t\t\tif (o < po) {\r\n\t\t\t\t\t\tcolor = decreasingColor;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdataItem.ao = o;\r\n\t\t\t\t\tdataItem.oscillatorColor = color;\r\n\t\t\t\t\tpo = o;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { IValueAxisDataItem } from \"../../xy/axes/ValueAxis\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries, ILineSeriesAxisRange } from \"../../xy/series/LineSeries\";\r\n\r\nexport interface IWilliamsRSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverBought?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverSold?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverBoughtColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverSoldColor?: Color;\r\n\r\n}\r\n\r\nexport interface IWilliamsRPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IWilliamsREvents extends IChartIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class WilliamsR extends ChartIndicator {\r\n\tpublic static className: string = \"WilliamsR\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([WilliamsR.className]);\r\n\r\n\tdeclare public _settings: IWilliamsRSettings;\r\n\tdeclare public _privateSettings: IWilliamsRPrivate;\r\n\tdeclare public _events: IWilliamsREvents;\r\n\r\n\tpublic overBought!: DataItem<IValueAxisDataItem>;\r\n\tpublic overSold!: DataItem<IValueAxisDataItem>;\r\n\r\n\tpublic overSoldRange!: ILineSeriesAxisRange;\r\n\tpublic overBoughtRange!: ILineSeriesAxisRange;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [\r\n\t\t{\r\n\t\t\tkey: \"period\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"overBought\",\r\n\t\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"overBoughtColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"overSold\",\r\n\t\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"overSoldColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}];\r\n\r\n\tprotected _themeTag: string = \"williamsr\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t//this.yAxis.setAll({ min: -100, max: 0, strictMinMax: true });\r\n\r\n\t\t// overbought range\r\n\t\tconst overBought = this.yAxis.makeDataItem({});\r\n\t\tthis.overBought = overBought;\r\n\r\n\t\toverBought.set(\"endValue\", 0);\r\n\t\tconst overBoughtRange = this.series.createAxisRange(overBought);\r\n\t\tthis.overBoughtRange = overBoughtRange;\r\n\t\tconst overBoughtFills = overBoughtRange.fills;\r\n\t\tif (overBoughtFills) {\r\n\t\t\toverBoughtFills.template.set(\"themeTags\", [\"overbought\", \"fill\"]);\r\n\t\t}\r\n\r\n\t\tconst overBoughtGrid = overBought.get(\"grid\");\r\n\t\tif (overBoughtGrid) {\r\n\t\t\toverBoughtGrid.setAll({ themeTags: [\"overbought\"], visible: true });\r\n\t\t\toverBoughtGrid._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overBoughtLabel = overBought.get(\"label\");\r\n\t\tif (overBoughtLabel) {\r\n\t\t\toverBoughtLabel.setAll({ themeTags: [\"overbought\"], visible: true, location: 0 });\r\n\t\t\toverBoughtLabel._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overSold = this.yAxis.makeDataItem({});\r\n\t\tthis.overSold = overSold;\r\n\r\n\t\toverSold.set(\"endValue\", -100);\r\n\t\tconst overSoldRange = this.series.createAxisRange(overSold);\r\n\t\tthis.overSoldRange = overSoldRange;\r\n\t\tconst overSoldFills = overSoldRange.fills;\r\n\t\tif (overSoldFills) {\r\n\t\t\toverSoldFills.template.set(\"themeTags\", [\"oversold\", \"fill\"]);\r\n\t\t}\r\n\r\n\t\tconst overSoldGrid = overSold.get(\"grid\");\r\n\t\tif (overSoldGrid) {\r\n\t\t\toverSoldGrid.setAll({ themeTags: [\"oversold\"], visible: true });\r\n\t\t\toverSoldGrid._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overSoldLabel = overSold.get(\"label\");\r\n\t\tif (overSoldLabel) {\r\n\t\t\toverSoldLabel.setAll({ themeTags: [\"oversold\"], visible: true, location: 0 });\r\n\t\t\toverSoldLabel._applyThemes();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"williams\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tconst overSoldValue = this.get(\"overSold\", -80);\r\n\t\tconst overBoughtValue = this.get(\"overBought\", -20);\r\n\r\n\t\tif (this.isDirty(\"overBought\")) {\r\n\t\t\tthis.overBought.set(\"value\", overBoughtValue);\r\n\r\n\t\t\tconst label = this.overBought.get(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"text\", this.getNumberFormatter().format(overBoughtValue));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overSold\")) {\r\n\t\t\tthis.overSold.set(\"value\", overSoldValue);\r\n\r\n\t\t\tconst label = this.overSold.get(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"text\", this.getNumberFormatter().format(overSoldValue));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overSoldColor\")) {\r\n\t\t\tconst color = this.get(\"overSoldColor\");\r\n\t\t\tconst label = this.overSold.get(\"label\");\r\n\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"fill\", color);\r\n\t\t\t}\r\n\r\n\t\t\tthis.overSold.get(\"grid\")!.set(\"stroke\", color);\r\n\t\t\tthis.overSoldRange.fills!.template.set(\"fill\", color);\r\n\t\t\tthis.overSoldRange.strokes!.template.set(\"stroke\", color);\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overBoughtColor\")) {\r\n\t\t\tconst color = this.get(\"overBoughtColor\");\r\n\t\t\tconst label = this.overBought.get(\"label\");\r\n\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"fill\", color);\r\n\t\t\t}\r\n\r\n\t\t\tthis.overBought.get(\"grid\")!.set(\"stroke\", color);\r\n\t\t\tthis.overBoughtRange.fills!.template.set(\"fill\", color);\r\n\t\t\tthis.overBoughtRange.strokes!.template.set(\"stroke\", color);\r\n\t\t}\r\n\r\n\t\tlet min = Math.min(overBoughtValue, overSoldValue)\r\n\t\tlet max = Math.max(overBoughtValue, overSoldValue)\r\n\r\n\t\tthis.series.get(\"yAxis\").set(\"baseValue\", min + (max - min) / 2);\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tthis.set(\"field\", \"close\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = this.get(\"period\", 14);\r\n\r\n\t\t\tfor (var i = 0, len = data.length; i < len; i++) {\r\n\t\t\t\tconst dataItem = data[i];\r\n\r\n\t\t\t\tlet h = -Infinity;\r\n\t\t\t\tlet l = Infinity;\r\n\t\t\t\tlet b = Math.max(0, i - period);\r\n\t\t\t\tfor (let j = b; j <= i; j++) {\r\n\r\n\t\t\t\t\tlet vh = dataItems[j].get(\"highValueY\", 0);\r\n\t\t\t\t\tif (vh >= h) {\r\n\t\t\t\t\t\th = vh;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet vl = dataItems[j].get(\"lowValueY\", 0);\r\n\t\t\t\t\tif (vl <= l) {\r\n\t\t\t\t\t\tl = vl;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdataItem.williams = -100 * (h - dataItem.value_y) / (h - l);\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\nimport { Color } from \"../../../core/util/Color\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IVolumeSettings extends IChartIndicatorSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tincreasingColor?: Color;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tdecreasingColor?: Color;\r\n}\r\n\r\nexport interface IVolumePrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IVolumeEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class Volume extends ChartIndicator {\r\n\tpublic static className: string = \"Volume\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([Volume.className]);\r\n\r\n\tdeclare public _settings: IVolumeSettings;\r\n\tdeclare public _privateSettings: IVolumePrivate;\r\n\tdeclare public _events: IVolumeEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"increasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Up volume\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"decreasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Down volume\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"volume\";\r\n\r\n\tpublic _createSeries(): ColumnSeries {\r\n\t\treturn this.panel.series.push(ColumnSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"volume\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"increasingColor\") || this.isDirty(\"decreasingColor\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tif(volumeSeries && stockChart){\r\n\t\t\t\tconst dataItems = volumeSeries.dataItems;\r\n\r\n\t\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\t\tlet decreasingColor = this.get(\"decreasingColor\", Color.fromHex(0xff0000));\r\n\t\t\t\tlet increasingColor = this.get(\"increasingColor\", Color.fromHex(0x00ff00));\r\n\r\n\t\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\t\tdataItem.volume = dataItem.value_y;\r\n\t\t\t\t})\r\n\t\t\t\tthis.series.data.setAll(data);\t\t\r\n\r\n\t\t\t\t$array.each(this.series.dataItems, (dataItem)=>{\r\n\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\tdataContext.volumeColor = stockChart.getVolumeColor(dataItem, decreasingColor, increasingColor);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { IValueAxisDataItem } from \"../../xy/axes/ValueAxis\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries, ILineSeriesAxisRange } from \"../../xy/series/LineSeries\";\r\n\r\nexport interface ICommodityChannelIndexSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverBought?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverSold?: number;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverBoughtColor?: Color;\r\n\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\toverSoldColor?: Color;\r\n\r\n}\r\n\r\nexport interface ICommodityChannelIndexPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface ICommodityChannelIndexEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class CommodityChannelIndex extends ChartIndicator {\r\n\tpublic static className: string = \"CommodityChannelIndex\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([CommodityChannelIndex.className]);\r\n\r\n\tdeclare public _settings: ICommodityChannelIndexSettings;\r\n\tdeclare public _privateSettings: ICommodityChannelIndexPrivate;\r\n\tdeclare public _events: ICommodityChannelIndexEvents;\r\n\r\n\tpublic overBought!: DataItem<IValueAxisDataItem>;\r\n\tpublic overSold!: DataItem<IValueAxisDataItem>;\r\n\r\n\tpublic overSoldRange!: ILineSeriesAxisRange;\r\n\tpublic overBoughtRange!: ILineSeriesAxisRange;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [\r\n\t\t{\r\n\t\t\tkey: \"period\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"overBought\",\r\n\t\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"overBoughtColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"overSold\",\r\n\t\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"overSoldColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}];\r\n\r\n\tprotected _themeTag: string = \"commoditychannelindex\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t//this.yAxis.setAll({ min: -100, max: 0, strictMinMax: true });\r\n\r\n\t\t// overbought range\r\n\t\tconst overBought = this.yAxis.makeDataItem({});\r\n\t\tthis.overBought = overBought;\r\n\r\n\t\toverBought.set(\"endValue\", 1000);\r\n\t\tconst overBoughtRange = this.series.createAxisRange(overBought);\r\n\t\tthis.overBoughtRange = overBoughtRange;\r\n\t\tconst overBoughtFills = overBoughtRange.fills;\r\n\t\tif (overBoughtFills) {\r\n\t\t\toverBoughtFills.template.set(\"themeTags\", [\"overbought\", \"fill\"]);\r\n\t\t}\r\n\r\n\t\tconst overBoughtGrid = overBought.get(\"grid\");\r\n\t\tif (overBoughtGrid) {\r\n\t\t\toverBoughtGrid.setAll({ themeTags: [\"overbought\"], visible: true });\r\n\t\t\toverBoughtGrid._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overBoughtLabel = overBought.get(\"label\");\r\n\t\tif (overBoughtLabel) {\r\n\t\t\toverBoughtLabel.setAll({ themeTags: [\"overbought\"], visible: true, location: 0 });\r\n\t\t\toverBoughtLabel._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overSold = this.yAxis.makeDataItem({});\r\n\t\tthis.overSold = overSold;\r\n\r\n\t\toverSold.set(\"endValue\", -1000);\r\n\t\tconst overSoldRange = this.series.createAxisRange(overSold);\r\n\t\tthis.overSoldRange = overSoldRange;\r\n\t\tconst overSoldFills = overSoldRange.fills;\r\n\t\tif (overSoldFills) {\r\n\t\t\toverSoldFills.template.set(\"themeTags\", [\"oversold\", \"fill\"]);\r\n\t\t}\r\n\r\n\t\tconst overSoldGrid = overSold.get(\"grid\");\r\n\t\tif (overSoldGrid) {\r\n\t\t\toverSoldGrid.setAll({ themeTags: [\"oversold\"], visible: true });\r\n\t\t\toverSoldGrid._applyThemes();\r\n\t\t}\r\n\r\n\t\tconst overSoldLabel = overSold.get(\"label\");\r\n\t\tif (overSoldLabel) {\r\n\t\t\toverSoldLabel.setAll({ themeTags: [\"oversold\"], visible: true, location: 0 });\r\n\t\t\toverSoldLabel._applyThemes();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"cci\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tconst overSoldValue = this.get(\"overSold\", 100);\r\n\t\tconst overBoughtValue = this.get(\"overBought\", -100);\r\n\r\n\t\tif (this.isDirty(\"overBought\")) {\r\n\t\t\tthis.overBought.set(\"value\", overBoughtValue);\r\n\r\n\t\t\tconst label = this.overBought.get(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"text\", this.getNumberFormatter().format(overBoughtValue));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overSold\")) {\r\n\t\t\tthis.overSold.set(\"value\", overSoldValue);\r\n\r\n\t\t\tconst label = this.overSold.get(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"text\", this.getNumberFormatter().format(overSoldValue));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overSoldColor\")) {\r\n\t\t\tconst color = this.get(\"overSoldColor\");\r\n\t\t\tconst label = this.overSold.get(\"label\");\r\n\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"fill\", color);\r\n\t\t\t}\r\n\r\n\t\t\tthis.overSold.get(\"grid\")!.set(\"stroke\", color);\r\n\t\t\tthis.overSoldRange.fills!.template.set(\"fill\", color);\r\n\t\t\tthis.overSoldRange.strokes!.template.set(\"stroke\", color);\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overBoughtColor\")) {\r\n\t\t\tconst color = this.get(\"overBoughtColor\");\r\n\t\t\tconst label = this.overBought.get(\"label\");\r\n\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.set(\"fill\", color);\r\n\t\t\t}\r\n\r\n\t\t\tthis.overBought.get(\"grid\")!.set(\"stroke\", color);\r\n\t\t\tthis.overBoughtRange.fills!.template.set(\"fill\", color);\r\n\t\t\tthis.overBoughtRange.strokes!.template.set(\"stroke\", color);\r\n\t\t}\r\n\r\n\t\tlet min = Math.min(overBoughtValue, overSoldValue)\r\n\t\tlet max = Math.max(overBoughtValue, overSoldValue)\r\n\r\n\t\tthis.series.get(\"yAxis\").set(\"baseValue\", min + (max - min) / 2);\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tthis.set(\"field\", \"close\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet data = this._getTypicalPrice(dataItems);\r\n\t\t\tlet period = this.get(\"period\", 20);\r\n\r\n\t\t\tthis._sma(data, period, \"value_y\", \"sma\");\r\n\r\n\t\t\tfor (let i = 0, len = data.length; i < len; i++) {\r\n\t\t\t\tconst dataItem = data[i];\r\n\t\t\t\tconst value = dataItem.value_y;\r\n\t\t\t\tlet ma = dataItem.sma;\r\n\r\n\t\t\t\tlet meanDeviation = 0;\r\n\t\t\t\tif (i >= period - 1) {\r\n\r\n\t\t\t\t\tfor (let j = i; j > i - period; j--) {\r\n\t\t\t\t\t\tlet di = data[j];\r\n\t\t\t\t\t\tmeanDeviation += Math.abs(di.value_y - ma)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmeanDeviation = meanDeviation / period;\r\n\t\t\t\t\tdataItem.cci = (value - ma) / (0.015 * meanDeviation);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IDisparityIndexSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Type of the moving average.\r\n\t *\r\n\t * @default \"simple\"\r\n\t */\r\n\tmovingAverageType?: \"simple\" | \"weighted\" | \"exponential\" | \"dema\" | \"tema\";\r\n\r\n}\r\n\r\nexport interface IDisparityIndexPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IDisparityIndexEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class DisparityIndex extends ChartIndicator {\r\n\tpublic static className: string = \"DisparityIndex\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([DisparityIndex.className]);\r\n\r\n\tdeclare public _settings: IDisparityIndexSettings;\r\n\tdeclare public _privateSettings: IDisparityIndexPrivate;\r\n\tdeclare public _events: IDisparityIndexEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}, {\r\n\t\tkey: \"movingAverageType\",\r\n\t\tname: this.root.language.translateAny(\"Moving Average Type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"disparityindex\";\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"disparity\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"movingAverageType\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t\tthis.setCustomData(\"movingAverageType\", this.get(\"movingAverageType\"));\r\n\t\t}\r\n\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst period = this.get(\"period\", 14);\r\n\t\t\tconst type = this.get(\"movingAverageType\");\r\n\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase \"simple\":\r\n\t\t\t\t\tthis._sma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"weighted\":\r\n\t\t\t\t\tthis._wma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"exponential\":\r\n\t\t\t\t\tthis._ema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dema\":\r\n\t\t\t\t\tthis._dema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tema\":\r\n\t\t\t\t\tthis._tema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tconst ma = dataItem.ma;\r\n\t\t\t\tif (ma != null) {\r\n\t\t\t\t\tdataItem.disparity = 100 * (dataItem.value_y - ma) / ma\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IDisposer } from \"../../../core/util/Disposer\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\nimport type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport type { DateAxis } from \"../../xy/axes/DateAxis\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\nimport type { Sprite } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { LineSeries, ILineSeriesSettings, ILineSeriesPrivate, ILineSeriesDataItem } from \"../../xy/series/LineSeries\";\r\nimport { Bullet } from \"../../../core/render/Bullet\";\r\nimport { Circle } from \"../../../core/render/Circle\";\r\nimport { Container } from \"../../../core/render/Container\";\r\nimport { Template } from \"../../../core/util/Template\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $time from \"../../../core/util/Time\";\r\nimport * as $type from \"../../../core/util/Type\";\r\nimport * as $math from \"../../../core/util/Math\";\r\nimport * as $object from \"../../../core/util/Object\";\r\n\r\nexport interface IDrawingSeriesDataItem extends ILineSeriesDataItem {\r\n}\r\n\r\nexport interface IDrawingSeriesSettings extends ILineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\txAxis: DateAxis<AxisRenderer>;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tyAxis: ValueAxis<AxisRenderer>;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tstrokeColor?: Color;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tfillColor?: Color;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tstrokeOpacity?: number;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tfillOpacity?: number;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tstrokeWidth?: number;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tstrokeDasharray?: Array<number>;\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tseries?: XYSeries;\r\n}\r\n\r\nexport interface IDrawingSeriesPrivate extends ILineSeriesPrivate {\r\n\r\n}\r\n\r\n\r\nexport class DrawingSeries extends LineSeries {\r\n\tpublic static className: string = \"DrawingSeries\";\r\n\tpublic static classNames: Array<string> = LineSeries.classNames.concat([DrawingSeries.className]);\r\n\r\n\tdeclare public _settings: IDrawingSeriesSettings;\r\n\tdeclare public _privateSettings: IDrawingSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IDrawingSeriesDataItem;\r\n\r\n\tprotected _clickDp?: IDisposer;\r\n\tprotected _moveDp?: IDisposer;\r\n\tprotected _downDp?: IDisposer;\r\n\tprotected _upDp?: IDisposer;\r\n\r\n\tprotected _drawingEnabled: boolean = false;\r\n\tprotected _isDragging: boolean = false;\r\n\r\n\tprotected _clickPointerPoint?: IPoint;\r\n\tprotected _movePointerPoint?: IPoint;\r\n\r\n\tprotected _isDrawing: boolean = false;\r\n\tprotected _isPointerDown: boolean = false;\r\n\r\n\tprotected _index: number = 0;\r\n\r\n\tprotected _di: Array<{ [index: string]: DataItem<IDrawingSeriesDataItem> }> = [];\r\n\r\n\tprotected _dragStartPX: number = 0;\r\n\tprotected _dragStartY: number = 0;\r\n\r\n\tprotected _dvpX: { [index: string]: number | undefined } = {};\r\n\tprotected _dvY: { [index: string]: number | undefined } = {};\r\n\r\n\tprotected _isHover: boolean = false;\r\n\r\n\tprotected _erasingEnabled: boolean = false;\r\n\r\n\tprotected _tag?: string;\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis.addTag(\"drawing\");\r\n\r\n\t\tif (this._tag) {\r\n\t\t\tthis.addTag(this._tag);\r\n\t\t}\r\n\r\n\t\tthis.set(\"valueYField\", \"valueY\");\r\n\t\tthis.set(\"valueXField\", \"valueX\");\r\n\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis._di[0] = {};\r\n\r\n\t\tthis.set(\"connect\", false);\r\n\t\tthis.set(\"autoGapCount\", Infinity);\r\n\t\tthis.set(\"ignoreMinMax\", true);\r\n\r\n\t\tconst strokesTemplate = this.strokes.template;\r\n\t\tstrokesTemplate.set(\"templateField\", \"stroke\");\r\n\r\n\t\tconst fillsTemplate = this.fills.template;\r\n\t\tfillsTemplate.setAll({ templateField: \"fill\" });\r\n\r\n\r\n\t\tfillsTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._handleFillDragStart(e, this._getIndex(e.target));\r\n\r\n\t\t\tthis._isPointerDown = true;\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"pointerdown\", (e) => {\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tthis._disposeIndex(index);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\tif (!originalEvent.button && this._drawingEnabled) {\r\n\t\t\t\t\tthis._handlePointerDown(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst stroke = this.strokes.getIndex(this._getStrokeIndex(index));\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.dragStart(e);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"pointerdown\", (e) => {\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tthis._disposeIndex(this._getIndex(e.target));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\tif (!originalEvent.button && this._drawingEnabled) {\r\n\t\t\t\t\tthis._handlePointerDown(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tthis._isPointerDown = false;\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\t\t\tthis._handleFillDragStop(e, index);\r\n\r\n\t\t\tconst stroke = this.strokes.getIndex(this._getStrokeIndex(index));\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.dragStop(e);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\t\t\tconst stroke = this.strokes.getIndex(this._getStrokeIndex(index));\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.hover();\r\n\t\t\t}\r\n\t\t\tthis._isHover = true;\r\n\t\t\tthis._showSegmentBullets(index);\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"pointerout\", () => {\r\n\t\t\tthis._isHover = false;\r\n\t\t\tthis._hideAllBullets();\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tthis._isHover = true;\r\n\t\t\tthis._showSegmentBullets(this._getIndex(e.target));\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"pointerout\", () => {\r\n\t\t\tthis._isHover = false;\r\n\t\t\tthis._hideAllBullets();\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tthis._handleFillDragStop(e, this._getIndex(e.target));\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._handleFillDragStart(e, this._getIndex(e.target));\r\n\t\t})\r\n\r\n\t\tthis.set(\"groupDataDisabled\", true);\r\n\t\tthis.bulletsContainer.states.create(\"hidden\", { visible: true, opacity: 0 });\r\n\r\n\t\tthis.bullets.push(() => {\r\n\t\t\tconst color = this.get(\"strokeColor\", this.get(\"stroke\"));\r\n\r\n\t\t\tconst container = Container.new(this._root, {\r\n\t\t\t\tthemeTags: [\"grip\"],\r\n\t\t\t\tsetStateOnChildren: true,\r\n\t\t\t\tdraggable: true\r\n\t\t\t})\r\n\r\n\t\t\tcontainer.children.push(Circle.new(this._root, {\r\n\t\t\t\tthemeTags: [\"outline\"],\r\n\t\t\t\tstroke: color\r\n\t\t\t}))\r\n\r\n\t\t\tcontainer.children.push(Circle.new(this._root, {\r\n\t\t\t\tstroke: color\r\n\t\t\t}));\r\n\r\n\t\t\tcontainer.events.on(\"pointerover\", (event) => {\r\n\t\t\t\tconst dataItem = event.target.dataItem;\r\n\t\t\t\tif (dataItem) {\r\n\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\tthis._showSegmentBullets(dataContext.index);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tcontainer.events.on(\"pointerout\", () => {\r\n\t\t\t\tthis._hideAllBullets();\r\n\t\t\t})\r\n\r\n\t\t\tthis._addBulletInteraction(container);\r\n\r\n\t\t\tthis._tweakBullet(container);\r\n\r\n\t\t\treturn Bullet.new(this._root, {\r\n\t\t\t\tlocationX: undefined,\r\n\t\t\t\tsprite: container\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.events.on(\"pointerover\", () => {\r\n\t\t\tthis._handlePointerOver();\r\n\t\t})\r\n\r\n\t\tthis.events.on(\"pointerout\", () => {\r\n\t\t\tthis._handlePointerOut();\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _disposeIndex(index: number) {\r\n\t\tconst dataItems = this._di[index];\r\n\r\n\t\tif (dataItems) {\r\n\t\t\t$object.each(dataItems, (_key, dataItem) => {\r\n\t\t\t\tthis.disposeDataItem(dataItem);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clearDrawings(): void {\r\n\t\t$array.each(this._di, (_dataItems, index) => {\r\n\t\t\tthis._disposeIndex(index);\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _getIndex(sprite: Sprite): number {\r\n\t\tconst userData = sprite.get(\"userData\");\r\n\t\tif (userData && userData.length > 0) {\r\n\t\t\tconst dataItem = this.dataItems[userData[0]];\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\tif (dataContext) {\r\n\t\t\t\t\treturn dataContext.index;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tprotected _getStrokeIndex(index: number) {\r\n\t\tlet i = 0;\r\n\t\tlet c = index;\r\n\t\tthis.strokes.each((stroke) => {\r\n\t\t\tconst strokeIndex = this._getIndex(stroke);\r\n\t\t\tif (strokeIndex == index) {\r\n\t\t\t\tc = i;\r\n\t\t\t}\r\n\t\t\ti++;\r\n\t\t})\r\n\t\treturn c;\r\n\t}\r\n\r\n\tprotected _showSegmentBullets(index: number) {\r\n\t\tconst dataItems = this._di[index];\r\n\t\tif (dataItems) {\r\n\t\t\t$object.each(dataItems, (_key, dataItem) => {\r\n\t\t\t\tconst bullets = dataItem.bullets;\r\n\t\t\t\tif (bullets) {\r\n\t\t\t\t\t$array.each(bullets, (bullet) => {\r\n\t\t\t\t\t\tconst sprite = bullet.get(\"sprite\");\r\n\t\t\t\t\t\tif (sprite) {\r\n\t\t\t\t\t\t\tsprite.show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\t\tthis.strokes.each((stroke) => {\r\n\t\t\tstroke.unhover();\r\n\t\t})\r\n\r\n\t\tif (!this._drawingEnabled && !this._isDragging) {\r\n\t\t\tconst dataItems = this.dataItems;\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tconst bullets = dataItem.bullets;\r\n\t\t\t\tif (bullets) {\r\n\t\t\t\t\t$array.each(bullets, (bullet) => {\r\n\t\t\t\t\t\tconst sprite = bullet.get(\"sprite\");\r\n\t\t\t\t\t\tif (sprite) {\r\n\t\t\t\t\t\t\tsprite.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleFillDragStart(event: ISpritePointerEvent, index: number) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\r\n\t\t\tthis._dragStartPX = xAxis.coordinateToPosition(point.x);\r\n\t\t\tthis._dragStartY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)));\r\n\r\n\t\t\tconst dataItems = this._di[index];\r\n\t\t\tif (dataItems) {\r\n\t\t\t\t$object.each(dataItems, (key, dataItem) => {\r\n\t\t\t\t\tthis._dvpX[key] = xAxis.valueToPosition(dataItem.get(\"valueX\", 0));\r\n\t\t\t\t\tthis._dvY[key] = dataItem.get(\"valueY\");\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleFillDragStop(event: ISpritePointerEvent, index: number) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst posX = xAxis.coordinateToPosition(point.x);\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)));\r\n\r\n\t\t\tconst dpx = posX - this._dragStartPX;\r\n\t\t\tconst dy = valueY - this._dragStartY;\r\n\r\n\t\t\tconst dataItems = this._di[index];\r\n\r\n\t\t\tif (dataItems) {\r\n\t\t\t\t$object.each(dataItems, (key, dataItem) => {\r\n\t\t\t\t\tconst dvpx = this._dvpX[key];\r\n\t\t\t\t\tconst dvy = this._dvY[key];\r\n\t\t\t\t\tif ($type.isNumber(dvpx) && $type.isNumber(dvy)) {\r\n\r\n\t\t\t\t\t\tconst vpx = dvpx + dpx;\r\n\t\t\t\t\t\tconst vy = dvy + dy;\r\n\t\t\t\t\t\tconst vx = this._getXValue(xAxis.positionToValue(vpx))\r\n\r\n\t\t\t\t\t\tdataItem.set(\"valueX\", vx);\r\n\t\t\t\t\t\tthis._setXLocation(dataItem, vx);\r\n\r\n\t\t\t\t\t\tdataItem.set(\"valueY\", vy);\r\n\t\t\t\t\t\tdataItem.set(\"valueYWorking\", vy);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._updateSegment(index);\r\n\t\tthis._updateElements();\r\n\t}\r\n\r\n\tprotected _updateSegment(_index: number) {\r\n\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\r\n\t\tif (this.isDirty(\"strokeColor\") || this.isDirty(\"fillColor\") || this.isDirty(\"strokeOpacity\") || this.isDirty(\"fillOpacity\") || this.isDirty(\"strokeWidth\") || this.isDirty(\"strokeDasharray\")) {\r\n\t\t\tthis.data.push({ stroke: this._getStrokeTemplate(), fill: this._getFillTemplate() });\r\n\t\t}\r\n\r\n\t\tthis._updateElements();\r\n\t\tsuper._updateChildren();\r\n\t}\r\n\r\n\tprotected _getFillTemplate(): Template<any> {\r\n\t\tconst fillTemplate: any = {};\r\n\r\n\t\tconst fillColor = this.get(\"fillColor\");\r\n\t\tif (fillColor != null) {\r\n\t\t\tfillTemplate.fill = fillColor;\r\n\t\t}\r\n\r\n\t\tconst fillOpacity = this.get(\"fillOpacity\");\r\n\t\tif (fillOpacity != null) {\r\n\t\t\tfillTemplate.fillOpacity = fillOpacity;\r\n\t\t}\r\n\r\n\t\treturn Template.new(fillTemplate);\r\n\t}\r\n\r\n\tprotected _getStrokeTemplate(): Template<any> {\r\n\t\tconst strokeTemplate: any = {};\r\n\r\n\t\tconst strokeColor = this.get(\"strokeColor\");\r\n\t\tif (strokeColor != null) {\r\n\t\t\tstrokeTemplate.stroke = strokeColor;\r\n\t\t}\r\n\r\n\t\tconst strokeOpacity = this.get(\"strokeOpacity\");\r\n\t\tif (strokeOpacity != null) {\r\n\t\t\tstrokeTemplate.strokeOpacity = strokeOpacity;\r\n\t\t}\r\n\r\n\t\tconst strokeDasharray = this.get(\"strokeDasharray\");\r\n\t\tif (strokeDasharray != null) {\r\n\t\t\tstrokeTemplate.strokeDasharray = strokeDasharray;\r\n\t\t}\r\n\r\n\t\tconst strokeWidth = this.get(\"strokeWidth\");\r\n\t\tif (strokeWidth != null) {\r\n\t\t\tstrokeTemplate.strokeWidth = strokeWidth;\r\n\t\t}\r\n\r\n\t\treturn Template.new(strokeTemplate);\r\n\t}\r\n\r\n\tprotected _updateElements() {\r\n\r\n\t}\r\n\r\n\tprotected _tweakBullet(_container: Container) {\r\n\r\n\t}\r\n\r\n\tprotected _addBulletInteraction(sprite: Sprite) {\r\n\t\tsprite.events.on(\"dragged\", (e) => {\r\n\t\t\tthis._handleBulletDragged(e);\r\n\t\t\tthis._isDragging = true;\r\n\t\t})\r\n\r\n\t\tsprite.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._handleBulletDragStart(e);\r\n\t\t})\r\n\r\n\t\tsprite.events.on(\"dragstop\", (e) => {\r\n\t\t\tthis._handleBulletDragStop(e);\r\n\t\t\tthis.setTimeout(() => {\r\n\t\t\t\tthis._isDragging = false;\r\n\t\t\t}, 100)\r\n\t\t})\r\n\r\n\t\tsprite.events.on(\"click\", (e) => {\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tconst dataItem = e.target.dataItem;\r\n\t\t\t\tif (dataItem) {\r\n\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\tif (dataContext) {\r\n\t\t\t\t\t\tthis._disposeIndex(dataContext.index);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._handlePointerClick(e);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tthis._clickPointerPoint = chart.plotContainer.toLocal(event.point)\r\n\t\t}\r\n\t}\r\n\r\n\t// need this in order bullets not to be placed to the charts bullets container\r\n\tpublic _placeBulletsContainer() {\r\n\t\tthis.children.moveValue(this.bulletsContainer);\r\n\t}\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\r\n\t\tconst dataItem = event.target.dataItem as DataItem<this[\"_dataItemSettings\"]>;\r\n\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst target = event.target;\r\n\t\t\tconst point = { x: target.x(), y: target.y() };\r\n\t\t\tthis._handleBulletDraggedReal(dataItem, point);\r\n\t\t}\r\n\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tthis._updateSegment(index);\r\n\t\t\tthis._updateElements();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletDraggedReal(dataItem: DataItem<this[\"_dataItemSettings\"]>, point: IPoint) {\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(point.x)));\r\n\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)));\r\n\r\n\t\tdataItem.set(\"valueX\", valueX);\r\n\t\tthis._setXLocation(dataItem, valueX);\r\n\r\n\t\tdataItem.set(\"valueY\", valueY);\r\n\t\tdataItem.set(\"valueYWorking\", valueY);\r\n\r\n\t\tthis._positionBullets(dataItem);\r\n\t}\r\n\r\n\tprotected _handleBulletDragStart(_event: ISpritePointerEvent) {\r\n\r\n\t}\r\n\r\n\tprotected _handleBulletDragStop(_event: ISpritePointerEvent) {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerOver() {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerOut() {\r\n\r\n\t}\r\n\r\n\tprotected _addContextInfo(index: number, corner?: any) {\r\n\t\tconst dataItems = this.dataItems;\r\n\t\tconst len = dataItems.length;\r\n\t\tconst dataItem = dataItems[len - 1];\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tdataContext.index = index;\r\n\t\t\tif (corner != null) {\r\n\t\t\t\tdataContext.corner = corner;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!this._di[index]) {\r\n\t\t\tthis._di[index] = {};\r\n\t\t}\r\n\t\tthis._di[index][corner] = dataItem;\r\n\t}\r\n\r\n\tpublic enableDrawing() {\r\n\t\tconst chart = this.chart;\r\n\t\tthis._erasingEnabled = false;\r\n\t\tthis._drawingEnabled = true;\r\n\t\tif (chart) {\r\n\t\t\tif (!this._clickDp) {\r\n\t\t\t\tthis._clickDp = chart.plotContainer.events.on(\"click\", (e) => {\r\n\t\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\t\tif (!originalEvent.button && !this._erasingEnabled) {\r\n\t\t\t\t\t\tthis._handlePointerClick(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._downDp) {\r\n\t\t\t\tthis._downDp = chart.plotContainer.events.on(\"pointerdown\", (e) => {\r\n\t\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\t\tif (!originalEvent.button && !this._erasingEnabled) {\r\n\t\t\t\t\t\tthis._handlePointerDown(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._upDp) {\r\n\t\t\t\tthis._upDp = chart.plotContainer.events.on(\"globalpointerup\", (e) => {\r\n\t\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\t\tif (!originalEvent.button && !this._erasingEnabled) {\r\n\t\t\t\t\t\tthis._handlePointerUp(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._moveDp) {\r\n\t\t\t\tthis._moveDp = chart.plotContainer.events.on(\"globalpointermove\", (e) => {\r\n\t\t\t\t\tif (!this._erasingEnabled) {\r\n\t\t\t\t\t\tthis._handlePointerMove(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic enableErasing() {\r\n\t\tthis._erasingEnabled = true;\r\n\t}\r\n\r\n\tpublic disableErasing() {\r\n\t\tthis._erasingEnabled = false;\r\n\t}\r\n\r\n\tpublic disableDrawing() {\r\n\t\tthis._erasingEnabled = false;\r\n\t\tthis._drawingEnabled = false;\r\n\t\tthis._isDrawing = false;\r\n\t\tif (this._clickDp) {\r\n\t\t\tthis._clickDp.dispose();\r\n\t\t\tthis._clickDp = undefined;\r\n\t\t}\r\n\r\n\t\tif (this._downDp) {\r\n\t\t\tthis._downDp.dispose();\r\n\t\t\tthis._downDp = undefined;\r\n\t\t}\r\n\r\n\t\tif (this._upDp) {\r\n\t\t\tthis._upDp.dispose();\r\n\t\t\tthis._upDp = undefined;\r\n\t\t}\r\n\t\tthis._hideAllBullets();\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tthis._movePointerPoint = chart.plotContainer.toLocal(event.point)\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerDown(_event: ISpritePointerEvent) {\r\n\t\tthis._isPointerDown = true;\r\n\t}\r\n\r\n\tprotected _handlePointerUp(_event: ISpritePointerEvent) {\r\n\t\tthis._isPointerDown = false;\r\n\t}\r\n\r\n\tpublic startIndex(): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tpublic endIndex(): number {\r\n\t\treturn this.dataItems.length;\r\n\t}\r\n\r\n\tprotected _setXLocation(dataItem: DataItem<this[\"_dataItemSettings\"]>, value: number) {\r\n\t\tthis._setXLocationReal(dataItem, value);\r\n\t}\r\n\r\n\tprotected _setXLocationReal(dataItem: DataItem<this[\"_dataItemSettings\"]>, value: number) {\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst baseInterval = xAxis.getPrivate(\"baseInterval\");\r\n\t\tconst open = $time.round(new Date(value), baseInterval.timeUnit, baseInterval.count, this._root.locale.firstDayOfWeek, this._root.utc).getTime();\r\n\t\tconst close = $time.add(new Date(open), baseInterval.timeUnit, baseInterval.count, this._root.utc).getTime();\r\n\t\tconst locationX = (value - open) / (close - open);\r\n\t\tdataItem.set(\"locationX\", locationX);\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\r\n\t\t\t$array.removeFirst(this.dataItems, dataItem);\r\n\t\t\tthis.markDirtyValues();\r\n\r\n\t\t\tconst dataItems = this._di[index];\r\n\r\n\t\t\tif (dataItems) {\r\n\t\t\t\t$object.each(dataItems, (_key, dataItem) => {\r\n\t\t\t\t\tsuper.disposeDataItem(dataItem);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprotected _getYValue(value: number): number {\r\n\t\tif (this.get(\"valueYShow\") == \"valueYChangeSelectionPercent\") {\r\n\t\t\tconst baseValueSeries = this.getPrivate(\"baseValueSeries\");\r\n\t\t\tif (baseValueSeries) {\r\n\t\t\t\tconst baseValue = baseValueSeries._getBase(\"valueY\");\r\n\t\t\t\tvalue = value / 100 * baseValue + baseValue;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tprotected _getXValue(value: number): number {\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst min = xAxis.getPrivate(\"min\", 0) + 1;\r\n\t\tconst max = xAxis.getPrivate(\"max\", 1) - 1;\r\n\t\treturn $math.fitToRange(value, min, max);\r\n\t}\t\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\n\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IPolylineSeriesDataItem extends IDrawingSeriesDataItem { }\r\n\r\nexport interface IPolylineSeriesSettings extends IDrawingSeriesSettings { }\r\n\r\nexport interface IPolylineSeriesPrivate extends IDrawingSeriesPrivate { }\r\n\r\nexport class PolylineSeries extends DrawingSeries {\r\n\tpublic static className: string = \"PolylineSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([PolylineSeries.className]);\r\n\r\n\tdeclare public _settings: IPolylineSeriesSettings;\r\n\tdeclare public _privateSettings: IPolylineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IPolylineSeriesDataItem;\r\n\r\n\t// point index in segment\r\n\tprotected _pIndex: number = 0;\r\n\r\n\tprotected _tag = \"polyline\";\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerClick(event);\r\n\r\n\t\tif (!this._isDragging) {\r\n\t\t\tthis._isDrawing = true;\r\n\r\n\t\t\tif (this._pIndex == 0) {\r\n\t\t\t\tthis.data.push({ stroke: this._getStrokeTemplate() });\r\n\t\t\t\tthis._addContextInfo(this._index);\r\n\t\t\t}\r\n\r\n\t\t\tthis._addPoint(event);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletDragStop(event: ISpritePointerEvent) {\r\n\t\tsuper._handleBulletDragStop(event);\r\n\t\tthis._checkClosing(event);\r\n\t}\r\n\r\n\tprotected _addPoint(event: ISpritePointerEvent) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\r\n\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(point.x)));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)));\r\n\r\n\t\t\tconst dataItems = this.dataItems;\r\n\t\t\tconst len = dataItems.length;\r\n\r\n\t\t\tthis.data.push({ valueY: valueY, valueX: valueX });\r\n\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\r\n\t\t\tthis._addContextInfo(this._index, this._pIndex);\r\n\r\n\t\t\tconst dataItem = dataItems[len];\r\n\t\t\tthis._positionBullets(dataItem);\r\n\r\n\t\t\tthis._setXLocation(dataItem, valueX);\r\n\r\n\t\t\tthis._pIndex++;\r\n\t\t\tthis._handleClosing(dataItem, point);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _checkClosing(event: ISpritePointerEvent) {\r\n\t\tconst dataItem = event.target.dataItem;\r\n\t\tif (dataItem) {\r\n\t\t\tconst sprite = event.target;\r\n\t\t\tconst point = { x: sprite.x(), y: sprite.y() }\r\n\t\t\tthis._handleClosing(dataItem, point);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleClosing(dataItem: DataItem<this[\"_dataItemSettings\"]>, point: IPoint) {\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (!dataContext.closing) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst firstDataItem = this._di[index][0];\r\n\r\n\t\t\tif (firstDataItem && firstDataItem != dataItem) {\r\n\t\t\t\tconst dPoint = firstDataItem.get(\"point\");\r\n\t\t\t\tif (dPoint) {\r\n\t\t\t\t\tif (Math.hypot(point.x - dPoint.x, point.y - dPoint.y) < 5) {\r\n\t\t\t\t\t\tdataContext.closing = firstDataItem;\r\n\r\n\t\t\t\t\t\tthis._pIndex = 0;\r\n\t\t\t\t\t\tthis._index++;\r\n\r\n\t\t\t\t\t\tthis.data.push({ stroke: this._getStrokeTemplate() });\r\n\t\t\t\t\t\tthis._addContextInfo(this._index, \"e\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateElements() {\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext) {\r\n\t\t\t\tconst closing = dataContext.closing;\r\n\t\t\t\tif (closing) {\r\n\t\t\t\t\tconst valueX = closing.get(\"valueX\", 0);\r\n\t\t\t\t\tconst valueY = closing.get(\"valueY\");\r\n\t\t\t\t\tdataItem.set(\"valueX\", valueX);\r\n\t\t\t\t\tthis._setXLocation(dataItem, valueX);\r\n\t\t\t\t\tdataItem.set(\"valueY\", valueY);\r\n\t\t\t\t\tdataItem.set(\"valueYWorking\", valueY);\r\n\t\t\t\t\tthis._positionBullets(dataItem);\r\n\r\n\t\t\t\t\tconst bullets = dataItem.bullets;\r\n\t\t\t\t\tif (bullets) {\r\n\t\t\t\t\t\t$array.each(bullets, (bullet) => {\r\n\t\t\t\t\t\t\tconst sprite = bullet.get(\"sprite\");\r\n\t\t\t\t\t\t\tif (sprite) {\r\n\t\t\t\t\t\t\t\tsprite.set(\"forceHidden\", true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\n\r\nexport interface IRectangleSeriesDataItem extends IDrawingSeriesDataItem {\r\n}\r\n\r\nexport interface IRectangleSeriesSettings extends IDrawingSeriesSettings {\r\n}\r\n\r\nexport interface IRectangleSeriesPrivate extends IDrawingSeriesPrivate {\r\n}\r\n\r\nexport class RectangleSeries extends DrawingSeries {\r\n\tpublic static className: string = \"RectangleSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([RectangleSeries.className]);\r\n\r\n\tdeclare public _settings: IRectangleSeriesSettings;\r\n\tdeclare public _privateSettings: IRectangleSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IRectangleSeriesDataItem;\r\n\r\n\tprotected _index: number = 0;\r\n\r\n\tprotected _di: Array<{ [index: string]: DataItem<IRectangleSeriesDataItem> }> = []\r\n\r\n\tprotected _tag = \"rectangle\";\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tsuper._handleBulletDragged(event);\r\n\r\n\t\tconst dataItem = event.target.dataItem as DataItem<IRectangleSeriesDataItem>;\r\n\t\tconst movePoint = this._movePointerPoint;\r\n\t\tif (dataItem && movePoint) {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst corner = dataContext.corner;\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst valueX = xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)));\r\n\r\n\t\t\tconst vx = \"valueX\"\r\n\t\t\tconst vy = \"valueY\"\r\n\t\t\tconst vwy = \"valueYWorking\";\r\n\r\n\t\t\tdataItem.set(vx, valueX);\r\n\t\t\tdataItem.set(vy, valueY);\r\n\t\t\tdataItem.set(vwy, valueY);\r\n\r\n\t\t\tthis._setXLocation(dataItem, valueX);\r\n\r\n\t\t\tthis._positionBullets(dataItem);\r\n\r\n\t\t\tconst items = this._di[index];\r\n\t\t\tconst blDI = items[\"bl\"];\r\n\t\t\tconst brDI = items[\"br\"];\r\n\t\t\tconst tlDI = items[\"tl\"];\r\n\t\t\tconst trDI = items[\"tr\"];\r\n\t\t\tconst tlDI2 = items[\"tl2\"];\r\n\r\n\t\t\tif (blDI && brDI && tlDI && trDI && tlDI2) {\r\n\t\t\t\tif (corner == \"br\") {\r\n\t\t\t\t\tblDI.set(vy, valueY);\r\n\t\t\t\t\tblDI.set(vwy, valueY);\r\n\r\n\t\t\t\t\ttrDI.set(vx, valueX);\r\n\t\t\t\t\tthis._setXLocation(trDI, valueX);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (corner == \"tr\") {\r\n\t\t\t\t\tbrDI.set(vx, valueX);\r\n\t\t\t\t\tthis._setXLocation(brDI, valueX);\r\n\r\n\t\t\t\t\ttlDI.set(vy, valueY);\r\n\t\t\t\t\ttlDI.set(vwy, valueY);\r\n\r\n\t\t\t\t\ttlDI2.set(\"valueY\", valueY);\r\n\t\t\t\t\ttlDI2.set(vwy, valueY);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (corner == \"bl\") {\r\n\t\t\t\t\tbrDI.set(vy, valueY);\r\n\t\t\t\t\tbrDI.set(vwy, valueY);\r\n\r\n\t\t\t\t\ttlDI.set(vx, valueX);\r\n\t\t\t\t\ttlDI2.set(vx, valueX);\r\n\r\n\t\t\t\t\tthis._setXLocation(tlDI, valueX);\r\n\t\t\t\t\tthis._setXLocation(tlDI2, valueX);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (corner == \"tl2\") {\r\n\t\t\t\t\tblDI.set(vx, valueX);\r\n\t\t\t\t\tthis._setXLocation(blDI, valueX);\r\n\r\n\t\t\t\t\ttrDI.set(vy, valueY);\r\n\t\t\t\t\ttrDI.set(vwy, valueY);\r\n\r\n\t\t\t\t\ttlDI.set(vx, valueX);\r\n\t\t\t\t\tthis._setXLocation(tlDI, valueX);\r\n\r\n\t\t\t\t\ttlDI.set(vy, valueY);\r\n\t\t\t\t\ttlDI.set(vwy, valueY);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerClick(event);\r\n\r\n\t\tif (!this._isDragging) {\r\n\r\n\t\t\tif (!this._isDrawing) {\r\n\t\t\t\tthis._isDrawing = true;\r\n\t\t\t\tthis.bulletsContainer.show();\r\n\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._isDrawing = false;\r\n\t\t\t\tthis._index++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerMove(event);\r\n\t\tif (this._isDrawing) {\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (movePoint) {\r\n\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)));\r\n\r\n\t\t\t\tconst index = this._index;\r\n\t\t\t\tconst diTR = this._di[index][\"tr\"];\r\n\t\t\t\tconst diBR = this._di[index][\"br\"];\r\n\t\t\t\tconst diBL = this._di[index][\"bl\"];\r\n\r\n\t\t\t\tif (diTR && diBR && diBL) {\r\n\t\t\t\t\tdiTR.set(\"valueX\", valueX);\r\n\t\t\t\t\tdiBR.set(\"valueX\", valueX);\r\n\r\n\t\t\t\t\tthis._setXLocation(diTR, valueX);\r\n\t\t\t\t\tthis._setXLocation(diBR, valueX);\r\n\r\n\t\t\t\t\tdiBR.set(\"valueY\", valueY);\r\n\t\t\t\t\tdiBR.set(\"valueYWorking\", valueY);\r\n\r\n\t\t\t\t\tdiBL.set(\"valueY\", valueY);\r\n\t\t\t\t\tdiBL.set(\"valueYWorking\", valueY);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\t\t\tconst valueX = xAxis.positionToValue(xAxis.coordinateToPosition(point.x));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)));\r\n\r\n\t\t\tthis._di[index] = {};\r\n\t\t\tthis.data.push({ stroke: this._getStrokeTemplate() })\r\n\t\t\tthis._addContextInfo(index, \"empty\");\r\n\r\n\t\t\tthis._addPoint(valueX, valueY, \"tl\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"tr\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"br\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"bl\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"tl2\", index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoint(valueX: number | null, valueY: number | null, corner: string, index: number): any {\r\n\r\n\t\tthis.data.push({ valueY: valueY, valueX: valueX });\r\n\t\tconst len = this.dataItems.length;\r\n\t\tconst dataItem = this.dataItems[len - 1];\r\n\t\tif (dataItem) {\r\n\t\t\tif (valueX != null) {\r\n\t\t\t\tthis._setXLocation(dataItem, valueX);\r\n\t\t\t}\r\n\r\n\t\t\tthis._addContextInfo(index, corner);\r\n\r\n\t\t\tthis._di[index][corner] = dataItem;\r\n\r\n\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\r\n\t\t\treturn dataItem.dataContext;\r\n\t\t}\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\n\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\nimport { Line } from \"../../../core/render/Line\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport * as $math from \"../../../core/util/Math\";\r\n\r\nexport interface ISimpleLineSeriesDataItem extends IDrawingSeriesDataItem {\r\n\r\n}\r\n\r\nexport interface ISimpleLineSeriesSettings extends IDrawingSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tshowExtension?: boolean;\r\n}\r\n\r\nexport interface ISimpleLineSeriesPrivate extends IDrawingSeriesPrivate {\r\n\r\n}\r\n\r\nexport class SimpleLineSeries extends DrawingSeries {\r\n\tpublic static className: string = \"SimpleLineSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([SimpleLineSeries.className]);\r\n\r\n\tdeclare public _settings: ISimpleLineSeriesSettings;\r\n\tdeclare public _privateSettings: ISimpleLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ISimpleLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"line\";\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeLine(): Line {\r\n\t\tconst line = this.lines.make();\r\n\t\tthis.mainContainer.children.push(line);\r\n\t\tthis.lines.push(line);\r\n\t\treturn line;\r\n\t}\r\n\r\n\tpublic readonly lines: ListTemplate<Line> = new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Line._new(this._root, {}, [this.lines.template])\r\n\t);\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeHitLine(): Line {\r\n\t\tconst line = this.hitLines.make();\r\n\t\tline.addTag(\"hit\");\r\n\t\tthis.mainContainer.children.push(line);\r\n\t\tthis.hitLines.push(line);\r\n\t\treturn line;\r\n\t}\r\n\r\n\r\n\r\n\tpublic readonly hitLines: ListTemplate<Line> = new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Line._new(this._root, {}, [this.hitLines.template])\r\n\t);\r\n\r\n\tprotected _di: Array<{ [index: string]: DataItem<ISimpleLineSeriesDataItem> }> = [];\r\n\tprotected _lines: Array<Line> = [];\r\n\tprotected _hitLines: Array<Line> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tconst lineTemplate = this.lines.template;\r\n\t\tlineTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tthis._showSegmentBullets(e.target.get(\"userData\"));\r\n\t\t})\r\n\r\n\t\tlineTemplate.events.on(\"pointerout\", (e) => {\r\n\t\t\tthis._hideAllBullets();\r\n\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\r\n\t\t\tconst line = this._lines[index];\r\n\t\t\tif (line) {\r\n\t\t\t\tline.unhover();\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.unhover();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tconst hitTemplate = this.hitLines.template;\r\n\t\thitTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\t\t\tthis._showSegmentBullets(index);\r\n\r\n\t\t\tconst line = this._lines[index];\r\n\r\n\t\t\tif (line) {\r\n\t\t\t\tline.hover();\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.hover();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\thitTemplate.events.on(\"click\", (e) => {\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tthis._disposeIndex(e.target.get(\"userData\"));\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\thitTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\t\t\tconst line = this._lines[index];\r\n\r\n\t\t\tif (line) {\r\n\t\t\t\tline.dragStart(e);\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.dragStart(e);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\thitTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\r\n\t\t\tthis.markDirtyValues();\r\n\t\t\te.target.setAll({ x: 0, y: 0 });\r\n\t\t\tconst line = this._lines[index];\r\n\r\n\t\t\tif (line) {\r\n\t\t\t\tline.dragStop(e);\r\n\t\t\t\tline.setAll({ x: 0, y: 0 });\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.dragStop(e);\r\n\t\t\t\tstroke.setAll({ x: 0, y: 0 });\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\thitTemplate.events.on(\"pointerout\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\t\t\tthis._hideAllBullets();\r\n\r\n\t\t\tconst line = this._lines[index];\r\n\r\n\t\t\tif (line) {\r\n\t\t\t\tline.unhover();\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.unhover();\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tprotected _updateElements() {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst s = Math.max(chart.plotContainer.width(), chart.plotContainer.height()) * 2;\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tconst hitLine = this._hitLines[i];\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\r\n\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\tconst len = Math.max(Math.abs(s - p1.x), Math.abs(s - p2.x), Math.abs(s - p1.y), Math.abs(s - p2.y), Math.abs(p1.x), Math.abs(p2.x), Math.abs(p1.y), Math.abs(p2.y))\r\n\t\t\t\t\t\tlet angle = $math.getAngle(p2, p1);\r\n\r\n\t\t\t\t\t\tconst p11 = { x: p1.x + len * $math.cos(angle), y: p1.y + len * $math.sin(angle) };\r\n\t\t\t\t\t\tconst p22 = { x: p2.x - len * $math.cos(angle), y: p2.y - len * $math.sin(angle) };\r\n\t\t\t\t\t\tthis._updateLine(line, hitLine, p11, p22, p1, p2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateLine(line: Line, hitLine: Line, p11: IPoint, p22: IPoint, p1: IPoint, p2: IPoint) {\r\n\t\tlet segments = [[[p11, p1]], [[p2, p22]]];\r\n\t\tline.set(\"segments\", segments);\r\n\t\thitLine.set(\"segments\", segments);\r\n\t}\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (!this._isDragging) {\r\n\t\t\tif (!this._isDrawing) {\r\n\t\t\t\tthis._isDrawing = true;\r\n\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._isDrawing = false;\r\n\t\t\t\tthis._index++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerClick(event);\r\n\t\tthis._handlePointerClickReal(event);\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerMove(event);\r\n\t\tthis._handlePointerMoveReal(event);\r\n\t}\r\n\r\n\r\n\tprotected _handlePointerMoveReal(_event: ISpritePointerEvent) {\r\n\t\tif (this._isDrawing) {\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (movePoint) {\r\n\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)));\r\n\r\n\t\t\t\tconst index = this._index;\r\n\t\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\t\t\tif (diP1 && diP2) {\r\n\t\t\t\t\tdiP2.set(\"valueX\", valueX);\r\n\t\t\t\t\tdiP2.set(\"valueY\", valueY);\r\n\t\t\t\t\tdiP2.set(\"valueYWorking\", valueY);\r\n\r\n\t\t\t\t\tthis._setXLocation(diP2, valueX);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._updateSegment(index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number): Line {\r\n\t\tconst chart = this.chart!;\r\n\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\t\tconst valueX = xAxis.positionToValue(xAxis.coordinateToPosition(point.x));\r\n\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)));\r\n\r\n\t\tthis._di[index] = {};\r\n\t\tconst line = this.makeLine();\r\n\t\tthis._lines[index] = line;\r\n\r\n\t\tconst hitLine = this.makeHitLine();\r\n\t\tthis._hitLines[index] = hitLine;\r\n\r\n\t\tline.setPrivate(\"visible\", this.get(\"showExtension\", true));\r\n\r\n\t\tconst stroke = this.get(\"strokeColor\", this.get(\"stroke\"));\r\n\t\tconst settings = { stroke: stroke, userData: index };\r\n\t\tline.setAll(settings);\r\n\t\thitLine.setAll(settings);\r\n\r\n\t\tthis.data.push({ stroke: this._getStrokeTemplate() });\r\n\t\tthis._addContextInfo(index, \"e\");\r\n\r\n\t\tthis._addPoint(valueX, valueY, \"p1\", index);\r\n\t\tthis._addPoint(valueX, valueY, \"p2\", index);\r\n\r\n\t\treturn line;\r\n\t}\r\n\r\n\tprotected _addPoint(valueX: number, valueY: number, corner: string, index: number) {\r\n\t\tthis.data.push({ valueY: valueY, valueX: valueX });\r\n\t\tconst len = this.dataItems.length;\r\n\t\tconst dataItem = this.dataItems[len - 1];\r\n\t\tif (dataItem) {\r\n\t\t\tthis._addContextInfo(index, corner);\r\n\t\t\tthis._di[index][corner] = dataItem;\r\n\r\n\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\r\n\t\t\tthis._setXLocation(dataItem, valueX);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst line = this._lines[index];\r\n\t\t\tif (line) {\r\n\t\t\t\tthis.lines.removeValue(line);\r\n\t\t\t\tdelete (this._lines[index]);\r\n\t\t\t\tline.dispose();\r\n\t\t\t}\r\n\t\t\tconst hitLine = this._hitLines[index];\r\n\t\t\tif (hitLine) {\r\n\t\t\t\tthis.hitLines.removeValue(hitLine);\r\n\t\t\t\tdelete (this._hitLines[index]);\r\n\t\t\t\thitLine.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateExtentionLine(line: Line) {\r\n\t\tlet strokeOpacity = this.get(\"strokeOpacity\");\r\n\t\tif (strokeOpacity != null) {\r\n\t\t\tline.set(\"strokeOpacity\", strokeOpacity);\r\n\t\t}\r\n\r\n\t\tlet strokeWidth = this.get(\"strokeWidth\");\r\n\t\tif (strokeWidth != null) {\r\n\t\t\tline.set(\"strokeWidth\", strokeWidth);\r\n\t\t}\r\n\r\n\t\tlet strokeDasharray = this.get(\"strokeDasharray\");\r\n\t\tif (strokeDasharray != null) {\r\n\t\t\tline.set(\"strokeDasharray\", strokeDasharray);\r\n\t\t}\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Line } from \"../../../core/render/Line\";\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IHorizontalLineSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n\r\n}\r\n\r\nexport interface IHorizontalLineSeriesSettings extends ISimpleLineSeriesSettings {\r\n\r\n}\r\n\r\nexport interface IHorizontalLineSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n\r\n}\r\n\r\nexport class HorizontalLineSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"HorizontalLineSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([HorizontalLineSeries.className]);\r\n\r\n\tdeclare public _settings: IHorizontalLineSeriesSettings;\r\n\tdeclare public _privateSettings: IHorizontalLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IHorizontalLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"horizontal\";\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tsuper._handleBulletDragged(event);\r\n\r\n\t\tconst dataItem = event.target.dataItem as DataItem<IHorizontalLineSeriesDataItem>;\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (diP1 && diP2 && movePoint) {\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)));\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\r\n\t\t\t\tdiP1.set(\"valueY\", valueY);\r\n\t\t\t\tdiP1.set(\"valueYWorking\", valueY);\r\n\r\n\t\t\t\tdiP2.set(\"valueY\", valueY);\r\n\t\t\t\tdiP2.set(\"valueYWorking\", valueY);\r\n\r\n\t\t\t\tdiP1.set(\"valueX\", valueX);\r\n\t\t\t\tdiP2.set(\"valueX\", valueX + 0.01);\r\n\r\n\t\t\t\tthis._setXLocation(diP1, valueX);\r\n\t\t\t\tthis._setXLocation(diP2, valueX + 0.01);\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMoveReal() {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (!this._isDragging) {\r\n\t\t\tthis._addPoints(event, this._index);\r\n\t\t\tthis._index++;\r\n\t\t\tthis._isDrawing = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number):Line {\r\n\t\tconst line = super._addPoints(event, index);\r\n\t\tthis._updateExtentionLine(line);\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\t\tdiP2.set(\"valueX\", diP2.get(\"valueX\", 0) + 0.001);\r\n\t\tthis._isDrawing = false;\r\n\t\treturn line;\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Line } from \"../../../core/render/Line\";\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IVerticalLineSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n\r\n}\r\n\r\nexport interface IVerticalLineSeriesSettings extends ISimpleLineSeriesSettings {\r\n\r\n}\r\n\r\nexport interface IVerticalLineSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n\r\n}\r\n\r\nexport class VerticalLineSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"VerticalLineSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([VerticalLineSeries.className]);\r\n\r\n\tdeclare public _settings: IVerticalLineSeriesSettings;\r\n\tdeclare public _privateSettings: IVerticalLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IVerticalLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"vertical\";\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tsuper._handleBulletDragged(event);\r\n\r\n\t\tconst dataItem = event.target.dataItem as DataItem<IVerticalLineSeriesDataItem>;\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (diP1 && diP2 && movePoint) {\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)));\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\r\n\t\t\t\tdiP1.set(\"valueY\", valueY);\r\n\t\t\t\tdiP1.set(\"valueYWorking\", valueY);\r\n\r\n\t\t\t\tdiP2.set(\"valueY\", valueY + 0.001);\r\n\t\t\t\tdiP2.set(\"valueYWorking\", valueY + 0.001);\r\n\r\n\t\t\t\tdiP1.set(\"valueX\", valueX);\r\n\t\t\t\tdiP2.set(\"valueX\", valueX);\r\n\r\n\t\t\t\tthis._setXLocation(diP1, valueX);\r\n\t\t\t\tthis._setXLocation(diP2, valueX);\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMoveReal() {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (!this._isDragging) {\r\n\t\t\tthis._addPoints(event, this._index);\r\n\t\t\tthis._index++;\r\n\t\t\tthis._isDrawing = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number):Line {\r\n\t\tlet line = super._addPoints(event, index);\r\n\t\tthis._updateExtentionLine(line);\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\t\tconst value = diP2.get(\"valueY\", 0) + 0.001;\r\n\t\tdiP2.set(\"valueY\", value);\r\n\t\tdiP2.set(\"valueYWorking\", value);\r\n\t\treturn line;\r\n\t}\r\n}","import { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\nimport * as $math from \"../../../core/util/Math\";\r\n\r\nexport interface IAverageSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n\r\n}\r\n\r\nexport interface IAverageSeriesSettings extends ISimpleLineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tfield: \"open\" | \"value\" | \"low\" | \"high\";\r\n}\r\n\r\nexport interface IAverageSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n\r\n}\r\n\r\nexport class AverageSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"AverageSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([AverageSeries.className]);\r\n\r\n\tdeclare public _settings: IAverageSeriesSettings;\r\n\tdeclare public _privateSettings: IAverageSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IAverageSeriesDataItem;\r\n\r\n\tprotected _tag = \"average\";\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\t\tif (series) {\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\tconst min = xAxis.getPrivate(\"min\", 0) + 1;\r\n\t\t\tconst max = xAxis.getPrivate(\"max\", 1) - 1;\r\n\r\n\t\t\tlet x1 = $math.fitToRange(diP1.get(\"valueX\" as any), min, max);\r\n\t\t\tlet x2 = $math.fitToRange(diP2.get(\"valueX\" as any), min, max);\r\n\r\n\t\t\tconst di1 = xAxis.getSeriesItem(series, Math.max(0, xAxis.valueToPosition(x1)));\r\n\t\t\tconst di2 = xAxis.getSeriesItem(series, Math.min(1, xAxis.valueToPosition(x2)));\r\n\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tif (di1 && di2) {\r\n\t\t\t\tlet i1 = series.dataItems.indexOf(di1);\r\n\t\t\t\tlet i2 = series.dataItems.indexOf(di2);\r\n\r\n\t\t\t\tif (i1 > i2) {\r\n\t\t\t\t\t[i1, i2] = [i2, i1];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet sum = 0;\r\n\t\t\t\tlet count = 0;\r\n\r\n\t\t\t\tfor (var i = i1; i <= i2; i++) {\r\n\t\t\t\t\tconst di = series.dataItems[i];\r\n\t\t\t\t\tconst value = di.get(field as any);\r\n\t\t\t\t\tif (value != null) {\r\n\t\t\t\t\t\tsum += value;\r\n\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst average = sum / count;\r\n\r\n\t\t\t\tdiP1.set(\"valueX\", x1);\r\n\t\t\t\tdiP2.set(\"valueX\", x2);\r\n\r\n\t\t\t\tdiP1.set(\"valueY\", average);\r\n\t\t\t\tdiP1.set(\"valueYWorking\", average);\r\n\r\n\t\t\t\tdiP2.set(\"valueY\", average);\r\n\t\t\t\tdiP2.set(\"valueYWorking\", average);\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// need to override so that location would not be set\r\n\tprotected _setXLocation() {\r\n\r\n\t}\r\n}","import type { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\nimport regression from \"regression\";\r\n\r\nexport interface IRegressionSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IRegressionSeriesSettings extends ISimpleLineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tfield: \"open\" | \"value\" | \"low\" | \"high\";\r\n}\r\n\r\nexport interface IRegressionSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class RegressionSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"RegressionSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([RegressionSeries.className]);\r\n\r\n\tdeclare public _settings: IRegressionSeriesSettings;\r\n\tdeclare public _privateSettings: IRegressionSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IRegressionSeriesDataItem;\r\n\r\n\tprotected _tag = \"regression\";\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\t\tif (series) {\r\n\t\t\tconst xAxis = series.get(\"xAxis\") as ValueAxis<AxisRenderer>;\r\n\r\n\t\t\tlet x1 = this._getXValue(diP1.get(\"valueX\" as any));\r\n\t\t\tlet x2 = this._getXValue(diP2.get(\"valueX\" as any));\r\n\r\n\t\t\tconst di1 = xAxis.getSeriesItem(series, xAxis.valueToPosition(x1));\r\n\t\t\tconst di2 = xAxis.getSeriesItem(series, xAxis.valueToPosition(x2));\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tif (di1 && di2) {\r\n\t\t\t\tconst dataItems = series.dataItems;\r\n\r\n\t\t\t\tlet startIndex = dataItems.indexOf(di1);\r\n\t\t\t\tlet endIndex = dataItems.indexOf(di2);\r\n\r\n\t\t\t\tlet inversed = false;\r\n\t\t\t\tif (startIndex > endIndex) {\r\n\t\t\t\t\tinversed = true;\r\n\t\t\t\t\t[startIndex, endIndex] = [endIndex, startIndex];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst points: Array<Array<number>> = []\r\n\t\t\t\tlet ii = 0;\r\n\t\t\t\tfor (let i = startIndex; i <= endIndex; i++) {\r\n\t\t\t\t\tconst dataItem = dataItems[i];\r\n\t\t\t\t\tpoints.push([ii, dataItem.get(field as any) as any]);\r\n\t\t\t\t\tii++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst result = regression.linear(points as any);\r\n\t\t\t\tconst resultPoints = result.points;\r\n\t\t\t\tconst len = resultPoints.length;\r\n\r\n\t\t\t\tif (len > 1) {\r\n\t\t\t\t\tconst p1 = resultPoints[0];\r\n\t\t\t\t\tconst p2 = resultPoints[resultPoints.length - 1];\r\n\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\tlet y1 = p1[1];\r\n\t\t\t\t\t\tlet y2 = p2[1];\r\n\r\n\t\t\t\t\t\tif (inversed) {\r\n\t\t\t\t\t\t\t[y1, y2] = [y2, y1];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdiP1.set(\"valueY\", y1);\r\n\t\t\t\t\t\tdiP1.set(\"valueYWorking\", y1);\r\n\r\n\t\t\t\t\t\tdiP2.set(\"valueY\", y2);\r\n\t\t\t\t\t\tdiP2.set(\"valueYWorking\", y2);\r\n\r\n\t\t\t\t\t\tdiP1.set(\"valueX\", x1);\r\n\t\t\t\t\t\tdiP2.set(\"valueX\", x2);\r\n\r\n\t\t\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// need to override so that location would not be set\r\n\tprotected _setXLocation() {\r\n\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\n\r\nexport interface IDoodleSeriesDataItem extends IDrawingSeriesDataItem {\r\n}\r\n\r\nexport interface IDoodleSeriesSettings extends IDrawingSeriesSettings {\r\n\r\n}\r\n\r\nexport interface IDoodleSeriesPrivate extends IDrawingSeriesPrivate {\r\n}\r\n\r\nexport class DoodleSeries extends DrawingSeries {\r\n\tpublic static className: string = \"DoodleSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([DoodleSeries.className]);\r\n\r\n\tdeclare public _settings: IDoodleSeriesSettings;\r\n\tdeclare public _privateSettings: IDoodleSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IDoodleSeriesDataItem;\r\n\r\n\tprotected _panX?: boolean;\r\n\tprotected _panY?: boolean;\r\n\r\n\t// point index in segment\r\n\tprotected _pIndex: number = 0;\r\n\r\n\tprotected _tag = \"doodle\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.addTag(\"doodle\");\r\n\t\tthis.bullets.clear();\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerMove(event);\r\n\r\n\t\tif (this._drawingEnabled && this._isPointerDown) {\r\n\t\t\tthis._handleBulletPosition(event);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletPosition(event: ISpritePointerEvent) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\r\n\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(point.x)));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)));\r\n\r\n\t\t\tthis.data.push({ valueY: valueY, valueX: valueX });\r\n\t\t\tconst len = this.dataItems.length;\r\n\r\n\t\t\tconst dataItem = this.dataItems[len - 1];\r\n\t\t\tconst index = this._index;\r\n\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tthis._setXLocation(dataItem, valueX);\r\n\t\t\t\tthis._addContextInfo(index);\r\n\t\t\t}\r\n\t\t\tlet segmentItems = this._di[index];\r\n\t\t\tif (!segmentItems) {\r\n\t\t\t\tsegmentItems = {};\r\n\t\t\t}\r\n\t\t\tsegmentItems[this._pIndex] = dataItem;\r\n\t\t\tthis._di[index] = segmentItems;\r\n\t\t\tthis._pIndex++;\r\n\r\n\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleFillDragStart(e: ISpritePointerEvent, index: number) {\r\n\t\tif (!this._drawingEnabled) {\r\n\t\t\tsuper._handleFillDragStart(e, index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerDown(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerDown(event);\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tthis._pIndex = 0;\r\n\r\n\t\t\tthis._panX = chart.get(\"panX\");\r\n\t\t\tthis._panY = chart.get(\"panY\");\r\n\r\n\t\t\tchart.set(\"panX\", false);\r\n\t\t\tchart.set(\"panY\", false);\r\n\r\n\t\t\tconst cursor = chart.get(\"cursor\");\r\n\t\t\tif (cursor) {\r\n\t\t\t\tcursor.setPrivate(\"visible\", false);\r\n\t\t\t}\r\n\r\n\t\t\tthis.data.push({ stroke: this._getStrokeTemplate() });\r\n\t\t\tthis._addContextInfo(this._index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerUp(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerUp(event);\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tthis.setTimeout(() => {\r\n\t\t\t\tchart.set(\"panX\", this._panX);\r\n\t\t\t\tchart.set(\"panY\", this._panY);\r\n\t\t\t\tconst cursor = chart.get(\"cursor\");\r\n\t\t\t\tif (cursor) {\r\n\t\t\t\t\tcursor.setPrivate(\"visible\", true);\r\n\t\t\t\t}\r\n\t\t\t}, 100)\r\n\r\n\t\t\tthis._index++;\r\n\t\t}\r\n\t}\r\n}","import type { Sprite } from \"../../../core/render/Sprite\";\r\nimport type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { IDisposer } from \"../../../core/util/Disposer\";\r\n\r\nimport { Container, IContainerPrivate, IContainerSettings, IContainerEvents } from \"../../../core/render/Container\";\r\nimport { p50, Percent } from \"../../../core/util/Percent\";\r\nimport { RoundedRectangle } from \"../../../core/render/RoundedRectangle\";\r\nimport { Rectangle } from \"../../../core/render/Rectangle\";\r\nimport { color } from \"../../../core/util/Color\";\r\n\r\nimport * as $math from \"../../../core/util/Math\";\r\n\r\nexport interface ISpriteResizerSettings extends IContainerSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tsprite?: Sprite\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\trotationStep?: number;\r\n}\r\n\r\nexport interface ISpriteResizerPrivate extends IContainerPrivate {\r\n\r\n}\r\n\r\nexport interface ISpriteResizerEvents extends IContainerEvents {\r\n\r\n}\r\n\r\nexport class SpriteResizer extends Container {\r\n\r\n\tdeclare public _settings: ISpriteResizerSettings;\r\n\tdeclare public _privateSettings: ISpriteResizerPrivate;\r\n\tdeclare public _events: ISpriteResizerEvents;\r\n\r\n\tpublic static className: string = \"SpriteResizer\";\r\n\tpublic static classNames: Array<string> = Container.classNames.concat([SpriteResizer.className]);\r\n\r\n\tpublic readonly rectangle: Rectangle = this.children.push(Rectangle.new(this._root, { themeTags: [\"rectangle\"], fillOpacity: 0, fill: color(0xFFFFFF) }));\r\n\tpublic readonly gripL: Container = this._createGrip(\"left\");\r\n\tpublic readonly gripR: Container = this._createGrip(\"right\");\r\n\tpublic readonly gripT: Container = this._createGrip(\"top\");\r\n\tpublic readonly gripB: Container = this._createGrip(\"bottom\");\r\n\r\n\tprotected _is: number = 1;\r\n\tprotected _ix: number = 0;\r\n\tprotected _iw: number = 0;\r\n\r\n\tprotected _positionDP?: IDisposer;\r\n\r\n\tprotected _isHover: boolean = false;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.addTag(\"resizer\");\r\n\t\tthis.set(\"visible\", false);\r\n\r\n\t\tthis.gripL.events.on(\"dragged\", (e) => {\r\n\t\t\tthis._resize(e.target, -1);\r\n\t\t})\r\n\r\n\t\tthis.gripR.events.on(\"dragged\", (e) => {\r\n\t\t\tthis._resize(e.target, 1);\r\n\t\t})\r\n\r\n\t\tthis.gripL.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._resizeStart(e.target);\r\n\t\t})\r\n\r\n\t\tthis.gripR.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._resizeStart(e.target);\r\n\t\t})\r\n\r\n\t\tthis.gripT.events.on(\"dragged\", (e) => {\r\n\t\t\tthis._rotate(e, 90);\r\n\t\t})\r\n\r\n\t\tthis.gripB.events.on(\"dragged\", (e) => {\r\n\t\t\tthis._rotate(e, -90);\r\n\t\t})\r\n\r\n\t\tthis.gripT.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._resizeStart(e.target);\r\n\t\t})\r\n\r\n\t\tthis.gripB.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._resizeStart(e.target);\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _resizeStart(grip: Sprite) {\r\n\t\tconst sprite = this.get(\"sprite\");\r\n\t\tif (sprite) {\r\n\t\t\tthis._is = sprite.get(\"scale\", 1);\r\n\t\t\tthis._ix = grip.x();\r\n\t\t\tthis._iw = this.width() / 2;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _resize(grip: Sprite, c: number) {\r\n\t\tconst sprite = this.get(\"sprite\");\r\n\t\tif (sprite) {\r\n\r\n\t\t\tsprite.set(\"scale\", Math.max(0.01, this._is * (1 + c * (grip.x() - this._ix) / this._iw)));\r\n\t\t\tthis._updatePositions();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _rotate(e: ISpritePointerEvent, delta: number) {\r\n\t\tconst sprite = this.get(\"sprite\");\r\n\t\tif (sprite) {\r\n\t\t\tconst parent = this.parent;\r\n\t\t\tif (parent) {\r\n\r\n\t\t\t\tconst rotationStep = this.get(\"rotationStep\", 10);\r\n\t\t\t\tlet angle = Math.round((($math.getAngle({ x: this.x(), y: this.y() }, parent.toLocal(e.point)) + delta) / rotationStep)) * rotationStep;\r\n\t\t\t\tsprite.set(\"rotation\", angle);\r\n\t\t\t\tthis._updatePositions();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _createGrip(themeTag: string) {\r\n\t\tconst container = this.children.push(Container.new(this._root, {\r\n\t\t\tthemeTags: [\"grip\", themeTag],\r\n\t\t\tsetStateOnChildren: true,\r\n\t\t\tdraggable: true\r\n\t\t}))\r\n\r\n\t\tcontainer.children.push(RoundedRectangle.new(this._root, {\r\n\t\t\tthemeTags: [\"outline\"],\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50\r\n\t\t}))\r\n\r\n\t\tcontainer.children.push(RoundedRectangle.new(this._root, {\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50\r\n\t\t}));\r\n\t\treturn container;\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"sprite\")) {\r\n\t\t\tconst sprite = this.get(\"sprite\");\r\n\t\t\tif (sprite) {\r\n\t\t\t\tthis.show(0);\r\n\r\n\t\t\t\tthis._updatePositions();\r\n\r\n\t\t\t\tconst parent = sprite.parent;\r\n\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\tparent.children.moveValue(this, 0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._positionDP = sprite.events.on(\"positionchanged\", () => {\r\n\t\t\t\t\tthis._updatePositions();\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.hide(0);\r\n\r\n\t\t\t\tif (this._positionDP) {\r\n\t\t\t\t\tthis._positionDP.dispose();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"width\") || this.isDirty(\"height\") || this.isDirty(\"rotation\")) {\r\n\t\t\tthis._updatePositions();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updatePositions() {\r\n\t\tconst sprite = this.get(\"sprite\");\r\n\t\tif (sprite) {\r\n\t\t\tlet bounds = sprite.localBounds();\r\n\t\t\tlet scale = sprite.get(\"scale\", 1);\r\n\t\t\tlet d = 20\r\n\t\t\tlet w = (bounds.right - bounds.left) * scale + d;\r\n\t\t\tlet h = (bounds.bottom - bounds.top) * scale + d;\r\n\t\t\tlet a = sprite.get(\"rotation\", 0);\r\n\r\n\t\t\tconst rectangle = this.rectangle;\r\n\r\n\t\t\tlet cx = sprite.get(\"centerX\");\r\n\t\t\tlet cy = sprite.get(\"centerY\");\r\n\r\n\t\t\tlet cxr = 0;\r\n\t\t\tif (cx instanceof Percent) {\r\n\t\t\t\tcxr = cx.value;\r\n\t\t\t}\r\n\r\n\t\t\tlet cyr = 0;\r\n\t\t\tif (cy instanceof Percent) {\r\n\t\t\t\tcyr = cy.value;\r\n\t\t\t}\r\n\r\n\t\t\trectangle.setAll({ centerX: cx, centerY: cy, width: w, height: h });\r\n\t\t\tthis.setAll({ x: sprite.x() + d * (cxr - 0.5) * $math.cos(a) - d * (cyr - 0.5) * $math.sin(a), y: sprite.y() + d * (cyr - 0.5) * $math.cos(a) + d * (cxr - 0.5) * $math.sin(a), width: w, height: h, rotation: a });\r\n\r\n\t\t\tthis.gripT.setAll({ x: (0.5 - cxr) * w, y: -cyr * h });\r\n\t\t\tthis.gripB.setAll({ x: (0.5 - cxr) * w, y: (1 - cyr) * h });\r\n\t\t\tthis.gripL.setAll({ x: -cxr * w, y: (0.5 - cyr) * h });\r\n\t\t\tthis.gripR.setAll({ x: (1 - cxr) * w, y: (0.5 - cyr) * h });\r\n\r\n\t\t\tthis.rectangle.setAll({ width: w, height: h });\r\n\t\t}\r\n\t}\r\n}\r\n","import type { Percent } from \"../../../core/util/Percent\";\r\nimport type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { PolylineSeries, IPolylineSeriesSettings, IPolylineSeriesPrivate, IPolylineSeriesDataItem } from \"./PolylineSeries\";\r\nimport { Bullet } from \"../../../core/render/Bullet\";\r\nimport { Graphics } from \"../../../core/render/Graphics\";\r\nimport { SpriteResizer } from \"./SpriteResizer\";\r\n\r\nexport interface IIconSeriesDataItem extends IPolylineSeriesDataItem {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tsvgPath: string;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tsnapToData?: boolean;\r\n}\r\n\r\nexport interface IIconSeriesSettings extends IPolylineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\ticonSvgPath: string;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\ticonScale?: number;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\ticonCenterX?: Percent;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\ticonCenterY?: Percent;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tsnapToData?: boolean;\r\n}\r\n\r\nexport interface IIconSeriesPrivate extends IPolylineSeriesPrivate {\r\n}\r\n\r\nexport class IconSeries extends PolylineSeries {\r\n\tpublic static className: string = \"IconSeries\";\r\n\tpublic static classNames: Array<string> = PolylineSeries.classNames.concat([IconSeries.className]);\r\n\r\n\tdeclare public _settings: IIconSeriesSettings;\r\n\tdeclare public _privateSettings: IIconSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IIconSeriesDataItem;\r\n\r\n\tpublic spriteResizer = this.children.push(SpriteResizer.new(this._root, {}));\r\n\r\n\tprotected _tag = \"icon\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.bullets.clear();\r\n\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t\tthis.fills.template.set(\"visible\", false);\r\n\r\n\t\tthis.bullets.push(() => {\r\n\t\t\tconst color = this.get(\"fillColor\", this.get(\"fill\"));\r\n\t\t\tconst strokeColor = this.get(\"strokeColor\", this.get(\"stroke\"));\r\n\r\n\t\t\tconst sprite = Graphics.new(this._root, {\r\n\t\t\t\tdraggable: true,\r\n\t\t\t\tsvgPath: this.get(\"iconSvgPath\"),\r\n\t\t\t\tscale: this.get(\"iconScale\", 1),\r\n\t\t\t\tthemeTags: [\"icon\"],\r\n\t\t\t\tfill: color,\r\n\t\t\t\tstroke: strokeColor,\r\n\t\t\t\tfillOpacity: this.get(\"fillOpacity\", 1),\r\n\t\t\t\tstrokeOpacity: this.get(\"strokeOpacity\", 1)\r\n\t\t\t});\r\n\r\n\t\t\tconst iconCenterX = this.get(\"iconCenterX\");\r\n\t\t\tif (iconCenterX != null) {\r\n\t\t\t\tsprite.set(\"centerX\", iconCenterX)\r\n\t\t\t}\r\n\r\n\t\t\tconst iconCenterY = this.get(\"iconCenterY\");\r\n\t\t\tif (iconCenterY != null) {\r\n\t\t\t\tsprite.set(\"centerY\", iconCenterY)\r\n\t\t\t}\r\n\r\n\t\t\tthis._addBulletInteraction(sprite);\r\n\r\n\t\t\tsprite.events.on(\"click\", () => {\r\n\t\t\t\tthis.spriteResizer.set(\"sprite\", sprite);\r\n\t\t\t})\r\n\r\n\t\t\tsprite.events.on(\"pointerover\", () => {\r\n\t\t\t\tthis._isHover = true;\r\n\t\t\t})\r\n\r\n\t\t\tsprite.events.on(\"pointerout\", () => {\r\n\t\t\t\tthis._isHover = false;\r\n\t\t\t})\r\n\r\n\t\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\r\n\t\t\treturn Bullet.new(this._root, {\r\n\t\t\t\tlocationX: undefined,\r\n\t\t\t\tsprite: sprite\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (!this._isHover) {\r\n\t\t\tsuper._handlePointerClick(event);\r\n\t\t\tthis._index++;\r\n\t\t\tthis._di[this._index] = {};\r\n\t\t}\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\t\tthis._isHover = false;\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\r\n\t}\r\n\r\n\tprotected _setXLocation(dataItem: DataItem<this[\"_dataItemSettings\"]>, value: number) {\r\n\t\tif(!this.get(\"snapToData\")){\r\n\t\t\tthis._setXLocationReal(dataItem, value);\r\n\t\t}\t\t\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { Container } from \"../../../core/render/Container\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { PolylineSeries, IPolylineSeriesSettings, IPolylineSeriesPrivate, IPolylineSeriesDataItem } from \"./PolylineSeries\";\r\nimport { Label } from \"../../../core/render/Label\";\r\nimport { RoundedRectangle } from \"../../../core/render/RoundedRectangle\";\r\nimport { SpriteResizer } from \"./SpriteResizer\";\r\nimport { color, Color } from \"../../../core/util/Color\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface ILabelSeriesDataItem extends IPolylineSeriesDataItem {\r\n}\r\n\r\nexport interface ILabelSeriesSettings extends IPolylineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tlabelFontSize?: number | string | undefined;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tlabelFontFamily?: string;\r\n\r\n\t/**\r\n\t * Font weight.\r\n\t */\r\n\tlabelFontWeight?: \"normal\" | \"bold\" | \"bolder\" | \"lighter\" | \"100\" | \"200\" | \"300\" | \"400\" | \"500\" | \"600\" | \"700\" | \"800\" | \"900\";\r\n\r\n\t/**\r\n\t * Font style.\r\n\t */\r\n\tlabelFontStyle?: \"normal\" | \"italic\" | \"oblique\";\r\n\t/**\r\n\t * @todo review\r\n\t */\r\n\tlabelFill?: Color;\r\n}\r\n\r\nexport interface ILabelSeriesPrivate extends IPolylineSeriesPrivate {\r\n\tinputContainer: HTMLDivElement;\r\n\tinput: HTMLTextAreaElement;\r\n\tlabel: Label;\r\n}\r\n\r\nexport class LabelSeries extends PolylineSeries {\r\n\tpublic static className: string = \"LabelSeries\";\r\n\tpublic static classNames: Array<string> = PolylineSeries.classNames.concat([LabelSeries.className]);\r\n\r\n\tdeclare public _settings: ILabelSeriesSettings;\r\n\tdeclare public _privateSettings: ILabelSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ILabelSeriesDataItem;\r\n\r\n\tpublic spriteResizer = this.children.push(SpriteResizer.new(this._root, {}));\r\n\r\n\tprotected _clickEvent?: ISpritePointerEvent;\r\n\r\n\tprotected _tag = \"label\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t\tthis.fills.template.set(\"visible\", false);\r\n\r\n\t\tthis.addTag(this._tag);\r\n\r\n\t\tconst div = document.createElement(\"div\");\r\n\t\t//div.style.width = \"300px\";\r\n\t\tdiv.style.position = \"absolute\";\r\n\t\tdiv.style.display = \"none\";\r\n\t\tdiv.className = \"am5stock-drawing-label-wrapper\";\r\n\t\tthis._root._inner.appendChild(div);\r\n\t\tthis.setPrivate(\"inputContainer\", div);\r\n\r\n\t\tconst textArea = document.createElement(\"textarea\");;\r\n\t\t//textArea.style.textAlign = \"center\";\r\n\t\t//textArea.rows = 2;\r\n\t\ttextArea.className = \"am5stock-drawing-label-input\";\r\n\t\t$utils.addEventListener(textArea, \"input\", () => {\r\n\t\t\ttextArea.style.height = \"auto\";\r\n\t\t\ttextArea.style.height = textArea.scrollHeight + \"px\";\r\n\t\t}, false);\r\n\r\n\t\t\r\n\t\tdiv.appendChild(textArea);\r\n\t\tdiv.appendChild(document.createElement(\"br\"));\r\n\t\tthis.setPrivate(\"input\", textArea);\r\n\r\n\t\tconst saveButton = document.createElement(\"input\");\r\n\t\tsaveButton.type = \"button\";\r\n\t\tsaveButton.value = this._root.language.translateAny(\"Save\");\r\n\t\tsaveButton.className = \"am5-modal-button am5-modal-primary\";\r\n\t\t$utils.addEventListener(saveButton, \"click\", () => {\r\n\t\t\tthis.saveText();\r\n\t\t});\r\n\r\n\t\tdiv.appendChild(saveButton);\r\n\r\n\t\tconst cancelButton = document.createElement(\"input\");\r\n\t\tcancelButton.type = \"button\";\r\n\t\tcancelButton.value = this._root.language.translateAny(\"Cancel\");\r\n\t\tcancelButton.className = \"am5-modal-button am5-modal-scondary\";\r\n\t\t$utils.addEventListener(cancelButton, \"click\", () => {\r\n\t\t\tthis.getPrivate(\"inputContainer\").style.display = \"none\";\r\n\t\t\tthis.getPrivate(\"input\").value = \"\";\r\n\t\t});\r\n\t\tdiv.appendChild(cancelButton);\r\n\t}\r\n\r\n\tprotected _tweakBullet(container: Container) {\r\n\t\tconst label = container.children.push(Label.new(this._root, {\r\n\t\t\tthemeTags: [\"label\"],\r\n\t\t\ttext: this.getPrivate(\"input\").value\r\n\t\t}));\r\n\r\n\t\tthis.setPrivate(\"label\", label);\r\n\r\n\t\tconst fontSize = this.get(\"labelFontSize\");\r\n\t\tif (fontSize != null) {\r\n\t\t\tlabel.set(\"fontSize\", fontSize)\r\n\t\t}\r\n\r\n\t\tconst fontFamily = this.get(\"labelFontFamily\");\r\n\t\tif (fontFamily != null) {\r\n\t\t\tlabel.set(\"fontFamily\", fontFamily)\r\n\t\t}\r\n\r\n\t\tconst fontStyle = this.get(\"labelFontStyle\");\r\n\t\tif (fontStyle != null) {\r\n\t\t\tlabel.set(\"fontStyle\", fontStyle)\r\n\t\t}\r\n\r\n\t\tconst fontWeight = this.get(\"labelFontWeight\");\r\n\t\tif (fontWeight != null) {\r\n\t\t\tlabel.set(\"fontWeight\", fontWeight)\r\n\t\t}\r\n\r\n\t\tcontainer.events.on(\"click\", () => {\r\n\t\t\tthis.spriteResizer.set(\"sprite\", label);\r\n\t\t})\r\n\r\n\t\tcontainer.events.on(\"pointerover\", () => {\r\n\t\t\tthis._isHover = true;\r\n\t\t})\r\n\r\n\t\tcontainer.events.on(\"pointerout\", () => {\r\n\t\t\tthis._isHover = false;\r\n\t\t})\r\n\r\n\t\tthis._tweakBullet2(label);\r\n\t}\r\n\r\n\tprotected _tweakBullet2(label: Label) {\r\n\t\tlabel.set(\"background\", RoundedRectangle.new(this._root, { fillOpacity: 0, strokeOpacity: 0, fill: color(0xffffff) }))\r\n\t\tlabel.set(\"fill\", this.get(\"labelFill\", this.get(\"fillColor\", this.get(\"fill\"))));\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (!this._isHover) {\r\n\t\t\tconst input = this.getPrivate(\"input\");\r\n\t\t\tinput.value = \"\";\r\n\r\n\t\t\tthis._clickEvent = event;\r\n\t\t\t//console.log(event);\r\n\t\t\tconst inputDiv = this.getPrivate(\"inputContainer\");\r\n\t\t\tinputDiv.style.display = \"block\";\r\n\t\t\tinputDiv.style.left = (event.point.x) + \"px\";\r\n\t\t\tinputDiv.style.top = (event.point.y) + \"px\";\r\n\t\t\tinput.focus();\r\n\t\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\t\t\tthis._index++;\r\n\t\t\tthis._di[this._index] = {};\r\n\t\t}\r\n\t}\r\n\r\n\tpublic saveText() {\r\n\t\tconst clickEvent = this._clickEvent;\r\n\t\tif (clickEvent) {\r\n\t\t\tif (this.getPrivate(\"input\").value) {\r\n\t\t\t\tsuper._handlePointerClick(clickEvent);\r\n\t\t\t}\r\n\t\t\tthis.getPrivate(\"inputContainer\").style.display = \"none\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\t\tthis._isHover = false;\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\r\n\t}\r\n}","import type { Label } from \"../../../core/render/Label\";\r\nimport type { Container } from \"../../../core/render/Container\";\r\n\r\nimport { LabelSeries, ILabelSeriesSettings, ILabelSeriesPrivate, ILabelSeriesDataItem } from \"./LabelSeries\";\r\nimport { PointedRectangle } from \"../../../core/render/PointedRectangle\";\r\nimport { Color, color } from \"../../../core/util/Color\";\r\n\r\nimport * as $ease from \"../../../core/util/Ease\";\r\n\r\nexport interface ICalloutSeriesDataItem extends ILabelSeriesDataItem {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tsnapToData?: boolean;\r\n}\r\n\r\nexport interface ICalloutSeriesSettings extends ILabelSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tsnapToData?: boolean;\r\n}\r\n\r\nexport interface ICalloutSeriesPrivate extends ILabelSeriesPrivate {\r\n}\r\n\r\nexport class CalloutSeries extends LabelSeries {\r\n\tpublic static className: string = \"CalloutSeries\";\r\n\tpublic static classNames: Array<string> = LabelSeries.classNames.concat([CalloutSeries.className]);\r\n\r\n\tdeclare public _settings: ICalloutSeriesSettings;\r\n\tdeclare public _privateSettings: ICalloutSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ICalloutSeriesDataItem;\r\n\r\n\tprotected _tag = \"callout\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t}\r\n\r\n\tprotected _tweakBullet2(label: Label) {\r\n\t\tconst bgColor = this.get(\"fillColor\", this.get(\"fill\", color(0x000000)));\r\n\t\tlabel.set(\"background\", PointedRectangle.new(this._root, { themeTags: [\"callout\"], strokeOpacity: 0, fill: bgColor }));\r\n\t\tlabel.set(\"fill\", this.get(\"labelFill\", Color.alternative(bgColor, this._root.interfaceColors.get(\"alternativeText\"), this._root.interfaceColors.get(\"text\"))));\r\n\t}\r\n\r\n\tprotected _tweakBullet(container: Container) {\r\n\t\tsuper._tweakBullet(container);\r\n\r\n\t\tconst label = this.getPrivate(\"label\");\r\n\t\tif (label) {\r\n\t\t\tlabel.events.on(\"positionchanged\", () => {\r\n\t\t\t\tthis._updatePointer(label);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.events.on(\"click\", () => {\r\n\t\t\t\tthis.spriteResizer.set(\"sprite\", label);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.on(\"scale\", () => {\r\n\t\t\t\tthis._updatePointer(label);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.on(\"rotation\", () => {\r\n\t\t\t\tthis._updatePointer(label);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.setAll({ draggable: true });\r\n\r\n\t\t\tconst defaultState = label.states.lookup(\"default\")!;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tlabel.animate({ key: \"y\", to: -label.height() / 2 - 10, from: 0, duration: defaultState.get(\"stateAnimationDuration\", 500), easing: defaultState.get(\"stateAnimationEasing\", $ease.out($ease.cubic)) })\r\n\t\t\t}, 50)\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updatePointer(label: Label) {\r\n\t\tconst background = label.get(\"background\");\r\n\t\tif (background instanceof PointedRectangle) {\r\n\t\t\tconst parent = label.parent;\r\n\t\t\tif (parent) {\r\n\t\t\t\tlet point = parent.toGlobal({ x: 0, y: 0 });\r\n\t\t\t\tpoint = background.toLocal(point);\r\n\t\t\t\tbackground.setAll({ pointerX: point.x, pointerY: point.y });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\nimport { Ellipse } from \"../../../core/render/Ellipse\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IEllipseSeriesDataItem extends IDrawingSeriesDataItem {\r\n}\r\n\r\nexport interface IEllipseSeriesSettings extends IDrawingSeriesSettings {\r\n\r\n}\r\n\r\nexport interface IEllipseSeriesPrivate extends IDrawingSeriesPrivate {\r\n}\r\n\r\nexport class EllipseSeries extends DrawingSeries {\r\n\tpublic static className: string = \"EllipseSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([EllipseSeries.className]);\r\n\r\n\tdeclare public _settings: IEllipseSeriesSettings;\r\n\tdeclare public _privateSettings: IEllipseSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IEllipseSeriesDataItem;\r\n\r\n\tprotected _ellipses: Array<Ellipse> = [];\r\n\r\n\tprotected _tag = \"ellipse\";\r\n\tprotected _clickPX: number = 0;\r\n\tprotected _clickVY: number = 0;\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeEllipse(): Ellipse {\r\n\t\tconst ellipse = this.ellipses.make();\r\n\t\tthis.mainContainer.children.push(ellipse);\r\n\t\tthis.ellipses.push(ellipse);\r\n\t\treturn ellipse;\r\n\t}\r\n\r\n\tpublic readonly ellipses: ListTemplate<Ellipse> = new ListTemplate(\r\n\t\tTemplate.new({ radiusX: 0, radiusY: 0 }),\r\n\t\t() => Ellipse._new(this._root, { radiusX: 0, radiusY: 0 }, [this.ellipses.template])\r\n\t);\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t\tthis.fills.template.set(\"visible\", false);\r\n\r\n\t\tconst ellipseTemplate = this.ellipses.template;\r\n\t\tellipseTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tthis._showSegmentBullets(e.target.get(\"userData\"));\r\n\t\t})\r\n\r\n\t\tellipseTemplate.events.on(\"pointerout\", () => {\r\n\t\t\tthis._hideAllBullets();\r\n\t\t})\r\n\r\n\t\tellipseTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._handleFillDragStart(e, e.target.get(\"userData\"));\r\n\t\t})\r\n\t\tellipseTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tthis._handleFillDragStop(e, e.target.get(\"userData\"));\r\n\t\t})\r\n\t\tellipseTemplate.events.on(\"click\", (e) => {\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tthis._disposeIndex(e.target.get(\"userData\"));\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _handleFillDragStop(event: ISpritePointerEvent, index: number) {\r\n\t\tsuper._handleFillDragStop(event, index);\r\n\r\n\t\tconst items = this._di[index];\r\n\t\tconst bDI = items[\"b\"];\r\n\t\tconst tDI = items[\"t\"];\r\n\t\tconst rDI = items[\"r\"];\r\n\t\tconst lDI = items[\"l\"];\r\n\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\tif (bDI && tDI && rDI && lDI) {\r\n\t\t\tconst positionL = xAxis.valueToPosition(lDI.get(\"valueX\", 0));\r\n\t\t\tconst positionR = xAxis.valueToPosition(rDI.get(\"valueX\", 0));\r\n\r\n\t\t\tlet mx = this._getXValue(xAxis.positionToValue(positionL + (positionR - positionL) / 2));\r\n\t\t\ttDI.set(\"valueX\", mx);\r\n\t\t\tbDI.set(\"valueX\", mx);\r\n\t\t\tthis._setXLocation(tDI, mx);\r\n\t\t\tthis._setXLocation(bDI, mx);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tconst dataItem = event.target.dataItem as DataItem<IEllipseSeriesDataItem>;\r\n\r\n\t\tconst valueXReal = dataItem.get(\"valueX\");\r\n\t\tconst locationXReal = dataItem.get(\"locationX\");\r\n\t\tconst valueYReal = dataItem.get(\"valueY\");\r\n\r\n\t\tsuper._handleBulletDragged(event);\r\n\r\n\t\tconst movePoint = this._movePointerPoint;\r\n\t\tif (dataItem && movePoint) {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst corner = dataContext.corner;\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)));\r\n\r\n\t\t\tconst vx = \"valueX\"\r\n\t\t\tconst vy = \"valueY\"\r\n\t\t\tconst vwy = \"valueYWorking\";\r\n\r\n\t\t\tconst items = this._di[index];\r\n\t\t\tconst bDI = items[\"b\"];\r\n\t\t\tconst tDI = items[\"t\"];\r\n\t\t\tconst rDI = items[\"r\"];\r\n\t\t\tconst lDI = items[\"l\"];\r\n\r\n\r\n\t\t\tif (bDI && tDI && rDI && lDI) {\r\n\t\t\t\tif (corner == \"b\") {\r\n\t\t\t\t\tconst valueY0 = tDI.get(vwy, 0)\r\n\r\n\t\t\t\t\tbDI.set(vy, valueY);\r\n\t\t\t\t\tbDI.set(vwy, valueY);\r\n\r\n\t\t\t\t\tlet my = valueY0 + (valueY - valueY0) / 2;\r\n\t\t\t\t\trDI.set(vy, my);\r\n\t\t\t\t\trDI.set(vwy, my);\r\n\r\n\t\t\t\t\tlDI.set(vy, my);\r\n\t\t\t\t\tlDI.set(vwy, my);\r\n\r\n\t\t\t\t\tbDI.set(vx, valueXReal)\r\n\t\t\t\t\tbDI.set(\"locationX\", locationXReal);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (corner == \"t\") {\r\n\t\t\t\t\tconst valueY0 = bDI.get(vwy, 0)\r\n\r\n\t\t\t\t\ttDI.set(vy, valueY);\r\n\t\t\t\t\ttDI.set(vwy, valueY);\r\n\r\n\t\t\t\t\tlet my = valueY0 + (valueY - valueY0) / 2;\r\n\t\t\t\t\trDI.set(vy, my);\r\n\t\t\t\t\trDI.set(vwy, my);\r\n\r\n\t\t\t\t\tlDI.set(vy, my);\r\n\t\t\t\t\tlDI.set(vwy, my);\r\n\r\n\t\t\t\t\ttDI.set(vx, valueXReal)\r\n\t\t\t\t\ttDI.set(\"locationX\", locationXReal);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (corner == \"l\") {\r\n\t\t\t\t\tconst valueX0 = rDI.get(vx, 0)\r\n\t\t\t\t\tconst positionX0 = xAxis.valueToPosition(valueX0);\r\n\t\t\t\t\tconst positionX = xAxis.valueToPosition(valueX);\r\n\r\n\t\t\t\t\tlDI.set(vx, valueX);\r\n\t\t\t\t\tthis._setXLocation(lDI, valueX);\r\n\r\n\t\t\t\t\tlet mpos = positionX0 + (positionX - positionX0) / 2;\r\n\t\t\t\t\tlet mx = this._getXValue(xAxis.positionToValue(mpos));\r\n\t\t\t\t\ttDI.set(vx, mx);\r\n\t\t\t\t\tbDI.set(vx, mx);\r\n\t\t\t\t\tthis._setXLocation(tDI, mx);\r\n\t\t\t\t\tthis._setXLocation(bDI, mx);\r\n\r\n\t\t\t\t\tlDI.set(vwy, valueYReal);\r\n\t\t\t\t\tlDI.set(vy, valueYReal);\r\n\t\t\t\t}\r\n\t\t\t\tif (corner == \"r\") {\r\n\t\t\t\t\tconst valueX0 = lDI.get(vx, 0)\r\n\t\t\t\t\tconst positionX0 = xAxis.valueToPosition(valueX0);\r\n\t\t\t\t\tconst positionX = xAxis.valueToPosition(valueX);\r\n\r\n\t\t\t\t\trDI.set(vx, valueX);\r\n\t\t\t\t\tthis._setXLocation(rDI, valueX);\r\n\r\n\t\t\t\t\tlet mpos = positionX0 + (positionX - positionX0) / 2;\r\n\t\t\t\t\tlet mx = this._getXValue(xAxis.positionToValue(mpos));\r\n\r\n\t\t\t\t\ttDI.set(vx, mx);\r\n\t\t\t\t\tbDI.set(vx, mx);\r\n\t\t\t\t\tthis._setXLocation(tDI, mx);\r\n\t\t\t\t\tthis._setXLocation(bDI, mx);\r\n\r\n\t\t\t\t\trDI.set(vwy, valueYReal);\r\n\t\t\t\t\trDI.set(vy, valueYReal);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._positionBullets(dataItem);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerClick(event);\r\n\r\n\t\tif (!this._isDragging) {\r\n\t\t\tif (!this._isDrawing) {\r\n\t\t\t\tthis._isDrawing = true;\r\n\t\t\t\tthis.bulletsContainer.show();\r\n\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._isDrawing = false;\r\n\t\t\t\tthis._index++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerMove(event);\r\n\t\tif (this._isDrawing) {\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (movePoint) {\r\n\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\t\tconst index = this._index;\r\n\t\t\t\tconst diT = this._di[index][\"t\"];\r\n\t\t\t\tconst diB = this._di[index][\"b\"];\r\n\t\t\t\tconst diL = this._di[index][\"l\"];\r\n\t\t\t\tconst diR = this._di[index][\"r\"];\r\n\r\n\t\t\t\tconst valueY0 = this._clickVY;\r\n\r\n\t\t\t\tconst positionX = xAxis.coordinateToPosition(movePoint.x);\r\n\t\t\t\tconst positionX0 = this._clickPX;\r\n\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(positionX));\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)));\r\n\r\n\t\t\t\tif (diB && diL && diR && diT) {\r\n\t\t\t\t\tdiB.set(\"valueY\", valueY);\r\n\t\t\t\t\tdiB.set(\"valueYWorking\", valueY);\r\n\r\n\t\t\t\t\tconst my = valueY0 + (valueY - valueY0) / 2;\r\n\t\t\t\t\tconst mx = this._getXValue(xAxis.positionToValue(positionX0 + (positionX - positionX0) / 2))\r\n\r\n\t\t\t\t\tdiR.set(\"valueY\", my);\r\n\t\t\t\t\tdiR.set(\"valueYWorking\", my);\r\n\r\n\t\t\t\t\tdiL.set(\"valueY\", my);\r\n\t\t\t\t\tdiL.set(\"valueYWorking\", my);\r\n\r\n\t\t\t\t\tdiB.set(\"valueX\", mx);\r\n\t\t\t\t\tdiT.set(\"valueX\", mx);\r\n\r\n\t\t\t\t\tthis._setXLocation(diB, mx);\r\n\t\t\t\t\tthis._setXLocation(diT, mx);\r\n\r\n\t\t\t\t\tdiR.set(\"valueX\", valueX);\r\n\t\t\t\t\tthis._setXLocation(diR, valueX);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\t\t\tthis._clickPX = xAxis.coordinateToPosition(point.x);\r\n\r\n\t\t\tconst valueX = xAxis.positionToValue(this._clickPX);\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)));\r\n\r\n\t\t\tthis._clickVY = valueY;\r\n\r\n\t\t\tthis._di[index] = {};\r\n\r\n\t\t\tthis._addPoint(valueX, valueY, \"l\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"t\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"b\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"r\", index);\r\n\r\n\t\t\tconst color = this.get(\"fillColor\", this.get(\"fill\"));\r\n\t\t\tconst strokeColor = this.get(\"strokeColor\", this.get(\"stroke\"));\r\n\t\t\tconst ellipse = this.makeEllipse();\r\n\t\t\tthis._ellipses[index] = ellipse;\r\n\t\t\tellipse.setAll({ userData: index, fill: color, stroke: strokeColor });\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoint(valueX: number, valueY: number, corner: string, index: number) {\r\n\t\tthis.data.push({ valueY: valueY, valueX: valueX });\r\n\t\tconst len = this.dataItems.length;\r\n\t\tconst dataItem = this.dataItems[len - 1];\r\n\t\tif (dataItem) {\r\n\t\t\tthis._setXLocation(dataItem, valueX);\r\n\t\t\tthis._addContextInfo(index, corner);\r\n\r\n\t\t\tthis._di[index][corner] = dataItem;\r\n\r\n\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tlet index = 0;\r\n\t\t$array.each(this._di, (dataItems) => {\r\n\t\t\tconst diT = dataItems[\"t\"];\r\n\t\t\tconst diB = dataItems[\"b\"];\r\n\t\t\tconst diL = dataItems[\"l\"];\r\n\t\t\tconst diR = dataItems[\"r\"];\r\n\t\t\tif (diT && diB && diL && diR) {\r\n\t\t\t\tconst pt = diT.get(\"point\");\r\n\t\t\t\tconst pb = diB.get(\"point\");\r\n\t\t\t\tconst pr = diR.get(\"point\");\r\n\t\t\t\tconst pl = diL.get(\"point\");\r\n\r\n\t\t\t\tif (pt && pb && pr && pl) {\r\n\t\t\t\t\tconst rx = (pr.x - pl.x) / 2;\r\n\t\t\t\t\tconst ry = (pb.y - pt.y) / 2;\r\n\t\t\t\t\tconst x = pl.x + rx;\r\n\t\t\t\t\tconst y = pt.y + ry;\r\n\t\t\t\t\tconst ellipse = this._ellipses[index];\r\n\t\t\t\t\tif (ellipse) {\r\n\t\t\t\t\t\tellipse.setAll({ x: x, y: y, radiusX: rx, radiusY: ry })\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tindex++;\r\n\t\t})\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst ellipse = this._ellipses[index];\r\n\t\t\tif (ellipse) {\r\n\t\t\t\tdelete (this._ellipses[index]);\r\n\t\t\t\tthis.ellipses.removeValue(ellipse);\r\n\t\t\t\tellipse.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface ITrendLineSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface ITrendLineSeriesSettings extends ISimpleLineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tfield: \"open\" | \"value\" | \"low\" | \"high\";\r\n}\r\n\r\nexport interface ITrendLineSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class TrendLineSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"TrendLineSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([TrendLineSeries.className]);\r\n\r\n\tdeclare public _settings: ITrendLineSeriesSettings;\r\n\tdeclare public _privateSettings: ITrendLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ITrendLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"trendline\";\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\t\tif (series) {\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\tlet x1 = this._getXValue(diP1.get(\"valueX\" as any));\r\n\t\t\tlet x2 = this._getXValue(diP2.get(\"valueX\" as any));\r\n\r\n\t\t\tconst di1 = xAxis.getSeriesItem(series, Math.max(0, xAxis.valueToPosition(x1)));\r\n\t\t\tconst di2 = xAxis.getSeriesItem(series, Math.min(1, xAxis.valueToPosition(x2)));\r\n\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tif (di1 && di2) {\r\n\t\t\t\tlet y1 = di1.get(field as any);\r\n\t\t\t\tlet y2 = di2.get(field as any);\r\n\r\n\t\t\t\tdiP1.set(\"valueY\", y1);\r\n\t\t\t\tdiP1.set(\"valueYWorking\", y1);\r\n\r\n\t\t\t\tdiP2.set(\"valueY\", y2);\r\n\t\t\t\tdiP2.set(\"valueYWorking\", y2);\r\n\r\n\t\t\t\tdiP1.set(\"valueX\", x1);\r\n\t\t\t\tdiP2.set(\"valueX\", x2);\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// need to override so that location would not be set\r\n\tprotected _setXLocation() {\r\n\r\n\t}\r\n}","import { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IQuadrantLineSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IQuadrantLineSeriesSettings extends ISimpleLineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tfield: \"open\" | \"value\" | \"low\" | \"high\";\r\n}\r\n\r\nexport interface IQuadrantLineSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class QuadrantLineSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"QuadrantLineSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([QuadrantLineSeries.className]);\r\n\r\n\tdeclare public _settings: IQuadrantLineSeriesSettings;\r\n\tdeclare public _privateSettings: IQuadrantLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IQuadrantLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"quadrant\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst movePoint = this._movePointerPoint;\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\r\n\t\tif (series && movePoint) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\tlet x1 = this._getXValue(diP1.get(\"valueX\" as any));\r\n\t\t\tlet x2 = this._getXValue(diP2.get(\"valueX\" as any));\r\n\r\n\t\t\tconst di1 = xAxis.getSeriesItem(series, Math.max(0, xAxis.valueToPosition(x1)));\r\n\t\t\tconst di2 = xAxis.getSeriesItem(series, Math.min(1, xAxis.valueToPosition(x2)));\r\n\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tif (di1 && di2) {\r\n\t\t\t\tlet y1 = di1.get(field as any);\r\n\t\t\t\tlet y2 = di2.get(field as any);\r\n\r\n\t\t\t\tdiP1.set(\"valueY\", y1);\r\n\t\t\t\tdiP1.set(\"valueYWorking\", y1);\r\n\r\n\t\t\t\tdiP2.set(\"valueY\", y2);\r\n\t\t\t\tdiP2.set(\"valueYWorking\", y2);\r\n\r\n\t\t\t\tdiP1.set(\"valueX\", x1);\r\n\t\t\t\tdiP2.set(\"valueX\", x2);\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tconst chart = this.chart;\r\n\t\tthis.fills.clear();\r\n\t\tif (chart) {\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\r\n\t\t\t\tconst fill1 = this.makeFill(this.fills);\r\n\t\t\t\tconst fill2 = this.makeFill(this.fills);\r\n\r\n\t\t\t\tconst index = this.dataItems.indexOf(diP1);\r\n\t\t\t\tfor (let j = index; j >= 0; j--) {\r\n\t\t\t\t\tconst dataContext = this.dataItems[j].dataContext as any;\r\n\t\t\t\t\tconst template = dataContext.fill;\r\n\t\t\t\t\tif (template) {\r\n\t\t\t\t\t\tfill1.template = template;\r\n\t\t\t\t\t\tfill2.template = template;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst userData = [this.dataItems.indexOf(diP1), this.dataItems.indexOf(diP2)];\r\n\t\t\t\tconst settings = { userData: userData };\r\n\r\n\t\t\t\tfill1.setAll(settings);\r\n\t\t\t\tfill2.setAll(settings);\r\n\t\t\t\tfill2.set(\"forceInactive\", true);\r\n\r\n\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\tconst dy = (p2.y - p1.y) / 4;\r\n\t\t\t\t\tconst m1y = p1.y + dy;\r\n\t\t\t\t\tconst m2y = p1.y + dy * 2;\r\n\t\t\t\t\tconst m3y = p1.y + dy * 3;\r\n\r\n\t\t\t\t\tline.set(\"draw\", (display) => {\r\n\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y);\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, p1.y);\r\n\r\n\t\t\t\t\t\tdisplay.moveTo(p1.x, m1y);\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, m1y);\r\n\r\n\t\t\t\t\t\tdisplay.moveTo(p1.x, m2y);\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, m2y);\r\n\r\n\t\t\t\t\t\tdisplay.moveTo(p1.x, m3y);\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, m3y);\r\n\r\n\t\t\t\t\t\tdisplay.moveTo(p1.x, p2.y);\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y);\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tfill1.set(\"draw\", (display) => {\r\n\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y);\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, p1.y);\r\n\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y);\r\n\t\t\t\t\t\tdisplay.lineTo(p1.x, p2.y);\r\n\t\t\t\t\t\tdisplay.lineTo(p1.x, p1.y);\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tfill2.set(\"draw\", (display) => {\r\n\t\t\t\t\t\tdisplay.moveTo(p1.x, m1y);\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, m1y);\r\n\r\n\t\t\t\t\t\tdisplay.lineTo(p2.x, m3y);\r\n\t\t\t\t\t\tdisplay.lineTo(p1.x, m3y);\r\n\t\t\t\t\t\tdisplay.lineTo(p1.x, m1y);\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _drawFill() {\r\n\r\n\t}\r\n\r\n\t// need to override so that location would not be set\r\n\tprotected _setXLocation() {\r\n\r\n\t}\r\n\r\n\tprotected _updateLine() {\r\n\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { Graphics } from \"../../../core/render/Graphics\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\nimport { Label } from \"../../../core/render/Label\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\nimport { Template } from \"../../../core/util/Template\";\r\nimport type { Line } from \"../../../core/render/Line\";\r\n\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IFibonacciSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n\r\n}\r\n\r\nexport interface IFibonacciSeriesSettings extends ISimpleLineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tsequence?: Array<number>;\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tcolors?: Array<Color>\r\n}\r\n\r\nexport interface IFibonacciSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\nexport class FibonacciSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"FibonacciSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([FibonacciSeries.className]);\r\n\r\n\tdeclare public _settings: IFibonacciSeriesSettings;\r\n\tdeclare public _privateSettings: IFibonacciSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IFibonacciSeriesDataItem;\r\n\r\n\tprotected _tag = \"fibonacci\";\r\n\tprotected _labels: Array<Array<Label>> = [];\r\n\tprotected _fills: Array<Array<Graphics>> = [];\r\n\tprotected _strokes: Array<Array<Graphics>> = [];\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeLabel(): Label {\r\n\t\tconst label = this.labels.make();\r\n\t\tthis.mainContainer.children.push(label);\r\n\t\tthis.labels.push(label);\r\n\t\treturn label;\r\n\t}\r\n\r\n\t/**\r\n\t * A list of labels.\r\n\t *\r\n\t * `labels.template` can be used to configure axis labels.\r\n\t *\r\n\t * @default new ListTemplate<Label>\r\n\t */\r\n\tpublic readonly labels: ListTemplate<Label> = new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Label._new(this._root, {}, [this.labels.template])\r\n\t);\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tsuper._updateSegment(index);\r\n\t\tthis._updateSegmentReal(index);\r\n\t}\r\n\r\n\tprotected _updateSegmentReal(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst valueX = diP1.get(\"valueX\", 0);\r\n\t\tdiP2.set(\"valueX\", valueX);\r\n\t\tthis._setXLocation(diP2, valueX);\r\n\t}\r\n\r\n\r\n\tpublic _updateChildren() {\r\n\r\n\t\tsuper._updateChildren();\r\n\t\tthis._updateChildrenReal();\r\n\r\n\t}\r\n\r\n\tprotected _updateChildrenReal() {\r\n\t\tconst chart = this.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif(line){\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\r\n\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\t\tconst valueX = diP1.get(\"valueX\", 0);\r\n\t\t\t\t\tdiP2.set(\"valueX\", valueX);\r\n\t\t\t\t\tthis._setXLocation(diP2, valueX);\r\n\r\n\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\tp2.x = chart.plotContainer.width();\r\n\t\t\t\t\t\tconst sequence = this.get(\"sequence\", []);\r\n\t\t\t\t\t\tconst colors = this.get(\"colors\", []);\r\n\t\t\t\t\t\tlet prevValue = 0;\r\n\r\n\t\t\t\t\t\tconst labels = this._labels[i];\r\n\t\t\t\t\t\tconst strokes = this._strokes[i];\r\n\t\t\t\t\t\tconst fills = this._fills[i];\r\n\r\n\t\t\t\t\t\tfor (let i = 0; i < sequence.length; i++) {\r\n\t\t\t\t\t\t\tconst value = sequence[i];\r\n\r\n\t\t\t\t\t\t\tconst color = colors[i];\r\n\t\t\t\t\t\t\tconst label = labels[i];\r\n\r\n\t\t\t\t\t\t\tconst fill = fills[i];\r\n\t\t\t\t\t\t\tconst stroke = strokes[i];\r\n\r\n\t\t\t\t\t\t\tconst y1 = p1.y + (p2.y - p1.y) * prevValue;\r\n\t\t\t\t\t\t\tconst y2 = p1.y + (p2.y - p1.y) * value;\r\n\r\n\t\t\t\t\t\t\tconst realValue = yAxis.positionToValue(yAxis.coordinateToPosition(y2));\r\n\r\n\t\t\t\t\t\t\tfill.setPrivate(\"visible\", true);\r\n\t\t\t\t\t\t\tstroke.setPrivate(\"visible\", true);\r\n\r\n\t\t\t\t\t\t\tfill.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\tdisplay.moveTo(p1.x, y1);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, y1);\r\n\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, y2);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p1.x, y2);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p1.x, y1);\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\tstroke.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\tdisplay.moveTo(p1.x, y2);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, y2);\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\tconst dataItem = label.dataItem;\r\n\t\t\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\t\t\tdataItem.set(\"value\" as any, realValue);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlabel.setAll({ x: p2.x, y: y2, fill: color });\r\n\t\t\t\t\t\t\tlabel.text.markDirtyText();\r\n\r\n\t\t\t\t\t\t\tprevValue = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number):Line {\r\n\t\tlet line = super._addPoints(event, index);\r\n\r\n\t\tconst labelArr = [];\r\n\t\tconst fillsArr = [];\r\n\t\tconst strokesArr = [];\r\n\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst userData = [this.dataItems.indexOf(diP1), this.dataItems.indexOf(diP2)];\r\n\r\n\t\tconst sequence = this.get(\"sequence\", []);\r\n\t\tconst colors = this.get(\"colors\", []);\r\n\r\n\t\tfor (let i = 0; i < sequence.length; i++) {\r\n\t\t\tconst label = this.makeLabel();\r\n\t\t\tconst dataItem = this.makeDataItem({});\r\n\t\t\tdataItem.set(\"sequence\" as any, sequence[i]);\r\n\t\t\tlabel._setDataItem(dataItem);\r\n\t\t\tlabelArr.push(label);\r\n\r\n\t\t\tconst fill = this.makeFill(this.fills);\r\n\t\t\tfillsArr.push(fill);\r\n\r\n\t\t\tconst stroke = this.makeStroke(this.strokes);\r\n\t\t\tstrokesArr.push(stroke);\r\n\r\n\t\t\tlet fillColor: Color | undefined = colors[i];\r\n\t\t\tlet strokeColor: Color | undefined = colors[i];\r\n\r\n\t\t\tif (!fillColor) {\r\n\t\t\t\tfillColor = this.get(\"fillColor\", this.get(\"fill\"));\r\n\t\t\t}\r\n\t\t\tif (!strokeColor) {\r\n\t\t\t\tstrokeColor = this.get(\"strokeColor\", this.get(\"stroke\"));\r\n\t\t\t}\r\n\r\n\t\t\tfill.setAll({ fill: fillColor, userData: userData });\r\n\t\t\tstroke.setAll({ stroke: strokeColor, userData: userData });\r\n\t\t}\r\n\r\n\t\tthis._labels[index] = labelArr;\r\n\t\tthis._fills[index] = fillsArr;\r\n\t\tthis._strokes[index] = strokesArr;\r\n\r\n\t\treturn line;\r\n\t}\r\n\r\n\tprotected _drawFill() {\r\n\r\n\t}\r\n\r\n\tprotected _drawStroke() {\r\n\r\n\t}\r\n\r\n\tprotected _updateLine() {\r\n\r\n\t}\r\n\r\n\tprotected _clearGraphics() {\r\n\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst labels = this._labels[index];\r\n\t\t\tconst fills = this._fills[index];\r\n\t\t\tconst strokes = this._strokes[index];\r\n\r\n\t\t\tif (labels) {\r\n\t\t\t\t$array.each(labels, (item) => {\r\n\t\t\t\t\titem.dispose();\r\n\t\t\t\t\tthis.labels.removeValue(item);\r\n\t\t\t\t})\r\n\r\n\t\t\t\tdelete (this._labels[index]);\r\n\t\t\t}\r\n\t\t\tif (fills) {\r\n\t\t\t\t$array.each(fills, (item) => {\r\n\t\t\t\t\tthis.fills.removeValue(item);\r\n\t\t\t\t\titem.dispose();\r\n\t\t\t\t})\r\n\t\t\t\tdelete (this._fills[index]);\r\n\t\t\t}\r\n\t\t\tif (strokes) {\r\n\t\t\t\t$array.each(strokes, (item) => {\r\n\t\t\t\t\tthis.strokes.removeValue(item);\r\n\t\t\t\t\titem.dispose();\r\n\t\t\t\t})\r\n\t\t\t\tdelete (this._strokes[index]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { FibonacciSeries, IFibonacciSeriesSettings, IFibonacciSeriesPrivate, IFibonacciSeriesDataItem } from \"./FibonacciSeries\";\r\n\r\nexport interface IFibonacciTimezoneSeriesDataItem extends IFibonacciSeriesDataItem {\r\n\r\n}\r\n\r\nexport interface IFibonacciTimezoneSeriesSettings extends IFibonacciSeriesSettings {\r\n\t\r\n}\r\n\r\nexport interface IFibonacciTimezoneSeriesPrivate extends IFibonacciSeriesPrivate {\r\n\r\n}\r\n\r\n\r\nexport class FibonacciTimezoneSeries extends FibonacciSeries {\r\n\tpublic static className: string = \"FibonacciTimezoneSeries\";\r\n\tpublic static classNames: Array<string> = FibonacciSeries.classNames.concat([FibonacciTimezoneSeries.className]);\r\n\r\n\tdeclare public _settings: IFibonacciTimezoneSeriesSettings;\r\n\tdeclare public _privateSettings: IFibonacciTimezoneSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IFibonacciTimezoneSeriesDataItem;\r\n\r\n\tprotected _tag = \"fibonaccitimezone\";\r\n\r\n\tprotected _updateSegmentReal(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst valueY1 = diP1.get(\"valueY\", 0);\r\n\r\n\t\tdiP2.set(\"valueY\", valueY1)\r\n\t\tdiP2.set(\"valueYWorking\", valueY1)\r\n\r\n\t\tdiP1.setRaw(\"locationX\", 0)\r\n\t\tdiP2.setRaw(\"locationX\", 0)\r\n\t}\r\n\r\n\tprotected _setXLocation(dataItem: DataItem<this[\"_dataItemSettings\"]>, value: number) {\r\n\t\tthis._setXLocationReal(dataItem, value);\r\n\t}\r\n\r\n\tpublic _updateChildrenReal() {\r\n\t\tconst chart = this.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\r\n\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\t\tconst open1 = diP1[\"open\"];\r\n\t\t\t\t\tconst open2 = diP2[\"open\"];\r\n\r\n\t\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\t\t\tif (open1 && open2) {\r\n\t\t\t\t\t\tconst valueX1 = open1[\"valueX\"]\r\n\t\t\t\t\t\tconst valueX2 = open2[\"valueX\"]\r\n\t\t\t\t\t\tconst diff = valueX2 - valueX1;\r\n\r\n\t\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\t\tconst sequence = this.get(\"sequence\", []);\r\n\t\t\t\t\t\t\tconst labels = this._labels[i];\r\n\t\t\t\t\t\t\tconst fills = this._fills[i];\r\n\t\t\t\t\t\t\tconst strokes = this._strokes[i];\r\n\r\n\t\t\t\t\t\t\tfor (let i = 0; i < sequence.length; i++) {\r\n\t\t\t\t\t\t\t\tconst value = sequence[i];\r\n\t\t\t\t\t\t\t\tconst label = labels[i];\r\n\t\t\t\t\t\t\t\tconst fill = fills[i];\r\n\t\t\t\t\t\t\t\tconst stroke = strokes[i];\r\n\r\n\t\t\t\t\t\t\t\tthis.mainContainer.children.moveValue(fill, 0);\r\n\r\n\t\t\t\t\t\t\t\tconst endValue = valueX1 + diff * value;\r\n\t\t\t\t\t\t\t\tconst x1 = p1.x;\r\n\t\t\t\t\t\t\t\tconst x2 = xAxis.get(\"renderer\").positionToCoordinate(xAxis.valueToPosition(endValue));\r\n\r\n\t\t\t\t\t\t\t\tconst y1 = 0;\r\n\t\t\t\t\t\t\t\tconst y2 = chart.plotContainer.height();\r\n\r\n\t\t\t\t\t\t\t\tfill.setPrivate(\"visible\", true);\r\n\t\t\t\t\t\t\t\tstroke.setPrivate(\"visible\", true);\r\n\r\n\t\t\t\t\t\t\t\tfill.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\t\tdisplay.moveTo(x1, y1);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x2, y1);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x2, y2);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x1, y2);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x1, y1);\r\n\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\tstroke.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\t\tdisplay.moveTo(x2, y1);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x2, y2);\r\n\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\tconst dataItem = label.dataItem;\r\n\t\t\t\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\t\t\t\tdataItem.set(\"value\" as any, value);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlabel.setAll({ x: x2, y: y2 });\r\n\t\t\t\t\t\t\t\tlabel.text.markDirtyText();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\nimport type { Line } from \"../../../core/render/Line\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nimport * as $math from \"../../../core/util/Math\";\r\n\r\nexport interface IHorizontalRaySeriesDataItem extends ISimpleLineSeriesDataItem {\r\n\r\n}\r\n\r\nexport interface IHorizontalRaySeriesSettings extends ISimpleLineSeriesSettings {\r\n\t/**\r\n\t * @todo review\r\n\t */\t\r\n\tfield: \"open\" | \"value\" | \"low\" | \"high\";\r\n}\r\n\r\nexport interface IHorizontalRaySeriesPrivate extends ISimpleLineSeriesPrivate {\r\n\r\n}\r\n\r\nexport class HorizontalRaySeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"HorizontalRaySeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([HorizontalRaySeries.className]);\r\n\r\n\tdeclare public _settings: IHorizontalRaySeriesSettings;\r\n\tdeclare public _privateSettings: IHorizontalRaySeriesPrivate;\r\n\tdeclare public _dataItemSettings: IHorizontalRaySeriesDataItem;\r\n\r\n\tprotected _tag = \"ray\";\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\t\tif (series) {\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\tconst min = xAxis.getPrivate(\"min\", 0) + 1;\r\n\t\t\tconst max = xAxis.getPrivate(\"max\", 1) - 1;\r\n\r\n\t\t\tlet x1 = $math.fitToRange(diP2.get(\"valueX\" as any), min, max);\r\n\t\t\tconst di1 = xAxis.getSeriesItem(series, Math.max(0, xAxis.valueToPosition(x1)));\r\n\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tif (di1) {\r\n\t\t\t\tlet y1 = di1.get(field as any);\r\n\r\n\t\t\t\tdiP1.set(\"valueY\", y1);\r\n\t\t\t\tdiP1.set(\"valueYWorking\", y1);\r\n\r\n\t\t\t\tdiP2.set(\"valueY\", y1);\r\n\t\t\t\tdiP2.set(\"valueYWorking\", y1);\r\n\r\n\t\t\t\tdiP1.set(\"valueX\", x1);\r\n\t\t\t\tdiP2.set(\"valueX\", x1 + 0.01);\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateLine(line: Line, hitLine: Line, p11: IPoint, _p22: IPoint, p1: IPoint, _p2: IPoint) {\r\n\t\tline.set(\"points\", [p1, p11]);\r\n\t\thitLine.set(\"points\", [p1, p11]);\r\n\t}\r\n\r\n\t// need to override so that location would not be set\r\n\tprotected _setXLocation() {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerMoveReal() {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (!this._isDragging) {\r\n\t\t\tthis._addPoints(event, this._index);\r\n\t\t\tthis._updateSegment(this._index);\r\n\t\t\tthis._index++;\r\n\t\t\tthis._isDrawing = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number): Line {\r\n\t\tlet line = super._addPoints(event, index);\r\n\t\tthis._updateExtentionLine(line);\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\t\tdiP2.set(\"valueX\", diP2.get(\"valueX\", 0) + 0.001);\r\n\t\tthis._isDrawing = false;\r\n\t\treturn line;\r\n\t}\r\n}","import type { IDisposer } from \"../../../core/util/Disposer\";\r\nimport type { StockChart } from \"../StockChart\";\r\nimport type { StockControl } from \"./StockControl\";\r\n\r\nimport { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"../../../core/util/Entity\"\r\nimport StockToolbarCSS from \"./StockToolbarCSS\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n//import * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IStockToolbarSettings extends IEntitySettings {\r\n\r\n\t/**\r\n\t * A [[StockChart]] the toolbar is for.\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * A reference to an element in the document to place tools in.\r\n\t */\r\n\tcontainer: HTMLElement;\r\n\r\n\t/**\r\n\t * A list of tools to show in toolbar.\r\n\t */\r\n\tcontrols?: StockControl[];\r\n\r\n\t/**\r\n\t * If set to `false` the toolbar will not load default CSS.\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tuseDefaultCSS?: boolean;\r\n\r\n\t/**\r\n\t * Menu will disable all interactions for the underlying chart when using\r\n\t * tools.\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tdeactivateRoot?: boolean;\r\n\r\n}\r\n\r\nexport interface IStockToolbarPrivate extends IEntityPrivate {\r\n}\r\n\r\nexport interface IStockToolbarEvents extends IEntityEvents {\r\n\tcreated: {}\r\n}\r\n\r\n/**\r\n * @todo revview\r\n */\r\nexport class StockToolbar extends Entity {\r\n\tpublic static className: string = \"StockToolbar\";\r\n\tpublic static classNames: Array<string> = Entity.classNames.concat([StockToolbar.className]);\r\n\r\n\tdeclare public _settings: IStockToolbarSettings;\r\n\tdeclare public _privateSettings: IStockToolbarPrivate;\r\n\tdeclare public _events: IStockToolbarEvents;\r\n\r\n\tprivate _cssDisposer?: IDisposer;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Inherit default themes from chart\r\n\t\tthis._defaultThemes = this.get(\"stockChart\")._defaultThemes;\r\n\t\tsuper._afterNewApplyThemes();\r\n\r\n\t\tthis._initControls();\r\n\t\tthis.loadDefaultCSS();\r\n\r\n\t\tthis._root.addDisposer(this);\r\n\r\n\t\tthis.events.dispatch(\"created\", {\r\n\t\t\ttype: \"created\",\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\r\n\t\tif (this.isDirty(\"container\")) {\r\n\t\t\t// TODO\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"useDefaultCSS\")) {\r\n\t\t\tif (this.get(\"useDefaultCSS\")) {\r\n\t\t\t\tthis.loadDefaultCSS();\r\n\t\t\t}\r\n\t\t\telse if (this._cssDisposer) {\r\n\t\t\t\tthis._cssDisposer.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"controls\")) {\r\n\t\t\tthis._initControls();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\r\n\t\t// $array.each(this._itemDisposers, (x) => {\r\n\t\t// \tx.dispose();\r\n\t\t// });\r\n\t}\r\n\r\n\tprivate _initControls(): void {\r\n\t\tconst controls = this.get(\"controls\", []);\r\n\t\t$array.each(controls, (control, _index) => {\r\n\t\t\tif (!control.getPrivate(\"toolbar\")) {\r\n\t\t\t\t// @todo insert at specific index\r\n\t\t\t\tcontrol.setPrivate(\"toolbar\", this);\r\n\t\t\t\tthis.get(\"container\")!.appendChild(control.getPrivate(\"button\")!);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * Loads the default CSS.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic loadDefaultCSS(): void {\r\n\t\tconst disposer = StockToolbarCSS($utils.getShadowRoot(this._root.dom), this._root);\r\n\t\tthis._disposers.push(disposer);\r\n\t\tthis._cssDisposer = disposer;\r\n\t}\r\n\r\n}","import { Dropdown, IDropdownSettings, IDropdownPrivate, IDropdownEvents } from \"./Dropdown\"\r\n//import type { IDisposer } from \"../../../core/util/Disposer\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IDropdownListItem {\r\n\tid: string;\r\n\tlabel: string;\r\n\tsubLabel?: string;\r\n\tclassName?: string;\r\n\ticon?: SVGElement;\r\n\tform?: \"radio\" | \"checkbox\";\r\n\tvalue?: string;\r\n\tchecked?: boolean;\r\n\toptions?: IDropdownListItem[];\r\n}\r\n\r\nexport interface IDropdownListSettings extends IDropdownSettings {\r\n\titems?: IDropdownListItem[];\r\n\tmaxSearchItems?: number;\r\n\tsearchable?: boolean;\r\n\tsearchCallback?: (query: string) => Promise<IDropdownListItem[]>;\r\n}\r\n\r\n\r\nexport interface IDropdownListPrivate extends IDropdownPrivate {\r\n\tlist?: HTMLUListElement;\r\n\tsearch?: HTMLDivElement;\r\n\tcurrentId?: string;\r\n}\r\n\r\nexport interface IDropdownListEvents extends IDropdownEvents {\r\n\tinvoked: {\r\n\t\titem: IDropdownListItem;\r\n\t};\r\n\r\n\tchanged: {\r\n\t\titem: IDropdownListItem;\r\n\t\tvalue: string | boolean;\r\n\t}\r\n}\r\n\r\n/**\r\n * @todo revview\r\n */\r\nexport class DropdownList extends Dropdown {\r\n\tpublic static className: string = \"DropdownList\";\r\n\tpublic static classNames: Array<string> = Dropdown.classNames.concat([DropdownList.className]);\r\n\r\n\tdeclare public _settings: IDropdownListSettings;\r\n\tdeclare public _privateSettings: IDropdownListPrivate;\r\n\tdeclare public _events: IDropdownListEvents;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis._root.addDisposer(this);\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\r\n\t\t// Create container\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\r\n\t\t// Init search\r\n\t\tif (this.get(\"searchable\")) {\r\n\t\t\tthis._initSearch();\r\n\t\t}\r\n\r\n\t\t// Create list\r\n\t\tconst list = document.createElement(\"ul\");\r\n\t\tlist.className = \"am5stock-control-list\";\r\n\t\tcontainer.appendChild(list);\r\n\t\tthis.setPrivate(\"list\", list);\r\n\r\n\t\tthis._initItems();\r\n\t}\r\n\r\n\tprotected _initItems(items?: IDropdownListItem[]): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tlist.innerHTML = \"\";\r\n\r\n\t\tif (!items) {\r\n\t\t\titems = this.get(\"items\", []);\r\n\t\t}\r\n\t\t$array.each(items, (item) => {\r\n\t\t\tthis.addItem(item);\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _initSearch(): void {\r\n\t\tlet searchBox = this.getPrivate(\"search\");\r\n\t\tif (this.get(\"searchable\")) {\r\n\t\t\tif (!searchBox) {\r\n\t\t\t\tconst container = this.getPrivate(\"container\")!;\r\n\t\t\t\tsearchBox = document.createElement(\"div\");\r\n\t\t\t\tsearchBox.className = \"am5stock-list-search\";\r\n\t\t\t\tcontainer.appendChild(searchBox);\r\n\t\t\t\tthis.setPrivate(\"search\", searchBox);\r\n\r\n\t\t\t\tconst input = document.createElement(\"input\");\r\n\t\t\t\tinput.type = \"text\";\r\n\t\t\t\tinput.placeholder = this._root.language.translateAny(\"Search\");\r\n\t\t\t\tsearchBox.appendChild(input);\r\n\r\n\t\t\t\tthis._disposers.push($utils.addEventListener(input, \"input\", (_ev) => {\r\n\t\t\t\t\tthis._filterItems(input.value);\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (searchBox) {\r\n\t\t\tsearchBox.style.display = \"none\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"items\")) {\r\n\t\t\tthis._initItems();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"searchable\")) {\r\n\t\t\tthis._initSearch();\r\n\t\t}\r\n\r\n\t\tif (this.isPrivateDirty(\"currentId\")) {\r\n\t\t\t// @todo\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\r\n\t\t// $array.each(this._itemDisposers, (x) => {\r\n\t\t// \tx.dispose();\r\n\t\t// });\r\n\t}\r\n\r\n\tprotected async _filterItems(search?: string) {\r\n\t\tconst searchCallback = this.get(\"searchCallback\");\r\n\t\tif (searchCallback && search) {\r\n\t\t\tconst maxItems = this.get(\"maxSearchItems\", 1000);\r\n\t\t\tlet items = await searchCallback.call(this, search);\r\n\t\t\tif (maxItems && (items.length > maxItems)) {\r\n\t\t\t\titems = items.slice(0, maxItems - 1);\r\n\t\t\t\titems.push({\r\n\t\t\t\t\tid: \"\",\r\n\t\t\t\t\tclassName: \"am5stock-list-info\",\r\n\t\t\t\t\tlabel: this._root.language.translateAny(\"Seach results are limited to %1.\", undefined, \"\" + maxItems)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis._initItems(items);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst list = this.getPrivate(\"list\");\r\n\t\t\tif (list) {\r\n\t\t\t\tconst items = list.getElementsByTagName(\"li\");\r\n\t\t\t\t$array.each(items, (item) => {\r\n\t\t\t\t\tconst regex = new RegExp(search || \"\", \"i\");\r\n\t\t\t\t\tif (!search || item.innerText.match(regex)) {\r\n\t\t\t\t\t\titem.style.display = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\titem.style.display = \"none\";\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addItem(info: IDropdownListItem): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst item = document.createElement(\"li\");\r\n\t\titem.className = \"am5stock-list-item\";\r\n\r\n\t\tif (info.className) {\r\n\t\t\titem.className += \" \" + info.className;\r\n\t\t}\r\n\r\n\t\tif (info.icon) {\r\n\t\t\titem.appendChild(info.icon);\r\n\t\t}\r\n\r\n\t\tlet inputId: string | undefined;;\r\n\t\tif (info.form) {\r\n\t\t\tconst input: HTMLInputElement = document.createElement(\"input\");\r\n\t\t\tinputId = \"am5stock-list-\" + info.id;\r\n\t\t\tinput.type = info.form;\r\n\t\t\tif (info.value) {\r\n\t\t\t\tinput.value = info.value;\r\n\t\t\t}\r\n\t\t\tif (info.form == \"radio\") {\r\n\t\t\t\tinput.name = info.id;\r\n\t\t\t\tinputId +=  \"-\" + info.value;\r\n\t\t\t}\r\n\t\t\tif (info.checked) {\r\n\t\t\t\tinput.checked = true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tinput.id = inputId;\r\n\r\n\t\t\t// this._disposers.push($utils.addEventListener(input, \"change\", (ev) => {\r\n\t\t\t// \tconsole.log(\"change\")\r\n\t\t\t// \tev.preventDefault();\r\n\t\t\t// \tthis.events.dispatch(\"changed\", {\r\n\t\t\t// \t\ttype: \"changed\",\r\n\t\t\t// \t\titem: info,\r\n\t\t\t// \t\tvalue: input.checked,\r\n\t\t\t// \t\tchecked: input.checked,\r\n\t\t\t// \t\ttarget: this\r\n\t\t\t// \t});\r\n\t\t\t// }));\r\n\r\n\t\t\tthis._disposers.push($utils.addEventListener(item, \"click\", (ev) => {\r\n\t\t\t\t//ev.preventDefault();\r\n\t\t\t\tif (ev.target !== input) {\r\n\t\t\t\t\tinput.checked = !input.checked;\r\n\t\t\t\t}\r\n\t\t\t\tthis.events.dispatch(\"changed\", {\r\n\t\t\t\t\ttype: \"changed\",\r\n\t\t\t\t\titem: info,\r\n\t\t\t\t\tvalue: input.checked,\r\n\t\t\t\t\tchecked: input.checked,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}));\r\n\r\n\t\t\titem.appendChild(input);\r\n\t\t}\r\n\r\n\t\tconst label = document.createElement(\"label\");\r\n\t\tlabel.innerHTML = info.label;\r\n\t\tif (info.label == \"\") {\r\n\t\t\tlabel.style.display = \"none\";\r\n\t\t}\r\n\t\titem.appendChild(label);\r\n\r\n\t\tif (info.subLabel) {\r\n\t\t\tconst subLabel = document.createElement(\"label\");\r\n\t\t\tsubLabel.className = \"am5stock-list-sub\";\r\n\t\t\tsubLabel.innerHTML = info.subLabel;\r\n\t\t\titem.appendChild(subLabel);\r\n\t\t}\r\n\r\n\t\tlist.appendChild(item);\r\n\r\n\t\t// Add click event\r\n\t\tthis._disposers.push($utils.addEventListener(item, \"click\", (_ev) => {\r\n\t\t\tthis.hide();\r\n\t\t\tthis.events.dispatch(\"invoked\", {\r\n\t\t\t\ttype: \"invoked\",\r\n\t\t\t\titem: info,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t}));\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tsuper.hide();\r\n\t\tthis._filterItems();\r\n\t\tlet searchBox = this.getPrivate(\"search\");\r\n\t\tif (searchBox) {\r\n\t\t\tconst inputs = searchBox.getElementsByTagName(\"input\");\r\n\t\t\tlet isCustomSearch = false;\r\n\t\t\t$array.each(inputs, (input) => {\r\n\t\t\t\tif (input.value !== \"\") {\r\n\t\t\t\t\tisCustomSearch = true;\r\n\t\t\t\t\tinput.value = \"\";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (this.get(\"searchCallback\") && isCustomSearch) {\r\n\t\t\t\tthis._initItems();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport type DrawingTools = \"Average\" | \"Callout\" | \"Doodle\" | \"Ellipse\" | \"Fibonacci\" | \"Fibonacci Timezone\" | \"Horizontal Line\" | \"Horizontal Ray\" | \"Arrows &amp; Icons\" | \"Label\" | \"Line\" | \"Polyline\" | \"Quadrant Line\" | \"Rectangle\" | \"Regression\" | \"Trend Line\" | \"Vertical Line\";\r\n\r\nexport interface IDrawingToolControlSettings extends IStockControlSettings {\r\n\ttools: DrawingTools[];\r\n}\r\n\r\nexport interface IDrawingToolControlPrivate extends IStockControlPrivate {\r\n\tlist?: DropdownList;\r\n}\r\n\r\nexport interface IDrawingToolControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\ttool: DrawingTools\r\n\t}\r\n}\r\n\r\n/**\r\n * Control which allows selecting drawing tool.\r\n *\r\n * Should not be instantiated directly. Use [[DrawingControl]] instead.\r\n */\r\nexport class DrawingToolControl extends StockControl {\r\n\tpublic static className: string = \"DrawingToolControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DrawingToolControl.className]);\r\n\r\n\tdeclare public _settings: IDrawingToolControlSettings;\r\n\tdeclare public _privateSettings: IDrawingToolControlPrivate;\r\n\tdeclare public _events: IDrawingToolControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst list = DropdownList.new(this._root, {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\")\r\n\t\t});\r\n\t\tthis.setPrivate(\"list\", list);\r\n\r\n\t\tlist.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tlist.events.on(\"invoked\", (ev) => {\r\n\t\t\tthis.setTool(<DrawingTools>ev.item.label);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\ttool: <DrawingTools>ev.item.id,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => list.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlist.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\r\n\t\tthis._initTools();\r\n\t}\r\n\r\n\tpublic setTool(tool: DrawingTools): void {\r\n\t\tthis.getPrivate(\"icon\")!.innerHTML = \"\";\r\n\t\tthis.getPrivate(\"icon\")!.appendChild(this._getToolIcon(tool));\r\n\t\t//this.getPrivate(\"label\")!.innerHTML = tool;\r\n\t\tthis._setLabel(tool);\r\n\t}\r\n\r\n\tprotected _initTools(): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst tools = this.get(\"tools\");\r\n\t\tconst items: IDropdownListItem[] = [];\r\n\t\t$array.each(tools, (tool: DrawingTools) => {\r\n\t\t\titems.push({\r\n\t\t\t\tid: tool,\r\n\t\t\t\tlabel: this._root.language.translateAny(tool),\r\n\t\t\t\ticon: this._getToolIcon(tool)\r\n\t\t\t});\r\n\t\t})\r\n\t\tlist.set(\"items\", items);\r\n\t}\r\n\r\n\tprotected _getToolIcon(tool: DrawingTools): SVGElement {\r\n\t\treturn StockIcons.getIcon(tool);\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\r\n\t\tif (this.isDirty(\"tools\")) {\r\n\t\t\tthis._initTools();\r\n\t\t}\r\n\r\n\t\t// if (this.isDirty(\"name\")) {\r\n\t\t// \tthis.getPrivate(\"label\")!.innerHTML = this.get(\"name\", \"\");\r\n\t\t// }\r\n\r\n\t\t// todo icon\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\r\n\t\t// $array.each(this._itemDisposers, (x) => {\r\n\t\t// \tx.dispose();\r\n\t\t// });\r\n\t}\r\n\r\n\r\n}\r\n","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IDropdownListControlSettings extends IStockControlSettings {\r\n\tcurrentItem?: string | IDropdownListItem;\r\n\tfixedLabel?: boolean;\r\n\titems?: Array<string | IDropdownListItem>;\r\n\tmaxSearchItems?: number,\r\n\tsearchable?: boolean;\r\n\tsearchCallback?: (query: string) => IDropdownListItem[];\r\n}\r\n\r\nexport interface IDropdownListControlPrivate extends IStockControlPrivate {\r\n\tdropdown?: DropdownList;\r\n}\r\n\r\nexport interface IDropdownListControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\titem: string | IDropdownListItem;\r\n\t};\r\n}\r\n\r\n/**\r\n * A generic control which creates a searchable list of items in a dropdown.\r\n *\r\n * Can be used in a [[StockToolbar]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/dropdown-list-control/} for more info\r\n */\r\nexport class DropdownListControl extends StockControl {\r\n\tpublic static className: string = \"DropdownListControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DropdownListControl.className]);\r\n\r\n\tdeclare public _settings: IDropdownListControlSettings;\r\n\tdeclare public _privateSettings: IDropdownListControlPrivate;\r\n\tdeclare public _events: IDropdownListControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\t// @todo still needed?\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\r\n\t\t// Disable icon\r\n\t\t//this.getPrivate(\"icon\")!.style.display = \"none\";\r\n\r\n\t\t// Create list\r\n\t\tconst dropdownSettings: any = {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tsearchable: this.get(\"searchable\", false),\r\n\t\t\titems: []\r\n\t\t}\r\n\r\n\t\tconst maxSearchItems = this.get(\"maxSearchItems\");\r\n\t\tif (maxSearchItems) {\r\n\t\t\tdropdownSettings.maxSearchItems = maxSearchItems;\r\n\t\t}\r\n\r\n\t\tconst searchCallback = this.get(\"searchCallback\");\r\n\t\tif (searchCallback) {\r\n\t\t\tdropdownSettings.searchCallback = searchCallback;\r\n\t\t}\r\n\r\n\t\tconst items = this.get(\"items\");\r\n\t\tlet currentItem = this.get(\"currentItem\");\r\n\t\tif (items) {\r\n\t\t\t$array.each(items, (item) => {\r\n\t\t\t\tconst itemObject = $type.isString(item) ? {\r\n\t\t\t\t\tid: item,\r\n\t\t\t\t\tlabel: item\r\n\t\t\t\t} : item;\r\n\t\t\t\tdropdownSettings.items.push(itemObject);\r\n\r\n\t\t\t\tif ($type.isString(currentItem) && currentItem == itemObject.id) {\r\n\t\t\t\t\tcurrentItem = itemObject;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst dropdown = DropdownList.new(this._root, dropdownSettings);\r\n\t\tthis.setPrivate(\"dropdown\", dropdown);\r\n\r\n\t\tif (currentItem) {\r\n\t\t\tthis.setItem(currentItem);\r\n\t\t}\r\n\r\n\t\tdropdown.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"invoked\", (ev) => {\r\n\t\t\tthis.setItem(ev.item);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\titem: ev.item,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\t//dropdown.setPrivate(\"currentId\", $type.numberToString(this.get(\"strokeWidth\")));\r\n\t\t\t\tthis.setTimeout(() => dropdown.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdropdown.hide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setItem(item: string | IDropdownListItem): void {\r\n\t\tif (this.get(\"fixedLabel\") !== true) {\r\n\t\t\tconst label = this.getPrivate(\"label\")!;\r\n\t\t\tif ($type.isString(item)) {\r\n\t\t\t\tlabel.innerHTML = item;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (item.icon) {\r\n\t\t\t\t\tconst icon = this.getPrivate(\"icon\")!;\r\n\t\t\t\t\ticon.innerHTML = \"\";\r\n\t\t\t\t\ticon.appendChild(item.icon.cloneNode(true));\r\n\t\t\t\t\ticon.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t//icon.style.display = \"none\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.label) {\r\n\t\t\t\t\tlabel.innerHTML = item.label;\r\n\t\t\t\t\tlabel.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlabel.innerHTML = \"\";\r\n\t\t\t\t\tlabel.style.display = \"none\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t\tif (this.isDirty(\"items\")) {\r\n\t\t\tconst dropdown = this.getPrivate(\"dropdown\");\r\n\t\t\tif (dropdown) {\r\n\t\t\t\tconst items = this.get(\"items\");\r\n\t\t\t\tconst dropdownItems: IDropdownListItem[] = [];\r\n\t\t\t\tlet currentItem = this.get(\"currentItem\");\r\n\t\t\t\tif (items) {\r\n\t\t\t\t\t$array.each(items, (item) => {\r\n\t\t\t\t\t\tconst itemObject = $type.isString(item) ? {\r\n\t\t\t\t\t\t\tid: item,\r\n\t\t\t\t\t\t\tlabel: item\r\n\t\t\t\t\t\t} : item;\r\n\t\t\t\t\t\tdropdownItems.push(itemObject);\r\n\r\n\t\t\t\t\t\tif ($type.isString(currentItem) && currentItem == itemObject.id) {\r\n\t\t\t\t\t\t\tcurrentItem = itemObject;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tdropdown.set(\"items\", dropdownItems)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\r\n}\r\n","import type { Percent } from \"../../../core/util/Percent\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IIcon {\r\n\tsvgPath: string;\r\n\tscale?: number;\r\n\tcenterX?: Percent;\r\n\tcenterY?: Percent;\r\n\tfillDisabled?: boolean;\r\n}\r\n\r\nexport interface IIconControlSettings extends IStockControlSettings {\r\n\ticons: IIcon[];\r\n}\r\n\r\nexport interface IIconControlPrivate extends IStockControlPrivate {\r\n\tlist?: DropdownList;\r\n}\r\n\r\nexport interface IIconControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\ticon: IIcon\r\n\t}\r\n}\r\n\r\n/**\r\n * Shows selection of icons to choose from for annotating [[StockChart]].\r\n *\r\n * This class is instantiated automatically, and should not be used standalone.\r\n */\r\nexport class IconControl extends StockControl {\r\n\tpublic static className: string = \"IconControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([IconControl.className]);\r\n\r\n\tdeclare public _settings: IIconControlSettings;\r\n\tdeclare public _privateSettings: IIconControlPrivate;\r\n\tdeclare public _events: IIconControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst list = DropdownList.new(this._root, {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tsearchable: false\r\n\t\t});\r\n\t\tthis.setPrivate(\"list\", list);\r\n\t\tlist.getPrivate(\"list\")!.className = \"am5stock-control-icons\";\r\n\r\n\t\tlist.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tlist.events.on(\"invoked\", (ev) => {\r\n\t\t\tconst item = <IIcon>JSON.parse(ev.item.id);\r\n\t\t\tlet icon: IIcon | undefined;\r\n\t\t\tconst icons = this.get(\"icons\");\r\n\t\t\t$array.each(icons, (listIcon) => {\r\n\t\t\t\tif (item.svgPath == listIcon.svgPath) {\r\n\t\t\t\t\ticon = listIcon;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (icon) {\r\n\t\t\t\tthis.setIcon(icon);\r\n\t\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\t\ttype: \"selected\",\r\n\t\t\t\t\ticon: icon,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => list.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlist.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._initIcons();\r\n\t}\r\n\r\n\tpublic setIcon(icon: IIcon): void {\r\n\t\tthis.getPrivate(\"icon\")!.innerHTML = \"\";\r\n\t\tthis.getPrivate(\"icon\")!.appendChild(this._getDrawingIcon(icon));\r\n\t\t//this.getPrivate(\"label\")!.style.display = \"none\";\r\n\t}\r\n\r\n\tprotected _initIcons(): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst icons = this.get(\"icons\");\r\n\t\tconst items: IDropdownListItem[] = [];\r\n\t\t$array.each(icons, (icon: IIcon) => {\r\n\t\t\titems.push({\r\n\t\t\t\tid: JSON.stringify(icon),\r\n\t\t\t\tlabel: \"\",\r\n\t\t\t\ticon: this._getDrawingIcon(icon)\r\n\t\t\t});\r\n\t\t})\r\n\t\tlist.set(\"items\", items);\r\n\t}\r\n\r\n\tpublic _getDrawingIcon(icon: IIcon): SVGElement {\r\n\t\treturn StockIcons._getSVG({ viewbox: \"0 0 50 50\", path: icon.svgPath});\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\r\n\t\tif (this.isDirty(\"icons\")) {\r\n\t\t\tthis._initIcons();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\r\n}\r\n","//import type { IDisposer } from \"../../../core/util/Disposer\";\r\nimport type { DrawingSeries } from \"../drawing/DrawingSeries\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\nimport type { ColorSet } from \"../../../core/util/ColorSet\";\r\nimport type { IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport { color } from \"../../../core/util/Color\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DrawingToolControl, DrawingTools } from \"./DrawingToolControl\";\r\nimport { ColorControl } from \"./ColorControl\";\r\nimport { DropdownListControl } from \"./DropdownListControl\";\r\nimport { IconControl, IIcon } from \"./IconControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport { AverageSeries } from \"../drawing/AverageSeries\";\r\nimport { CalloutSeries } from \"../drawing/CalloutSeries\";\r\nimport { EllipseSeries } from \"../drawing/EllipseSeries\";\r\nimport { DoodleSeries } from \"../drawing/DoodleSeries\";\r\nimport { FibonacciSeries } from \"../drawing/FibonacciSeries\";\r\nimport { FibonacciTimezoneSeries } from \"../drawing/FibonacciTimezoneSeries\";\r\nimport { HorizontalLineSeries } from \"../drawing/HorizontalLineSeries\";\r\nimport { HorizontalRaySeries } from \"../drawing/HorizontalRaySeries\";\r\nimport { IconSeries } from \"../drawing/IconSeries\";\r\nimport { LabelSeries } from \"../drawing/LabelSeries\";\r\nimport { SimpleLineSeries } from \"../drawing/SimpleLineSeries\";\r\nimport { PolylineSeries } from \"../drawing/PolylineSeries\";\r\nimport { QuadrantLineSeries } from \"../drawing/QuadrantLineSeries\";\r\nimport { RectangleSeries } from \"../drawing/RectangleSeries\";\r\nimport { RegressionSeries } from \"../drawing/RegressionSeries\";\r\nimport { TrendLineSeries } from \"../drawing/TrendLineSeries\";\r\nimport { VerticalLineSeries } from \"../drawing/VerticalLineSeries\";\r\nimport type { StockPanel } from \"../StockPanel\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $object from \"../../../core/util/Object\";\r\nimport * as $type from \"../../../core/util/Type\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IDrawingControlSettings extends IStockControlSettings {\r\n\r\n\t/**\r\n\t * List of tools available in drawing mode.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/#Tool_list} for more info\r\n\t */\r\n\ttools?: DrawingTools[];\r\n\r\n\t/**\r\n\t * Default tool.\r\n\t */\r\n\ttool?: DrawingTools,\r\n\r\n\t/**\r\n\t * Target series for drawing.\r\n\t */\r\n\tseries?: XYSeries[];\r\n\r\n\t/**\r\n\t * Colors to show in color pickers.\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/#Colors} for more info\r\n\t */\r\n\tcolors?: ColorSet;\r\n\r\n\t/**\r\n\t * Default color for lines/borders.\r\n\t */\r\n\tstrokeColor?: Color;\r\n\r\n\t/**\r\n\t * Default line/border width in pixels.\r\n\t */\r\n\tstrokeWidth?: number;\r\n\r\n\t/**\r\n\t * Available line widths for user to choose from.\r\n\t */\r\n\tstrokeWidths?: number[];\r\n\r\n\t/**\r\n\t * Default dasharray setting.\r\n\t */\r\n\tstrokeDasharray?: number[];\r\n\r\n\t/**\r\n\t * Available line dash settings for user to choose from.\r\n\t */\r\n\tstrokeDasharrays?: number[][];\r\n\r\n\t/**\r\n\t * Default line/border opacity.\r\n\t */\r\n\tstrokeOpacity?: number;\r\n\r\n\t/**\r\n\t * Show dotted/thin line extending from both ends of the drawn line?\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tshowExtension?: boolean;\r\n\r\n\t/**\r\n\t * Default fill color.\r\n\t */\r\n\tfillColor?: Color;\r\n\r\n\t/**\r\n\t * Default fill opacity.\r\n\t */\r\n\tfillOpacity?: number;\r\n\r\n\t/**\r\n\t * Default color for labels.\r\n\t */\r\n\tlabelFill?: Color;\r\n\r\n\t/**\r\n\t * Default label font size.\r\n\t */\r\n\tlabelFontSize?: number | string | undefined;\r\n\r\n\t/**\r\n\t * Available font sizes.\r\n\t */\r\n\tlabelFontSizes?: Array<number | string>;\r\n\r\n\t/**\r\n\t * Default label font.\r\n\t */\r\n\tlabelFontFamily?: string;\r\n\r\n\t/**\r\n\t * Available fonts for user to choose from.\r\n\t */\r\n\tlabelFontFamilies?: string[];\r\n\r\n\t/**\r\n\t * Default label font weight.\r\n\t */\r\n\tlabelFontWeight?: \"normal\" | \"bold\" | \"bolder\" | \"lighter\" | \"100\" | \"200\" | \"300\" | \"400\" | \"500\" | \"600\" | \"700\" | \"800\" | \"900\";\r\n\r\n\t/**\r\n\t * Default label style.\r\n\t */\r\n\tlabelFontStyle?: \"normal\" | \"italic\" | \"oblique\";\r\n\r\n\tdrawingIcon?: IIcon;\r\n\tdrawingIcons?: IIcon[];\r\n\r\n\t/**\r\n\t * Should drawings snap to the nearest data point?\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tsnapToData?: boolean;\r\n\r\n}\r\n\r\n\r\nexport interface IDrawingControlPrivate extends IStockControlPrivate {\r\n\ttoolsContainer?: HTMLDivElement;\r\n\t// icon?: HTMLElement;\r\n\t// label?: HTMLDivElement;\r\n\ttoolControl?: DrawingToolControl;\r\n\teraserControl?: StockControl;\r\n\tclearControl?: StockControl;\r\n\r\n\tstrokeControl?: ColorControl;\r\n\tstrokeWidthControl?: DropdownListControl;\r\n\tstrokeDasharrayControl?: DropdownListControl;\r\n\tfillControl?: ColorControl;\r\n\textensionControl?: StockControl;\r\n\r\n\tlabelFillControl?: ColorControl;\r\n\tlabelFontSizeControl?: DropdownListControl;\r\n\tlabelFontFamilyControl?: DropdownListControl;\r\n\tboldControl?: StockControl;\r\n\titalicControl?: StockControl;\r\n\r\n\ticonControl?: IconControl;\r\n\tsnapControl?: StockControl;\r\n}\r\n\r\nexport interface IDrawingControlEvents extends IStockControlEvents {\r\n}\r\n\r\n/**\r\n * A drawing tools control for [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/} for more info\r\n */\r\nexport class DrawingControl extends StockControl {\r\n\tpublic static className: string = \"DrawingControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DrawingControl.className]);\r\n\r\n\tdeclare public _settings: IDrawingControlSettings;\r\n\tdeclare public _privateSettings: IDrawingControlPrivate;\r\n\tdeclare public _events: IDrawingControlEvents;\r\n\r\n\tprivate _drawingSeries: { [index: string]: DrawingSeries[] } = {};\r\n\tprivate _currentEnabledSeries: DrawingSeries[] = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Init drawing toolbar\r\n\t\tif (this.getPrivate(\"toolbar\")) {\r\n\t\t\tthis._initToolbar();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\t}\r\n\r\n\tprotected _initToolbar(): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst l = this._root.language;\r\n\r\n\t\t// Add additional container for drawing toolbar\r\n\t\tconst toolbar = this.getPrivate(\"toolbar\")!;\r\n\t\tconst toolsContainer = document.createElement(\"div\");\r\n\t\ttoolsContainer.className = \"am5stock-control-drawing-tools\";\r\n\t\ttoolsContainer.style.display = \"none\";\r\n\t\tthis.setPrivate(\"toolsContainer\", toolsContainer);\r\n\t\ttoolbar.get(\"container\").appendChild(toolsContainer);\r\n\r\n\t\t/**\r\n\t\t * Drawing tool selection control\r\n\t\t */\r\n\t\tconst toolControl = DrawingToolControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Drawing tool\"),\r\n\t\t\ttools: this.get(\"tools\")!\r\n\t\t});\r\n\t\ttoolsContainer.appendChild(toolControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"toolControl\", toolControl);\r\n\r\n\t\ttoolControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"tool\", ev.tool);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Icon selection control\r\n\t\t */\r\n\t\tconst drawingIcons = this.get(\"drawingIcons\")!;\r\n\t\tconst iconControl = IconControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Arrows &amp; Icons\"),\r\n\t\t\ticons: drawingIcons\r\n\t\t});\r\n\t\ticonControl.setIcon(this.get(\"drawingIcon\", drawingIcons[0]));\r\n\t\ttoolsContainer.appendChild(iconControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"iconControl\", iconControl);\r\n\r\n\t\ticonControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"drawingIcon\", ev.icon);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Snap toggle control\r\n\t\t */\r\n\t\tconst snapControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Snap icon to data\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Snap\")\r\n\t\t});\r\n\t\tsnapControl.hide();\r\n\t\ttoolsContainer.appendChild(snapControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"snapControl\", snapControl);\r\n\t\tif (this.get(\"snapToData\")) {\r\n\t\t\tsnapControl.set(\"active\", true);\r\n\t\t}\r\n\t\tsnapControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"snapToData\", snapControl.get(\"active\") == true);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Stroke color control\r\n\t\t */\r\n\t\tconst strokeControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tdescription: l.translateAny(\"Line color\")\r\n\t\t});\r\n\t\tstrokeControl.hide();\r\n\t\tstrokeControl.setPrivate(\"color\", this.get(\"strokeColor\", color(0x000000)));\r\n\t\tstrokeControl.setPrivate(\"opacity\", this.get(\"strokeOpacity\", 1));\r\n\t\ttoolsContainer.appendChild(strokeControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeControl\", strokeControl);\r\n\t\tstrokeControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeColor\", ev.color);\r\n\t\t});\r\n\t\tstrokeControl.events.on(\"selectedOpacity\", (ev) => {\r\n\t\t\tthis.set(\"strokeOpacity\", ev.opacity);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Stroke width control\r\n\t\t */\r\n\t\tconst strokeWidths: string[] = [];\r\n\t\t$array.each(this.get(\"strokeWidths\", []), (width) => {\r\n\t\t\tstrokeWidths.push(width + \"px\");\r\n\t\t});\r\n\t\tconst strokeWidthControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Line thickness\"),\r\n\t\t\tcurrentItem: this.get(\"strokeWidth\", \"12\") + \"px\",\r\n\t\t\titems: strokeWidths\r\n\t\t});\r\n\t\tstrokeWidthControl.hide();\r\n\t\t//strokeWidthControl.setItem(this.get(\"strokeWidth\", \"12\") + \"px\");\r\n\t\tstrokeWidthControl.getPrivate(\"icon\")!.style.display = \"none\";\r\n\t\ttoolsContainer.appendChild(strokeWidthControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeWidthControl\", strokeWidthControl);\r\n\t\tstrokeWidthControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeWidth\", $type.toNumber($type.isString(ev.item) ? ev.item : ev.item.id));\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Stroke dash cofiguration control\r\n\t\t */\r\n\t\tconst strokeDasharrays: IDropdownListItem[] = [];\r\n\t\tlet currentStrokeDasharray: SVGElement | undefined;\r\n\t\tconst strokeDasharray = this.get(\"strokeDasharray\", []);\r\n\t\t$array.each(this.get(\"strokeDasharrays\", []), (dasharray) => {\r\n\t\t\tconst icon = StockIcons.getIcon(\"Dash\");\r\n\t\t\tconst id = JSON.stringify(dasharray);\r\n\t\t\ticon.setAttribute(\"stroke\", \"#000\");\r\n\t\t\ticon.setAttribute(\"stroke-dasharray\", dasharray.join(\",\"));\r\n\t\t\ticon.setAttribute(\"class\", \"am5stock-icon-wide\");\r\n\t\t\tstrokeDasharrays.push({\r\n\t\t\t\tid: id,\r\n\t\t\t\tlabel: \"\",\r\n\t\t\t\ticon: icon\r\n\t\t\t});\r\n\r\n\t\t\tif (id == JSON.stringify(strokeDasharray)) {\r\n\t\t\t\tcurrentStrokeDasharray = StockIcons.getIcon(\"Dash\");\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"stroke\", \"#000\");\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"stroke-dasharray\", dasharray.join(\",\"));\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"class\", \"am5stock-icon-wide\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst strokeDasharrayControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Line style\"),\r\n\t\t\titems: strokeDasharrays\r\n\t\t});\r\n\t\tstrokeDasharrayControl.hide();\r\n\t\tif (currentStrokeDasharray) {\r\n\t\t\tstrokeDasharrayControl.setItem({\r\n\t\t\t\tid: \"\",\r\n\t\t\t\ticon: currentStrokeDasharray,\r\n\t\t\t\tlabel: \"\"\r\n\t\t\t});\r\n\t\t}\r\n\t\tstrokeDasharrayControl.getPrivate(\"icon\")!.setAttribute(\"class\", \"am5stock-control-icon am5stock-icon-wide\")\r\n\t\ttoolsContainer.appendChild(strokeDasharrayControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeDasharrayControl\", strokeDasharrayControl);\r\n\t\tstrokeDasharrayControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeDasharray\", JSON.parse((<IDropdownListItem>ev.item).id));\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Fill color control\r\n\t\t */\r\n\t\tconst fillControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tname: l.translateAny(\"Fill\"),\r\n\t\t\tdescription: l.translateAny(\"Fill color\"),\r\n\t\t});\r\n\t\tfillControl.hide();\r\n\t\tfillControl.setPrivate(\"color\", this.get(\"fillColor\", color(0x000000)));\r\n\t\tfillControl.setPrivate(\"opacity\", this.get(\"fillOpacity\", 1));\r\n\t\ttoolsContainer.appendChild(fillControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"fillControl\", fillControl);\r\n\t\tfillControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"fillColor\", ev.color);\r\n\t\t});\r\n\t\tfillControl.events.on(\"selectedOpacity\", (ev) => {\r\n\t\t\tthis.set(\"fillOpacity\", ev.opacity);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Label color control\r\n\t\t */\r\n\t\tconst labelFillControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tname: l.translateAny(\"Text\"),\r\n\t\t\tdescription: l.translateAny(\"Text color\"),\r\n\t\t\tuseOpacity: false\r\n\t\t});\r\n\t\tlabelFillControl.hide();\r\n\t\tlabelFillControl.setPrivate(\"color\", this.get(\"labelFill\", color(0x000000)));\r\n\t\ttoolsContainer.appendChild(labelFillControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFillControl\", labelFillControl);\r\n\t\tlabelFillControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFill\", ev.color);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Font size control\r\n\t\t */\r\n\t\tconst fontSizes: string[] = [];\r\n\t\t$array.each(this.get(\"labelFontSizes\", []), (size) => {\r\n\t\t\tfontSizes.push(size + \"\");\r\n\t\t});\r\n\t\tconst fontSizeControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Label font size\"),\r\n\t\t\tcurrentItem: this.get(\"labelFontSize\", \"12px\") + \"\",\r\n\t\t\titems: fontSizes,\r\n\t\t});\r\n\t\tfontSizeControl.hide();\r\n\t\t//fontSizeControl.setItem(this.get(\"labelFontSize\", \"12px\") + \"\");\r\n\t\ttoolsContainer.appendChild(fontSizeControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFontSizeControl\", fontSizeControl);\r\n\t\tfontSizeControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFontSize\", $type.isString(ev.item) ? ev.item : ev.item.id);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Bold control\r\n\t\t */\r\n\t\tconst boldControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Bold\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Bold\")\r\n\t\t});\r\n\t\tboldControl.hide();\r\n\t\ttoolsContainer.appendChild(boldControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"boldControl\", boldControl);\r\n\t\tboldControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"labelFontWeight\", boldControl.get(\"active\") ? \"bold\" : \"normal\");\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Italic control\r\n\t\t */\r\n\t\tconst italicControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Italic\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Italic\")\r\n\t\t});\r\n\t\titalicControl.hide();\r\n\t\ttoolsContainer.appendChild(italicControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"italicControl\", italicControl);\r\n\t\titalicControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"labelFontStyle\", italicControl.get(\"active\") ? \"italic\" : \"normal\");\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Font family control\r\n\t\t */\r\n\t\tconst fontFamilies: string[] = [];\r\n\t\t$array.each(this.get(\"labelFontFamilies\", []), (size) => {\r\n\t\t\tfontFamilies.push(size + \"\");\r\n\t\t});\r\n\t\tconst fontFamilyControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Label font family\"),\r\n\t\t\tcurrentItem: this.get(\"labelFontFamily\", \"Arial\"),\r\n\t\t\titems: fontFamilies,\r\n\t\t});\r\n\t\tfontFamilyControl.hide();\r\n\t\ttoolsContainer.appendChild(fontFamilyControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFontFamilyControl\", fontFamilyControl);\r\n\t\tfontFamilyControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFontFamily\", $type.isString(ev.item) ? ev.item : ev.item.id);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Line extension control\r\n\t\t */\r\n\t\tconst extensionControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Show line extension\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Show Extension\")\r\n\t\t});\r\n\t\textensionControl.hide();\r\n\t\ttoolsContainer.appendChild(extensionControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"extensionControl\", extensionControl);\r\n\t\tif (this.get(\"showExtension\")) {\r\n\t\t\textensionControl.set(\"active\", true);\r\n\t\t}\r\n\t\textensionControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"showExtension\", extensionControl.get(\"active\") == true);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Eraser control\r\n\t\t */\r\n\t\tconst eraserControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Eraser\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Eraser\")\r\n\t\t});\r\n\t\ttoolsContainer.appendChild(eraserControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"eraserControl\", eraserControl);\r\n\t\teraserControl.on(\"active\", (_ev) => {\r\n\t\t\tconst active = eraserControl.get(\"active\");\r\n\t\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\t\tif (active) {\r\n\t\t\t\t\t\tseries.enableErasing();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tseries.disableErasing();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Clear all drawings control\r\n\t\t */\r\n\t\tconst clearControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tname: l.translateAny(\"Clear\"),\r\n\t\t\tdescription: l.translateAny(\"Clear all drawings\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Clear\"),\r\n\t\t\ttogglable: false\r\n\t\t});\r\n\t\ttoolsContainer.appendChild(clearControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"clearControl\", clearControl);\r\n\t\tthis._disposers.push($utils.addEventListener(clearControl.getPrivate(\"button\")!, \"click\", (_ev) => {\r\n\t\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\t\tseries.clearDrawings();\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t}));\r\n\r\n\t\t// Preset active tool\r\n\t\tif (this.get(\"active\")) {\r\n\t\t\tthis._setTool(this.get(\"tool\"));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"tools\")) {\r\n\t\t\tconst toolControl = this.getPrivate(\"toolControl\");\r\n\t\t\tif (toolControl) {\r\n\t\t\t\ttoolControl.set(\"tools\", this.get(\"tools\")!);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isPrivateDirty(\"toolbar\")) {\r\n\t\t\tif (this.getPrivate(\"toolbar\")) {\r\n\t\t\t\tthis._initToolbar();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"active\")) {\r\n\t\t\tif (this.get(\"active\")) {\r\n\t\t\t\tthis.getPrivate(\"toolsContainer\")!.style.display = \"block\";\r\n\t\t\t\tthis._setTool(this.get(\"tool\"));\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.getPrivate(\"toolsContainer\")!.style.display = \"none\";\r\n\t\t\t\tthis._setTool();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"tool\") && this.get(\"active\")) {\r\n\t\t\tthis._setTool(this.get(\"tool\"));\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"strokeColor\") || this.isDirty(\"strokeWidth\") || this.isDirty(\"strokeOpacity\") || this.isDirty(\"strokeDasharray\")) {\r\n\t\t\tthis._setStroke();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"fillColor\") || this.isDirty(\"fillOpacity\")) {\r\n\t\t\tthis._setFill();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"labelFill\") || this.isDirty(\"labelFontSize\") || this.isDirty(\"labelFontFamily\") || this.isDirty(\"labelFontWeight\") || this.isDirty(\"labelFontStyle\")) {\r\n\t\t\tthis._setLabel();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"showExtension\")) {\r\n\t\t\tthis._setExtension();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"drawingIcon\")) {\r\n\t\t\tthis._setDrawingIcon();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"snapToData\")) {\r\n\t\t\tthis._setSnap();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setTool(tool?: DrawingTools): void {\r\n\t\t// Disable current drawing series\r\n\t\t$array.each(this._currentEnabledSeries, (series) => {\r\n\t\t\tseries.disableDrawing();\r\n\t\t});\r\n\t\tthis._currentEnabledSeries = [];\r\n\r\n\t\t// Disable editing\r\n\t\tif (!tool) {\r\n\t\t\tthis.getPrivate(\"eraserControl\")!.set(\"active\", false);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Check if we need to create series\r\n\t\tlet seriesList = this._drawingSeries[tool];\r\n\t\tif (!seriesList) {\r\n\r\n\t\t\t// Get target series\r\n\t\t\tconst chartSeries: XYSeries[] = this.get(\"series\", []);\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tif (chartSeries.length == 0) {\r\n\t\t\t\t// No target series set, take first series out of each chart\r\n\t\t\t\tstockChart.panels.each((panel) => {\r\n\t\t\t\t\tif (panel.series.length > 0) {\r\n\t\t\t\t\t\tchartSeries.push(panel.series.getIndex(0)!);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Populate the list\r\n\t\t\tseriesList = [];\r\n\t\t\t$array.each(chartSeries, (chartSeries) => {\r\n\t\t\t\tlet series: DrawingSeries | undefined;\r\n\t\t\t\tconst xAxis = <any>chartSeries.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = <any>chartSeries.get(\"yAxis\");\r\n\t\t\t\tconst panel = chartSeries.chart! as StockPanel;\r\n\t\t\t\tswitch (tool) {\r\n\t\t\t\t\tcase \"Average\":\r\n\t\t\t\t\t\tseries = AverageSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfield: \"value\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Callout\":\r\n\t\t\t\t\t\tseries = CalloutSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Doodle\":\r\n\t\t\t\t\t\tseries = DoodleSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Ellipse\":\r\n\t\t\t\t\t\tseries = EllipseSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Fibonacci\":\r\n\t\t\t\t\t\tseries = FibonacciSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Fibonacci Timezone\":\r\n\t\t\t\t\t\tseries = FibonacciTimezoneSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase \"Horizontal Line\":\r\n\t\t\t\t\t\tseries = HorizontalLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Horizontal Ray\":\r\n\t\t\t\t\t\tseries = HorizontalRaySeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfield: \"value\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Arrows &amp; Icons\":\r\n\t\t\t\t\t\tconst icon = this.get(\"drawingIcon\", this.get(\"drawingIcons\")![0]);\r\n\t\t\t\t\t\tseries = IconSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\ticonSvgPath: icon.svgPath,\r\n\t\t\t\t\t\t\ticonScale: icon.scale,\r\n\t\t\t\t\t\t\ticonCenterX: icon.centerX,\r\n\t\t\t\t\t\t\ticonCenterY: icon.centerY,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Label\":\r\n\t\t\t\t\t\tseries = LabelSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Line\":\r\n\t\t\t\t\t\tseries = SimpleLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Polyline\":\r\n\t\t\t\t\t\tseries = PolylineSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Quadrant Line\":\r\n\t\t\t\t\t\tseries = QuadrantLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfield: \"value\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rectangle\":\r\n\t\t\t\t\t\tseries = RectangleSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Regression\":\r\n\t\t\t\t\t\tseries = RegressionSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfield: \"value\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Trend Line\":\r\n\t\t\t\t\t\tseries = TrendLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfield: \"value\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Vertical Line\":\r\n\t\t\t\t\t\tseries = VerticalLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (series) {\r\n\t\t\t\t\tseriesList.push(series);\r\n\t\t\t\t\tpanel.drawings.push(series);\r\n\t\t\t\t\tseries.setPrivate(\"baseValueSeries\", chartSeries);\r\n\t\t\t\t\tseries.set(\"valueYShow\", chartSeries.get(\"valueYShow\"));\r\n\t\t\t\t\tseries.set(\"calculateAggregates\", true);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis._drawingSeries[tool] = seriesList;\r\n\r\n\t\t\tthis._setStroke();\r\n\t\t\tthis._setFill();\r\n\t\t}\r\n\r\n\t\t$array.each(seriesList, (series) => {\r\n\t\t\tseries.enableDrawing();\r\n\t\t\tthis._currentEnabledSeries.push(series);\r\n\t\t});\r\n\r\n\t\tthis.getPrivate(\"toolControl\")!.setTool(tool);\r\n\r\n\t\t// Show/hide needed drawing property controls\r\n\t\tconst controls: any = {\r\n\t\t\tstrokeControl: [\"Average\", \"Callout\", \"Doodle\", \"Ellipse\", \"Fibonacci\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Line\", \"Polyline\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"],\r\n\t\t\tstrokeWidthControl: [\"Average\", \"Doodle\", \"Ellipse\", \"Horizontal Line\", \"Horizontal Ray\", \"Line\", \"Polyline\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"],\r\n\t\t\tstrokeDasharrayControl: [\"Average\", \"Doodle\", \"Ellipse\", \"Horizontal Line\", \"Horizontal Ray\", \"Line\", \"Polyline\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"],\r\n\t\t\textensionControl: [\"Average\", \"Line\", \"Regression\", \"Trend Line\"],\r\n\t\t\tfillControl: [\"Callout\", \"Ellipse\", \"Quadrant Line\", \"Rectangle\", \"Arrows &amp; Icons\"],\r\n\r\n\t\t\tlabelFillControl: [\"Callout\", \"Label\"],\r\n\t\t\tlabelFontSizeControl: [\"Callout\", \"Label\"],\r\n\t\t\tlabelFontFamilyControl: [\"Callout\", \"Label\"],\r\n\t\t\tboldControl: [\"Callout\", \"Label\"],\r\n\t\t\titalicControl: [\"Callout\", \"Label\"],\r\n\r\n\t\t\ticonControl: [\"Arrows &amp; Icons\"],\r\n\t\t\tsnapControl: [\"Callout\", \"Arrows &amp; Icons\"],\r\n\t\t}\r\n\r\n\t\t$object.each(controls, (control, tools) => {\r\n\t\t\tconst controlElement = (<any>this).getPrivate(control);\r\n\t\t\tif (tools.indexOf(tool) == -1) {\r\n\t\t\t\tcontrolElement.hide();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcontrolElement.show();\r\n\t\t\t}\r\n\t\t\t//controlElement!.getPrivate(\"button\").style.display = tools.indexOf(tool) == -1 ? \"none\" : \"\";\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _setStroke(): void {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tseries.setAll({\r\n\t\t\t\t\tstrokeColor: this.get(\"strokeColor\"),\r\n\t\t\t\t\tstrokeWidth: this.get(\"strokeWidth\"),\r\n\t\t\t\t\tstrokeOpacity: this.get(\"strokeOpacity\"),\r\n\t\t\t\t\tstrokeDasharray: this.get(\"strokeDasharray\"),\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setFill(): void {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tseries.setAll({\r\n\t\t\t\t\tfillColor: this.get(\"fillColor\"),\r\n\t\t\t\t\tfillOpacity: this.get(\"fillOpacity\")\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setLabel(): void {\r\n\t\tconst labelTools = [\"Callout\", \"Label\"];\r\n\t\t$object.each(this._drawingSeries, (tool, seriesList) => {\r\n\t\t\tif (labelTools.indexOf(<string>tool) != -1) {\r\n\t\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\t\t(<LabelSeries>series).setAll({\r\n\t\t\t\t\t\tlabelFill: this.get(\"labelFill\"),\r\n\t\t\t\t\t\tlabelFontSize: this.get(\"labelFontSize\"),\r\n\t\t\t\t\t\tlabelFontFamily: this.get(\"labelFontFamily\"),\r\n\t\t\t\t\t\tlabelFontWeight: this.get(\"labelFontWeight\"),\r\n\t\t\t\t\t\tlabelFontStyle: this.get(\"labelFontStyle\")\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setExtension(): void {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series instanceof SimpleLineSeries) {\r\n\t\t\t\t\tseries.setAll({\r\n\t\t\t\t\t\tshowExtension: this.get(\"showExtension\")\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setDrawingIcon(): void {\r\n\t\tconst icon = this.get(\"drawingIcon\", this.get(\"drawingIcons\")![0]);\r\n\t\tconst fillControl = this.getPrivate(\"fillControl\")!;\r\n\t\tif (icon.fillDisabled) {\r\n\t\t\tfillControl.hide();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfillControl.show();\r\n\t\t}\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series instanceof IconSeries) {\r\n\t\t\t\t\tseries.setAll({\r\n\t\t\t\t\t\ticonSvgPath: icon.svgPath,\r\n\t\t\t\t\t\ticonScale: icon.scale,\r\n\t\t\t\t\t\ticonCenterX: icon.centerX,\r\n\t\t\t\t\t\ticonCenterY: icon.centerY,\r\n\t\t\t\t\t\tfillOpacity: icon.fillDisabled ? 0 : this.get(\"fillOpacity\")\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setSnap(): void {\r\n\t\tconst snap = this.get(\"snapToData\", false);\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series instanceof IconSeries || series instanceof CalloutSeries) {\r\n\t\t\t\t\tseries.setAll({\r\n\t\t\t\t\t\tsnapToData: snap\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Draw\");\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\r\n}\r\n","import type { Indicator } from \"../indicators/Indicator\";\r\nimport type { StockLegend } from \"../StockLegend\";\r\n\r\nimport { AccumulationDistribution } from \"../indicators/AccumulationDistribution\";\r\nimport { AccumulativeSwingIndex } from \"../indicators/AccumulativeSwingIndex\";\r\nimport { Aroon } from \"../indicators/Aroon\";\r\nimport { AwesomeOscillator } from \"../indicators/AwesomeOscillator\";\r\nimport { BollingerBands } from \"../indicators/BollingerBands\";\r\nimport { ChaikinMoneyFlow } from \"../indicators/ChaikinMoneyFlow\";\r\nimport { ChaikinOscillator } from \"../indicators/ChaikinOscillator\";\r\nimport { CommodityChannelIndex } from \"../indicators/CommodityChannelIndex\";\r\nimport { DisparityIndex } from \"../indicators/DisparityIndex\";\r\nimport { MACD } from \"../indicators/MACD\";\r\nimport { MovingAverage } from \"../indicators/MovingAverage\";\r\nimport { MovingAverageDeviation } from \"../indicators/MovingAverageDeviation\";\r\nimport { MovingAverageEnvelope } from \"../indicators/MovingAverageEnvelope\";\r\nimport { OnBalanceVolume } from \"../indicators/OnBalanceVolume\";\r\nimport { RelativeStrengthIndex } from \"../indicators/RelativeStrengthIndex\";\r\nimport { StochasticOscillator } from \"../indicators/StochasticOscillator\";\r\nimport { WilliamsR } from \"../indicators/WilliamsR\";\r\nimport { Volume } from \"../indicators/Volume\";\r\n\r\n\r\n//import type { IDisposer } from \"../../../core/util/Disposer\";\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport type Indicators = \"Accumulation Distribution\" | \"Accumulative Swing Index\" | \"Aroon\" | \"Awesome Oscillator\" | \"Bollinger Bands\" | \"Chaikin Money Flow\" | \"Chaikin Oscillator\" | \"Commodity Channel Index\" | \"Disparity Index\" | \"MACD\" | \"Moving Average\" | \"Moving Average Deviation\" | \"Moving Average Envelope\" | \"On Balance Volume\" | \"Relative Strength Index\" | \"Stochastic Oscillator\" | \"Volume\" | \"Williams R\";\r\n\r\nexport interface IIndicatorControlSettings extends IStockControlSettings {\r\n\tindicators?: Indicators[];\r\n\tlegend?: StockLegend;\r\n}\r\n\r\nexport interface IIndicatorControlPrivate extends IStockControlPrivate {\r\n\tlist?: DropdownList;\r\n}\r\n\r\nexport interface IIndicatorControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\tindicator: Indicators\r\n\t}\r\n}\r\n\r\n/**\r\n * A [[StockToolbar]] control for adding indicators to a [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/indicator-control/} for more info\r\n */\r\nexport class IndicatorControl extends StockControl {\r\n\tpublic static className: string = \"IndicatorControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([IndicatorControl.className]);\r\n\r\n\tdeclare public _settings: IIndicatorControlSettings;\r\n\tdeclare public _privateSettings: IIndicatorControlPrivate;\r\n\tdeclare public _events: IIndicatorControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst list = DropdownList.new(this._root, {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\")\r\n\t\t});\r\n\t\tthis.setPrivate(\"list\", list);\r\n\r\n\t\tlist.events.on(\"invoked\", (ev) => {\r\n\t\t\tthis.addIndicator(<Indicators>ev.item.id);\r\n\t\t});\r\n\r\n\t\tlist.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => list.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlist.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\r\n\t\tthis._initList();\r\n\t}\r\n\r\n\tprotected _initList(): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst indicators = this.get(\"indicators\")!;\r\n\t\tconst items: IDropdownListItem[] = [];\r\n\t\t$array.each(indicators, (indicator: Indicators) => {\r\n\t\t\titems.push({\r\n\t\t\t\tid: indicator,\r\n\t\t\t\tlabel: this._root.language.translateAny(indicator)\r\n\t\t\t});\r\n\t\t})\r\n\t\tlist.set(\"items\", items);\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Indicator\");\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\t\tif (this.isDirty(\"indicators\")) {\r\n\t\t\tthis._initList();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addIndicator(indicatorId: Indicators): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tlet indicator: Indicator | undefined;\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\")!;\r\n\t\tconst volumeSeries = stockChart.get(\"volumeSeries\")!;\r\n\t\tconst legend = this.get(\"legend\");\r\n\r\n\t\tswitch (indicatorId) {\r\n\t\t\tcase \"Accumulation Distribution\":\r\n\t\t\t\tindicator = AccumulationDistribution.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Accumulative Swing Index\":\r\n\t\t\t\tindicator = AccumulativeSwingIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Aroon\":\r\n\t\t\t\tindicator = Aroon.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Awesome Oscillator\":\r\n\t\t\t\tindicator = AwesomeOscillator.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Bollinger Bands\":\r\n\t\t\t\tindicator = BollingerBands.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Chaikin Money Flow\":\r\n\t\t\t\tindicator = ChaikinMoneyFlow.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Chaikin Oscillator\":\r\n\t\t\t\tindicator = ChaikinOscillator.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Commodity Channel Index\":\r\n\t\t\t\tindicator = CommodityChannelIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Disparity Index\":\r\n\t\t\t\tindicator = DisparityIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"MACD\":\r\n\t\t\t\tindicator = MACD.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Moving Average\":\r\n\t\t\t\tindicator = MovingAverage.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Moving Average Deviation\":\r\n\t\t\t\tindicator = MovingAverageDeviation.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Moving Average Envelope\":\r\n\t\t\t\tindicator = MovingAverageEnvelope.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"On Balance Volume\":\r\n\t\t\t\tindicator = OnBalanceVolume.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Relative Strength Index\":\r\n\t\t\t\tindicator = RelativeStrengthIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Stochastic Oscillator\":\r\n\t\t\t\tindicator = StochasticOscillator.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Williams R\":\r\n\t\t\t\tindicator = WilliamsR.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Volume\":\r\n\t\t\t\tindicator = Volume.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (indicator) {\r\n\t\t\tstockChart.indicators.push(indicator);\r\n\t\t\tif (indicator._editableSettings.length) {\r\n\t\t\t\tconst modal = stockChart.getPrivate(\"settingsModal\");\r\n\t\t\t\tmodal.events.once(\"done\", (ev) => {\r\n\t\t\t\t\tif (indicator) {\r\n\t\t\t\t\t\tif (!ev.settings) {\r\n\t\t\t\t\t\t\tindicator.dispose();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tmodal.openIndicator(indicator);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}","export var HOOKS = [\n    \"onChange\",\n    \"onClose\",\n    \"onDayCreate\",\n    \"onDestroy\",\n    \"onKeyDown\",\n    \"onMonthChange\",\n    \"onOpen\",\n    \"onParseConfig\",\n    \"onReady\",\n    \"onValueUpdate\",\n    \"onYearChange\",\n    \"onPreCalendarPosition\",\n];\nexport var defaults = {\n    _disable: [],\n    allowInput: false,\n    allowInvalidPreload: false,\n    altFormat: \"F j, Y\",\n    altInput: false,\n    altInputClass: \"form-control input\",\n    animate: typeof window === \"object\" &&\n        window.navigator.userAgent.indexOf(\"MSIE\") === -1,\n    ariaDateFormat: \"F j, Y\",\n    autoFillDefaultTime: true,\n    clickOpens: true,\n    closeOnSelect: true,\n    conjunction: \", \",\n    dateFormat: \"Y-m-d\",\n    defaultHour: 12,\n    defaultMinute: 0,\n    defaultSeconds: 0,\n    disable: [],\n    disableMobile: false,\n    enableSeconds: false,\n    enableTime: false,\n    errorHandler: function (err) {\n        return typeof console !== \"undefined\" && console.warn(err);\n    },\n    getWeek: function (givenDate) {\n        var date = new Date(givenDate.getTime());\n        date.setHours(0, 0, 0, 0);\n        date.setDate(date.getDate() + 3 - ((date.getDay() + 6) % 7));\n        var week1 = new Date(date.getFullYear(), 0, 4);\n        return (1 +\n            Math.round(((date.getTime() - week1.getTime()) / 86400000 -\n                3 +\n                ((week1.getDay() + 6) % 7)) /\n                7));\n    },\n    hourIncrement: 1,\n    ignoredFocusElements: [],\n    inline: false,\n    locale: \"default\",\n    minuteIncrement: 5,\n    mode: \"single\",\n    monthSelectorType: \"dropdown\",\n    nextArrow: \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>\",\n    noCalendar: false,\n    now: new Date(),\n    onChange: [],\n    onClose: [],\n    onDayCreate: [],\n    onDestroy: [],\n    onKeyDown: [],\n    onMonthChange: [],\n    onOpen: [],\n    onParseConfig: [],\n    onReady: [],\n    onValueUpdate: [],\n    onYearChange: [],\n    onPreCalendarPosition: [],\n    plugins: [],\n    position: \"auto\",\n    positionElement: undefined,\n    prevArrow: \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>\",\n    shorthandCurrentMonth: false,\n    showMonths: 1,\n    static: false,\n    time_24hr: false,\n    weekNumbers: false,\n    wrap: false,\n};\n","export var english = {\n    weekdays: {\n        shorthand: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n        longhand: [\n            \"Sunday\",\n            \"Monday\",\n            \"Tuesday\",\n            \"Wednesday\",\n            \"Thursday\",\n            \"Friday\",\n            \"Saturday\",\n        ],\n    },\n    months: {\n        shorthand: [\n            \"Jan\",\n            \"Feb\",\n            \"Mar\",\n            \"Apr\",\n            \"May\",\n            \"Jun\",\n            \"Jul\",\n            \"Aug\",\n            \"Sep\",\n            \"Oct\",\n            \"Nov\",\n            \"Dec\",\n        ],\n        longhand: [\n            \"January\",\n            \"February\",\n            \"March\",\n            \"April\",\n            \"May\",\n            \"June\",\n            \"July\",\n            \"August\",\n            \"September\",\n            \"October\",\n            \"November\",\n            \"December\",\n        ],\n    },\n    daysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],\n    firstDayOfWeek: 0,\n    ordinal: function (nth) {\n        var s = nth % 100;\n        if (s > 3 && s < 21)\n            return \"th\";\n        switch (s % 10) {\n            case 1:\n                return \"st\";\n            case 2:\n                return \"nd\";\n            case 3:\n                return \"rd\";\n            default:\n                return \"th\";\n        }\n    },\n    rangeSeparator: \" to \",\n    weekAbbreviation: \"Wk\",\n    scrollTitle: \"Scroll to increment\",\n    toggleTitle: \"Click to toggle\",\n    amPM: [\"AM\", \"PM\"],\n    yearAriaLabel: \"Year\",\n    monthAriaLabel: \"Month\",\n    hourAriaLabel: \"Hour\",\n    minuteAriaLabel: \"Minute\",\n    time_24hr: false,\n};\nexport default english;\n","export var pad = function (number, length) {\n    if (length === void 0) { length = 2; }\n    return (\"000\" + number).slice(length * -1);\n};\nexport var int = function (bool) { return (bool === true ? 1 : 0); };\nexport function debounce(fn, wait) {\n    var t;\n    return function () {\n        var _this = this;\n        var args = arguments;\n        clearTimeout(t);\n        t = setTimeout(function () { return fn.apply(_this, args); }, wait);\n    };\n}\nexport var arrayify = function (obj) {\n    return obj instanceof Array ? obj : [obj];\n};\n","export function toggleClass(elem, className, bool) {\n    if (bool === true)\n        return elem.classList.add(className);\n    elem.classList.remove(className);\n}\nexport function createElement(tag, className, content) {\n    var e = window.document.createElement(tag);\n    className = className || \"\";\n    content = content || \"\";\n    e.className = className;\n    if (content !== undefined)\n        e.textContent = content;\n    return e;\n}\nexport function clearNode(node) {\n    while (node.firstChild)\n        node.removeChild(node.firstChild);\n}\nexport function findParent(node, condition) {\n    if (condition(node))\n        return node;\n    else if (node.parentNode)\n        return findParent(node.parentNode, condition);\n    return undefined;\n}\nexport function createNumberInput(inputClassName, opts) {\n    var wrapper = createElement(\"div\", \"numInputWrapper\"), numInput = createElement(\"input\", \"numInput \" + inputClassName), arrowUp = createElement(\"span\", \"arrowUp\"), arrowDown = createElement(\"span\", \"arrowDown\");\n    if (navigator.userAgent.indexOf(\"MSIE 9.0\") === -1) {\n        numInput.type = \"number\";\n    }\n    else {\n        numInput.type = \"text\";\n        numInput.pattern = \"\\\\d*\";\n    }\n    if (opts !== undefined)\n        for (var key in opts)\n            numInput.setAttribute(key, opts[key]);\n    wrapper.appendChild(numInput);\n    wrapper.appendChild(arrowUp);\n    wrapper.appendChild(arrowDown);\n    return wrapper;\n}\nexport function getEventTarget(event) {\n    try {\n        if (typeof event.composedPath === \"function\") {\n            var path = event.composedPath();\n            return path[0];\n        }\n        return event.target;\n    }\n    catch (error) {\n        return event.target;\n    }\n}\n","import { int, pad } from \"../utils\";\nvar doNothing = function () { return undefined; };\nexport var monthToStr = function (monthNumber, shorthand, locale) { return locale.months[shorthand ? \"shorthand\" : \"longhand\"][monthNumber]; };\nexport var revFormat = {\n    D: doNothing,\n    F: function (dateObj, monthName, locale) {\n        dateObj.setMonth(locale.months.longhand.indexOf(monthName));\n    },\n    G: function (dateObj, hour) {\n        dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));\n    },\n    H: function (dateObj, hour) {\n        dateObj.setHours(parseFloat(hour));\n    },\n    J: function (dateObj, day) {\n        dateObj.setDate(parseFloat(day));\n    },\n    K: function (dateObj, amPM, locale) {\n        dateObj.setHours((dateObj.getHours() % 12) +\n            12 * int(new RegExp(locale.amPM[1], \"i\").test(amPM)));\n    },\n    M: function (dateObj, shortMonth, locale) {\n        dateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));\n    },\n    S: function (dateObj, seconds) {\n        dateObj.setSeconds(parseFloat(seconds));\n    },\n    U: function (_, unixSeconds) { return new Date(parseFloat(unixSeconds) * 1000); },\n    W: function (dateObj, weekNum, locale) {\n        var weekNumber = parseInt(weekNum);\n        var date = new Date(dateObj.getFullYear(), 0, 2 + (weekNumber - 1) * 7, 0, 0, 0, 0);\n        date.setDate(date.getDate() - date.getDay() + locale.firstDayOfWeek);\n        return date;\n    },\n    Y: function (dateObj, year) {\n        dateObj.setFullYear(parseFloat(year));\n    },\n    Z: function (_, ISODate) { return new Date(ISODate); },\n    d: function (dateObj, day) {\n        dateObj.setDate(parseFloat(day));\n    },\n    h: function (dateObj, hour) {\n        dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));\n    },\n    i: function (dateObj, minutes) {\n        dateObj.setMinutes(parseFloat(minutes));\n    },\n    j: function (dateObj, day) {\n        dateObj.setDate(parseFloat(day));\n    },\n    l: doNothing,\n    m: function (dateObj, month) {\n        dateObj.setMonth(parseFloat(month) - 1);\n    },\n    n: function (dateObj, month) {\n        dateObj.setMonth(parseFloat(month) - 1);\n    },\n    s: function (dateObj, seconds) {\n        dateObj.setSeconds(parseFloat(seconds));\n    },\n    u: function (_, unixMillSeconds) {\n        return new Date(parseFloat(unixMillSeconds));\n    },\n    w: doNothing,\n    y: function (dateObj, year) {\n        dateObj.setFullYear(2000 + parseFloat(year));\n    },\n};\nexport var tokenRegex = {\n    D: \"\",\n    F: \"\",\n    G: \"(\\\\d\\\\d|\\\\d)\",\n    H: \"(\\\\d\\\\d|\\\\d)\",\n    J: \"(\\\\d\\\\d|\\\\d)\\\\w+\",\n    K: \"\",\n    M: \"\",\n    S: \"(\\\\d\\\\d|\\\\d)\",\n    U: \"(.+)\",\n    W: \"(\\\\d\\\\d|\\\\d)\",\n    Y: \"(\\\\d{4})\",\n    Z: \"(.+)\",\n    d: \"(\\\\d\\\\d|\\\\d)\",\n    h: \"(\\\\d\\\\d|\\\\d)\",\n    i: \"(\\\\d\\\\d|\\\\d)\",\n    j: \"(\\\\d\\\\d|\\\\d)\",\n    l: \"\",\n    m: \"(\\\\d\\\\d|\\\\d)\",\n    n: \"(\\\\d\\\\d|\\\\d)\",\n    s: \"(\\\\d\\\\d|\\\\d)\",\n    u: \"(.+)\",\n    w: \"(\\\\d\\\\d|\\\\d)\",\n    y: \"(\\\\d{2})\",\n};\nexport var formats = {\n    Z: function (date) { return date.toISOString(); },\n    D: function (date, locale, options) {\n        return locale.weekdays.shorthand[formats.w(date, locale, options)];\n    },\n    F: function (date, locale, options) {\n        return monthToStr(formats.n(date, locale, options) - 1, false, locale);\n    },\n    G: function (date, locale, options) {\n        return pad(formats.h(date, locale, options));\n    },\n    H: function (date) { return pad(date.getHours()); },\n    J: function (date, locale) {\n        return locale.ordinal !== undefined\n            ? date.getDate() + locale.ordinal(date.getDate())\n            : date.getDate();\n    },\n    K: function (date, locale) { return locale.amPM[int(date.getHours() > 11)]; },\n    M: function (date, locale) {\n        return monthToStr(date.getMonth(), true, locale);\n    },\n    S: function (date) { return pad(date.getSeconds()); },\n    U: function (date) { return date.getTime() / 1000; },\n    W: function (date, _, options) {\n        return options.getWeek(date);\n    },\n    Y: function (date) { return pad(date.getFullYear(), 4); },\n    d: function (date) { return pad(date.getDate()); },\n    h: function (date) { return (date.getHours() % 12 ? date.getHours() % 12 : 12); },\n    i: function (date) { return pad(date.getMinutes()); },\n    j: function (date) { return date.getDate(); },\n    l: function (date, locale) {\n        return locale.weekdays.longhand[date.getDay()];\n    },\n    m: function (date) { return pad(date.getMonth() + 1); },\n    n: function (date) { return date.getMonth() + 1; },\n    s: function (date) { return date.getSeconds(); },\n    u: function (date) { return date.getTime(); },\n    w: function (date) { return date.getDay(); },\n    y: function (date) { return String(date.getFullYear()).substring(2); },\n};\n","import { tokenRegex, revFormat, formats, } from \"./formatting\";\nimport { defaults } from \"../types/options\";\nimport { english } from \"../l10n/default\";\nexport var createDateFormatter = function (_a) {\n    var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c, _d = _a.isMobile, isMobile = _d === void 0 ? false : _d;\n    return function (dateObj, frmt, overrideLocale) {\n        var locale = overrideLocale || l10n;\n        if (config.formatDate !== undefined && !isMobile) {\n            return config.formatDate(dateObj, frmt, locale);\n        }\n        return frmt\n            .split(\"\")\n            .map(function (c, i, arr) {\n            return formats[c] && arr[i - 1] !== \"\\\\\"\n                ? formats[c](dateObj, locale, config)\n                : c !== \"\\\\\"\n                    ? c\n                    : \"\";\n        })\n            .join(\"\");\n    };\n};\nexport var createDateParser = function (_a) {\n    var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c;\n    return function (date, givenFormat, timeless, customLocale) {\n        if (date !== 0 && !date)\n            return undefined;\n        var locale = customLocale || l10n;\n        var parsedDate;\n        var dateOrig = date;\n        if (date instanceof Date)\n            parsedDate = new Date(date.getTime());\n        else if (typeof date !== \"string\" &&\n            date.toFixed !== undefined)\n            parsedDate = new Date(date);\n        else if (typeof date === \"string\") {\n            var format = givenFormat || (config || defaults).dateFormat;\n            var datestr = String(date).trim();\n            if (datestr === \"today\") {\n                parsedDate = new Date();\n                timeless = true;\n            }\n            else if (config && config.parseDate) {\n                parsedDate = config.parseDate(date, format);\n            }\n            else if (/Z$/.test(datestr) ||\n                /GMT$/.test(datestr)) {\n                parsedDate = new Date(date);\n            }\n            else {\n                var matched = void 0, ops = [];\n                for (var i = 0, matchIndex = 0, regexStr = \"\"; i < format.length; i++) {\n                    var token = format[i];\n                    var isBackSlash = token === \"\\\\\";\n                    var escaped = format[i - 1] === \"\\\\\" || isBackSlash;\n                    if (tokenRegex[token] && !escaped) {\n                        regexStr += tokenRegex[token];\n                        var match = new RegExp(regexStr).exec(date);\n                        if (match && (matched = true)) {\n                            ops[token !== \"Y\" ? \"push\" : \"unshift\"]({\n                                fn: revFormat[token],\n                                val: match[++matchIndex],\n                            });\n                        }\n                    }\n                    else if (!isBackSlash)\n                        regexStr += \".\";\n                }\n                parsedDate =\n                    !config || !config.noCalendar\n                        ? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0)\n                        : new Date(new Date().setHours(0, 0, 0, 0));\n                ops.forEach(function (_a) {\n                    var fn = _a.fn, val = _a.val;\n                    return (parsedDate = fn(parsedDate, val, locale) || parsedDate);\n                });\n                parsedDate = matched ? parsedDate : undefined;\n            }\n        }\n        if (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {\n            config.errorHandler(new Error(\"Invalid date provided: \" + dateOrig));\n            return undefined;\n        }\n        if (timeless === true)\n            parsedDate.setHours(0, 0, 0, 0);\n        return parsedDate;\n    };\n};\nexport function compareDates(date1, date2, timeless) {\n    if (timeless === void 0) { timeless = true; }\n    if (timeless !== false) {\n        return (new Date(date1.getTime()).setHours(0, 0, 0, 0) -\n            new Date(date2.getTime()).setHours(0, 0, 0, 0));\n    }\n    return date1.getTime() - date2.getTime();\n}\nexport function compareTimes(date1, date2) {\n    return (3600 * (date1.getHours() - date2.getHours()) +\n        60 * (date1.getMinutes() - date2.getMinutes()) +\n        date1.getSeconds() -\n        date2.getSeconds());\n}\nexport var isBetween = function (ts, ts1, ts2) {\n    return ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);\n};\nexport var calculateSecondsSinceMidnight = function (hours, minutes, seconds) {\n    return hours * 3600 + minutes * 60 + seconds;\n};\nexport var parseSeconds = function (secondsSinceMidnight) {\n    var hours = Math.floor(secondsSinceMidnight / 3600), minutes = (secondsSinceMidnight - hours * 3600) / 60;\n    return [hours, minutes, secondsSinceMidnight - hours * 3600 - minutes * 60];\n};\nexport var duration = {\n    DAY: 86400000,\n};\nexport function getDefaultHours(config) {\n    var hours = config.defaultHour;\n    var minutes = config.defaultMinute;\n    var seconds = config.defaultSeconds;\n    if (config.minDate !== undefined) {\n        var minHour = config.minDate.getHours();\n        var minMinutes = config.minDate.getMinutes();\n        var minSeconds = config.minDate.getSeconds();\n        if (hours < minHour) {\n            hours = minHour;\n        }\n        if (hours === minHour && minutes < minMinutes) {\n            minutes = minMinutes;\n        }\n        if (hours === minHour && minutes === minMinutes && seconds < minSeconds)\n            seconds = config.minDate.getSeconds();\n    }\n    if (config.maxDate !== undefined) {\n        var maxHr = config.maxDate.getHours();\n        var maxMinutes = config.maxDate.getMinutes();\n        hours = Math.min(hours, maxHr);\n        if (hours === maxHr)\n            minutes = Math.min(maxMinutes, minutes);\n        if (hours === maxHr && minutes === maxMinutes)\n            seconds = config.maxDate.getSeconds();\n    }\n    return { hours: hours, minutes: minutes, seconds: seconds };\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { defaults as defaultOptions, HOOKS, } from \"./types/options\";\nimport English from \"./l10n/default\";\nimport { arrayify, debounce, int, pad } from \"./utils\";\nimport { clearNode, createElement, createNumberInput, findParent, toggleClass, getEventTarget, } from \"./utils/dom\";\nimport { compareDates, createDateParser, createDateFormatter, duration, isBetween, getDefaultHours, calculateSecondsSinceMidnight, parseSeconds, } from \"./utils/dates\";\nimport { tokenRegex, monthToStr } from \"./utils/formatting\";\nimport \"./utils/polyfills\";\nvar DEBOUNCED_CHANGE_MS = 300;\nfunction FlatpickrInstance(element, instanceConfig) {\n    var self = {\n        config: __assign(__assign({}, defaultOptions), flatpickr.defaultConfig),\n        l10n: English,\n    };\n    self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n    self._handlers = [];\n    self.pluginElements = [];\n    self.loadedPlugins = [];\n    self._bind = bind;\n    self._setHoursFromDate = setHoursFromDate;\n    self._positionCalendar = positionCalendar;\n    self.changeMonth = changeMonth;\n    self.changeYear = changeYear;\n    self.clear = clear;\n    self.close = close;\n    self.onMouseOver = onMouseOver;\n    self._createElement = createElement;\n    self.createDay = createDay;\n    self.destroy = destroy;\n    self.isEnabled = isEnabled;\n    self.jumpToDate = jumpToDate;\n    self.updateValue = updateValue;\n    self.open = open;\n    self.redraw = redraw;\n    self.set = set;\n    self.setDate = setDate;\n    self.toggle = toggle;\n    function setupHelperFunctions() {\n        self.utils = {\n            getDaysInMonth: function (month, yr) {\n                if (month === void 0) { month = self.currentMonth; }\n                if (yr === void 0) { yr = self.currentYear; }\n                if (month === 1 && ((yr % 4 === 0 && yr % 100 !== 0) || yr % 400 === 0))\n                    return 29;\n                return self.l10n.daysInMonth[month];\n            },\n        };\n    }\n    function init() {\n        self.element = self.input = element;\n        self.isOpen = false;\n        parseConfig();\n        setupLocale();\n        setupInputs();\n        setupDates();\n        setupHelperFunctions();\n        if (!self.isMobile)\n            build();\n        bindEvents();\n        if (self.selectedDates.length || self.config.noCalendar) {\n            if (self.config.enableTime) {\n                setHoursFromDate(self.config.noCalendar ? self.latestSelectedDateObj : undefined);\n            }\n            updateValue(false);\n        }\n        setCalendarWidth();\n        var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n        if (!self.isMobile && isSafari) {\n            positionCalendar();\n        }\n        triggerEvent(\"onReady\");\n    }\n    function getClosestActiveElement() {\n        var _a;\n        return (((_a = self.calendarContainer) === null || _a === void 0 ? void 0 : _a.getRootNode())\n            .activeElement || document.activeElement);\n    }\n    function bindToInstance(fn) {\n        return fn.bind(self);\n    }\n    function setCalendarWidth() {\n        var config = self.config;\n        if (config.weekNumbers === false && config.showMonths === 1) {\n            return;\n        }\n        else if (config.noCalendar !== true) {\n            window.requestAnimationFrame(function () {\n                if (self.calendarContainer !== undefined) {\n                    self.calendarContainer.style.visibility = \"hidden\";\n                    self.calendarContainer.style.display = \"block\";\n                }\n                if (self.daysContainer !== undefined) {\n                    var daysWidth = (self.days.offsetWidth + 1) * config.showMonths;\n                    self.daysContainer.style.width = daysWidth + \"px\";\n                    self.calendarContainer.style.width =\n                        daysWidth +\n                            (self.weekWrapper !== undefined\n                                ? self.weekWrapper.offsetWidth\n                                : 0) +\n                            \"px\";\n                    self.calendarContainer.style.removeProperty(\"visibility\");\n                    self.calendarContainer.style.removeProperty(\"display\");\n                }\n            });\n        }\n    }\n    function updateTime(e) {\n        if (self.selectedDates.length === 0) {\n            var defaultDate = self.config.minDate === undefined ||\n                compareDates(new Date(), self.config.minDate) >= 0\n                ? new Date()\n                : new Date(self.config.minDate.getTime());\n            var defaults = getDefaultHours(self.config);\n            defaultDate.setHours(defaults.hours, defaults.minutes, defaults.seconds, defaultDate.getMilliseconds());\n            self.selectedDates = [defaultDate];\n            self.latestSelectedDateObj = defaultDate;\n        }\n        if (e !== undefined && e.type !== \"blur\") {\n            timeWrapper(e);\n        }\n        var prevValue = self._input.value;\n        setHoursFromInputs();\n        updateValue();\n        if (self._input.value !== prevValue) {\n            self._debouncedChange();\n        }\n    }\n    function ampm2military(hour, amPM) {\n        return (hour % 12) + 12 * int(amPM === self.l10n.amPM[1]);\n    }\n    function military2ampm(hour) {\n        switch (hour % 24) {\n            case 0:\n            case 12:\n                return 12;\n            default:\n                return hour % 12;\n        }\n    }\n    function setHoursFromInputs() {\n        if (self.hourElement === undefined || self.minuteElement === undefined)\n            return;\n        var hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24, minutes = (parseInt(self.minuteElement.value, 10) || 0) % 60, seconds = self.secondElement !== undefined\n            ? (parseInt(self.secondElement.value, 10) || 0) % 60\n            : 0;\n        if (self.amPM !== undefined) {\n            hours = ampm2military(hours, self.amPM.textContent);\n        }\n        var limitMinHours = self.config.minTime !== undefined ||\n            (self.config.minDate &&\n                self.minDateHasTime &&\n                self.latestSelectedDateObj &&\n                compareDates(self.latestSelectedDateObj, self.config.minDate, true) ===\n                    0);\n        var limitMaxHours = self.config.maxTime !== undefined ||\n            (self.config.maxDate &&\n                self.maxDateHasTime &&\n                self.latestSelectedDateObj &&\n                compareDates(self.latestSelectedDateObj, self.config.maxDate, true) ===\n                    0);\n        if (self.config.maxTime !== undefined &&\n            self.config.minTime !== undefined &&\n            self.config.minTime > self.config.maxTime) {\n            var minBound = calculateSecondsSinceMidnight(self.config.minTime.getHours(), self.config.minTime.getMinutes(), self.config.minTime.getSeconds());\n            var maxBound = calculateSecondsSinceMidnight(self.config.maxTime.getHours(), self.config.maxTime.getMinutes(), self.config.maxTime.getSeconds());\n            var currentTime = calculateSecondsSinceMidnight(hours, minutes, seconds);\n            if (currentTime > maxBound && currentTime < minBound) {\n                var result = parseSeconds(minBound);\n                hours = result[0];\n                minutes = result[1];\n                seconds = result[2];\n            }\n        }\n        else {\n            if (limitMaxHours) {\n                var maxTime = self.config.maxTime !== undefined\n                    ? self.config.maxTime\n                    : self.config.maxDate;\n                hours = Math.min(hours, maxTime.getHours());\n                if (hours === maxTime.getHours())\n                    minutes = Math.min(minutes, maxTime.getMinutes());\n                if (minutes === maxTime.getMinutes())\n                    seconds = Math.min(seconds, maxTime.getSeconds());\n            }\n            if (limitMinHours) {\n                var minTime = self.config.minTime !== undefined\n                    ? self.config.minTime\n                    : self.config.minDate;\n                hours = Math.max(hours, minTime.getHours());\n                if (hours === minTime.getHours() && minutes < minTime.getMinutes())\n                    minutes = minTime.getMinutes();\n                if (minutes === minTime.getMinutes())\n                    seconds = Math.max(seconds, minTime.getSeconds());\n            }\n        }\n        setHours(hours, minutes, seconds);\n    }\n    function setHoursFromDate(dateObj) {\n        var date = dateObj || self.latestSelectedDateObj;\n        if (date && date instanceof Date) {\n            setHours(date.getHours(), date.getMinutes(), date.getSeconds());\n        }\n    }\n    function setHours(hours, minutes, seconds) {\n        if (self.latestSelectedDateObj !== undefined) {\n            self.latestSelectedDateObj.setHours(hours % 24, minutes, seconds || 0, 0);\n        }\n        if (!self.hourElement || !self.minuteElement || self.isMobile)\n            return;\n        self.hourElement.value = pad(!self.config.time_24hr\n            ? ((12 + hours) % 12) + 12 * int(hours % 12 === 0)\n            : hours);\n        self.minuteElement.value = pad(minutes);\n        if (self.amPM !== undefined)\n            self.amPM.textContent = self.l10n.amPM[int(hours >= 12)];\n        if (self.secondElement !== undefined)\n            self.secondElement.value = pad(seconds);\n    }\n    function onYearInput(event) {\n        var eventTarget = getEventTarget(event);\n        var year = parseInt(eventTarget.value) + (event.delta || 0);\n        if (year / 1000 > 1 ||\n            (event.key === \"Enter\" && !/[^\\d]/.test(year.toString()))) {\n            changeYear(year);\n        }\n    }\n    function bind(element, event, handler, options) {\n        if (event instanceof Array)\n            return event.forEach(function (ev) { return bind(element, ev, handler, options); });\n        if (element instanceof Array)\n            return element.forEach(function (el) { return bind(el, event, handler, options); });\n        element.addEventListener(event, handler, options);\n        self._handlers.push({\n            remove: function () { return element.removeEventListener(event, handler, options); },\n        });\n    }\n    function triggerChange() {\n        triggerEvent(\"onChange\");\n    }\n    function bindEvents() {\n        if (self.config.wrap) {\n            [\"open\", \"close\", \"toggle\", \"clear\"].forEach(function (evt) {\n                Array.prototype.forEach.call(self.element.querySelectorAll(\"[data-\" + evt + \"]\"), function (el) {\n                    return bind(el, \"click\", self[evt]);\n                });\n            });\n        }\n        if (self.isMobile) {\n            setupMobile();\n            return;\n        }\n        var debouncedResize = debounce(onResize, 50);\n        self._debouncedChange = debounce(triggerChange, DEBOUNCED_CHANGE_MS);\n        if (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))\n            bind(self.daysContainer, \"mouseover\", function (e) {\n                if (self.config.mode === \"range\")\n                    onMouseOver(getEventTarget(e));\n            });\n        bind(self._input, \"keydown\", onKeyDown);\n        if (self.calendarContainer !== undefined) {\n            bind(self.calendarContainer, \"keydown\", onKeyDown);\n        }\n        if (!self.config.inline && !self.config.static)\n            bind(window, \"resize\", debouncedResize);\n        if (window.ontouchstart !== undefined)\n            bind(window.document, \"touchstart\", documentClick);\n        else\n            bind(window.document, \"mousedown\", documentClick);\n        bind(window.document, \"focus\", documentClick, { capture: true });\n        if (self.config.clickOpens === true) {\n            bind(self._input, \"focus\", self.open);\n            bind(self._input, \"click\", self.open);\n        }\n        if (self.daysContainer !== undefined) {\n            bind(self.monthNav, \"click\", onMonthNavClick);\n            bind(self.monthNav, [\"keyup\", \"increment\"], onYearInput);\n            bind(self.daysContainer, \"click\", selectDate);\n        }\n        if (self.timeContainer !== undefined &&\n            self.minuteElement !== undefined &&\n            self.hourElement !== undefined) {\n            var selText = function (e) {\n                return getEventTarget(e).select();\n            };\n            bind(self.timeContainer, [\"increment\"], updateTime);\n            bind(self.timeContainer, \"blur\", updateTime, { capture: true });\n            bind(self.timeContainer, \"click\", timeIncrement);\n            bind([self.hourElement, self.minuteElement], [\"focus\", \"click\"], selText);\n            if (self.secondElement !== undefined)\n                bind(self.secondElement, \"focus\", function () { return self.secondElement && self.secondElement.select(); });\n            if (self.amPM !== undefined) {\n                bind(self.amPM, \"click\", function (e) {\n                    updateTime(e);\n                });\n            }\n        }\n        if (self.config.allowInput) {\n            bind(self._input, \"blur\", onBlur);\n        }\n    }\n    function jumpToDate(jumpDate, triggerChange) {\n        var jumpTo = jumpDate !== undefined\n            ? self.parseDate(jumpDate)\n            : self.latestSelectedDateObj ||\n                (self.config.minDate && self.config.minDate > self.now\n                    ? self.config.minDate\n                    : self.config.maxDate && self.config.maxDate < self.now\n                        ? self.config.maxDate\n                        : self.now);\n        var oldYear = self.currentYear;\n        var oldMonth = self.currentMonth;\n        try {\n            if (jumpTo !== undefined) {\n                self.currentYear = jumpTo.getFullYear();\n                self.currentMonth = jumpTo.getMonth();\n            }\n        }\n        catch (e) {\n            e.message = \"Invalid date supplied: \" + jumpTo;\n            self.config.errorHandler(e);\n        }\n        if (triggerChange && self.currentYear !== oldYear) {\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n        if (triggerChange &&\n            (self.currentYear !== oldYear || self.currentMonth !== oldMonth)) {\n            triggerEvent(\"onMonthChange\");\n        }\n        self.redraw();\n    }\n    function timeIncrement(e) {\n        var eventTarget = getEventTarget(e);\n        if (~eventTarget.className.indexOf(\"arrow\"))\n            incrementNumInput(e, eventTarget.classList.contains(\"arrowUp\") ? 1 : -1);\n    }\n    function incrementNumInput(e, delta, inputElem) {\n        var target = e && getEventTarget(e);\n        var input = inputElem ||\n            (target && target.parentNode && target.parentNode.firstChild);\n        var event = createEvent(\"increment\");\n        event.delta = delta;\n        input && input.dispatchEvent(event);\n    }\n    function build() {\n        var fragment = window.document.createDocumentFragment();\n        self.calendarContainer = createElement(\"div\", \"flatpickr-calendar\");\n        self.calendarContainer.tabIndex = -1;\n        if (!self.config.noCalendar) {\n            fragment.appendChild(buildMonthNav());\n            self.innerContainer = createElement(\"div\", \"flatpickr-innerContainer\");\n            if (self.config.weekNumbers) {\n                var _a = buildWeeks(), weekWrapper = _a.weekWrapper, weekNumbers = _a.weekNumbers;\n                self.innerContainer.appendChild(weekWrapper);\n                self.weekNumbers = weekNumbers;\n                self.weekWrapper = weekWrapper;\n            }\n            self.rContainer = createElement(\"div\", \"flatpickr-rContainer\");\n            self.rContainer.appendChild(buildWeekdays());\n            if (!self.daysContainer) {\n                self.daysContainer = createElement(\"div\", \"flatpickr-days\");\n                self.daysContainer.tabIndex = -1;\n            }\n            buildDays();\n            self.rContainer.appendChild(self.daysContainer);\n            self.innerContainer.appendChild(self.rContainer);\n            fragment.appendChild(self.innerContainer);\n        }\n        if (self.config.enableTime) {\n            fragment.appendChild(buildTime());\n        }\n        toggleClass(self.calendarContainer, \"rangeMode\", self.config.mode === \"range\");\n        toggleClass(self.calendarContainer, \"animate\", self.config.animate === true);\n        toggleClass(self.calendarContainer, \"multiMonth\", self.config.showMonths > 1);\n        self.calendarContainer.appendChild(fragment);\n        var customAppend = self.config.appendTo !== undefined &&\n            self.config.appendTo.nodeType !== undefined;\n        if (self.config.inline || self.config.static) {\n            self.calendarContainer.classList.add(self.config.inline ? \"inline\" : \"static\");\n            if (self.config.inline) {\n                if (!customAppend && self.element.parentNode)\n                    self.element.parentNode.insertBefore(self.calendarContainer, self._input.nextSibling);\n                else if (self.config.appendTo !== undefined)\n                    self.config.appendTo.appendChild(self.calendarContainer);\n            }\n            if (self.config.static) {\n                var wrapper = createElement(\"div\", \"flatpickr-wrapper\");\n                if (self.element.parentNode)\n                    self.element.parentNode.insertBefore(wrapper, self.element);\n                wrapper.appendChild(self.element);\n                if (self.altInput)\n                    wrapper.appendChild(self.altInput);\n                wrapper.appendChild(self.calendarContainer);\n            }\n        }\n        if (!self.config.static && !self.config.inline)\n            (self.config.appendTo !== undefined\n                ? self.config.appendTo\n                : window.document.body).appendChild(self.calendarContainer);\n    }\n    function createDay(className, date, _dayNumber, i) {\n        var dateIsEnabled = isEnabled(date, true), dayElement = createElement(\"span\", className, date.getDate().toString());\n        dayElement.dateObj = date;\n        dayElement.$i = i;\n        dayElement.setAttribute(\"aria-label\", self.formatDate(date, self.config.ariaDateFormat));\n        if (className.indexOf(\"hidden\") === -1 &&\n            compareDates(date, self.now) === 0) {\n            self.todayDateElem = dayElement;\n            dayElement.classList.add(\"today\");\n            dayElement.setAttribute(\"aria-current\", \"date\");\n        }\n        if (dateIsEnabled) {\n            dayElement.tabIndex = -1;\n            if (isDateSelected(date)) {\n                dayElement.classList.add(\"selected\");\n                self.selectedDateElem = dayElement;\n                if (self.config.mode === \"range\") {\n                    toggleClass(dayElement, \"startRange\", self.selectedDates[0] &&\n                        compareDates(date, self.selectedDates[0], true) === 0);\n                    toggleClass(dayElement, \"endRange\", self.selectedDates[1] &&\n                        compareDates(date, self.selectedDates[1], true) === 0);\n                    if (className === \"nextMonthDay\")\n                        dayElement.classList.add(\"inRange\");\n                }\n            }\n        }\n        else {\n            dayElement.classList.add(\"flatpickr-disabled\");\n        }\n        if (self.config.mode === \"range\") {\n            if (isDateInRange(date) && !isDateSelected(date))\n                dayElement.classList.add(\"inRange\");\n        }\n        if (self.weekNumbers &&\n            self.config.showMonths === 1 &&\n            className !== \"prevMonthDay\" &&\n            i % 7 === 6) {\n            self.weekNumbers.insertAdjacentHTML(\"beforeend\", \"<span class='flatpickr-day'>\" + self.config.getWeek(date) + \"</span>\");\n        }\n        triggerEvent(\"onDayCreate\", dayElement);\n        return dayElement;\n    }\n    function focusOnDayElem(targetNode) {\n        targetNode.focus();\n        if (self.config.mode === \"range\")\n            onMouseOver(targetNode);\n    }\n    function getFirstAvailableDay(delta) {\n        var startMonth = delta > 0 ? 0 : self.config.showMonths - 1;\n        var endMonth = delta > 0 ? self.config.showMonths : -1;\n        for (var m = startMonth; m != endMonth; m += delta) {\n            var month = self.daysContainer.children[m];\n            var startIndex = delta > 0 ? 0 : month.children.length - 1;\n            var endIndex = delta > 0 ? month.children.length : -1;\n            for (var i = startIndex; i != endIndex; i += delta) {\n                var c = month.children[i];\n                if (c.className.indexOf(\"hidden\") === -1 && isEnabled(c.dateObj))\n                    return c;\n            }\n        }\n        return undefined;\n    }\n    function getNextAvailableDay(current, delta) {\n        var givenMonth = current.className.indexOf(\"Month\") === -1\n            ? current.dateObj.getMonth()\n            : self.currentMonth;\n        var endMonth = delta > 0 ? self.config.showMonths : -1;\n        var loopDelta = delta > 0 ? 1 : -1;\n        for (var m = givenMonth - self.currentMonth; m != endMonth; m += loopDelta) {\n            var month = self.daysContainer.children[m];\n            var startIndex = givenMonth - self.currentMonth === m\n                ? current.$i + delta\n                : delta < 0\n                    ? month.children.length - 1\n                    : 0;\n            var numMonthDays = month.children.length;\n            for (var i = startIndex; i >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1); i += loopDelta) {\n                var c = month.children[i];\n                if (c.className.indexOf(\"hidden\") === -1 &&\n                    isEnabled(c.dateObj) &&\n                    Math.abs(current.$i - i) >= Math.abs(delta))\n                    return focusOnDayElem(c);\n            }\n        }\n        self.changeMonth(loopDelta);\n        focusOnDay(getFirstAvailableDay(loopDelta), 0);\n        return undefined;\n    }\n    function focusOnDay(current, offset) {\n        var activeElement = getClosestActiveElement();\n        var dayFocused = isInView(activeElement || document.body);\n        var startElem = current !== undefined\n            ? current\n            : dayFocused\n                ? activeElement\n                : self.selectedDateElem !== undefined && isInView(self.selectedDateElem)\n                    ? self.selectedDateElem\n                    : self.todayDateElem !== undefined && isInView(self.todayDateElem)\n                        ? self.todayDateElem\n                        : getFirstAvailableDay(offset > 0 ? 1 : -1);\n        if (startElem === undefined) {\n            self._input.focus();\n        }\n        else if (!dayFocused) {\n            focusOnDayElem(startElem);\n        }\n        else {\n            getNextAvailableDay(startElem, offset);\n        }\n    }\n    function buildMonthDays(year, month) {\n        var firstOfMonth = (new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;\n        var prevMonthDays = self.utils.getDaysInMonth((month - 1 + 12) % 12, year);\n        var daysInMonth = self.utils.getDaysInMonth(month, year), days = window.document.createDocumentFragment(), isMultiMonth = self.config.showMonths > 1, prevMonthDayClass = isMultiMonth ? \"prevMonthDay hidden\" : \"prevMonthDay\", nextMonthDayClass = isMultiMonth ? \"nextMonthDay hidden\" : \"nextMonthDay\";\n        var dayNumber = prevMonthDays + 1 - firstOfMonth, dayIndex = 0;\n        for (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {\n            days.appendChild(createDay(\"flatpickr-day \" + prevMonthDayClass, new Date(year, month - 1, dayNumber), dayNumber, dayIndex));\n        }\n        for (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {\n            days.appendChild(createDay(\"flatpickr-day\", new Date(year, month, dayNumber), dayNumber, dayIndex));\n        }\n        for (var dayNum = daysInMonth + 1; dayNum <= 42 - firstOfMonth &&\n            (self.config.showMonths === 1 || dayIndex % 7 !== 0); dayNum++, dayIndex++) {\n            days.appendChild(createDay(\"flatpickr-day \" + nextMonthDayClass, new Date(year, month + 1, dayNum % daysInMonth), dayNum, dayIndex));\n        }\n        var dayContainer = createElement(\"div\", \"dayContainer\");\n        dayContainer.appendChild(days);\n        return dayContainer;\n    }\n    function buildDays() {\n        if (self.daysContainer === undefined) {\n            return;\n        }\n        clearNode(self.daysContainer);\n        if (self.weekNumbers)\n            clearNode(self.weekNumbers);\n        var frag = document.createDocumentFragment();\n        for (var i = 0; i < self.config.showMonths; i++) {\n            var d = new Date(self.currentYear, self.currentMonth, 1);\n            d.setMonth(self.currentMonth + i);\n            frag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));\n        }\n        self.daysContainer.appendChild(frag);\n        self.days = self.daysContainer.firstChild;\n        if (self.config.mode === \"range\" && self.selectedDates.length === 1) {\n            onMouseOver();\n        }\n    }\n    function buildMonthSwitch() {\n        if (self.config.showMonths > 1 ||\n            self.config.monthSelectorType !== \"dropdown\")\n            return;\n        var shouldBuildMonth = function (month) {\n            if (self.config.minDate !== undefined &&\n                self.currentYear === self.config.minDate.getFullYear() &&\n                month < self.config.minDate.getMonth()) {\n                return false;\n            }\n            return !(self.config.maxDate !== undefined &&\n                self.currentYear === self.config.maxDate.getFullYear() &&\n                month > self.config.maxDate.getMonth());\n        };\n        self.monthsDropdownContainer.tabIndex = -1;\n        self.monthsDropdownContainer.innerHTML = \"\";\n        for (var i = 0; i < 12; i++) {\n            if (!shouldBuildMonth(i))\n                continue;\n            var month = createElement(\"option\", \"flatpickr-monthDropdown-month\");\n            month.value = new Date(self.currentYear, i).getMonth().toString();\n            month.textContent = monthToStr(i, self.config.shorthandCurrentMonth, self.l10n);\n            month.tabIndex = -1;\n            if (self.currentMonth === i) {\n                month.selected = true;\n            }\n            self.monthsDropdownContainer.appendChild(month);\n        }\n    }\n    function buildMonth() {\n        var container = createElement(\"div\", \"flatpickr-month\");\n        var monthNavFragment = window.document.createDocumentFragment();\n        var monthElement;\n        if (self.config.showMonths > 1 ||\n            self.config.monthSelectorType === \"static\") {\n            monthElement = createElement(\"span\", \"cur-month\");\n        }\n        else {\n            self.monthsDropdownContainer = createElement(\"select\", \"flatpickr-monthDropdown-months\");\n            self.monthsDropdownContainer.setAttribute(\"aria-label\", self.l10n.monthAriaLabel);\n            bind(self.monthsDropdownContainer, \"change\", function (e) {\n                var target = getEventTarget(e);\n                var selectedMonth = parseInt(target.value, 10);\n                self.changeMonth(selectedMonth - self.currentMonth);\n                triggerEvent(\"onMonthChange\");\n            });\n            buildMonthSwitch();\n            monthElement = self.monthsDropdownContainer;\n        }\n        var yearInput = createNumberInput(\"cur-year\", { tabindex: \"-1\" });\n        var yearElement = yearInput.getElementsByTagName(\"input\")[0];\n        yearElement.setAttribute(\"aria-label\", self.l10n.yearAriaLabel);\n        if (self.config.minDate) {\n            yearElement.setAttribute(\"min\", self.config.minDate.getFullYear().toString());\n        }\n        if (self.config.maxDate) {\n            yearElement.setAttribute(\"max\", self.config.maxDate.getFullYear().toString());\n            yearElement.disabled =\n                !!self.config.minDate &&\n                    self.config.minDate.getFullYear() === self.config.maxDate.getFullYear();\n        }\n        var currentMonth = createElement(\"div\", \"flatpickr-current-month\");\n        currentMonth.appendChild(monthElement);\n        currentMonth.appendChild(yearInput);\n        monthNavFragment.appendChild(currentMonth);\n        container.appendChild(monthNavFragment);\n        return {\n            container: container,\n            yearElement: yearElement,\n            monthElement: monthElement,\n        };\n    }\n    function buildMonths() {\n        clearNode(self.monthNav);\n        self.monthNav.appendChild(self.prevMonthNav);\n        if (self.config.showMonths) {\n            self.yearElements = [];\n            self.monthElements = [];\n        }\n        for (var m = self.config.showMonths; m--;) {\n            var month = buildMonth();\n            self.yearElements.push(month.yearElement);\n            self.monthElements.push(month.monthElement);\n            self.monthNav.appendChild(month.container);\n        }\n        self.monthNav.appendChild(self.nextMonthNav);\n    }\n    function buildMonthNav() {\n        self.monthNav = createElement(\"div\", \"flatpickr-months\");\n        self.yearElements = [];\n        self.monthElements = [];\n        self.prevMonthNav = createElement(\"span\", \"flatpickr-prev-month\");\n        self.prevMonthNav.innerHTML = self.config.prevArrow;\n        self.nextMonthNav = createElement(\"span\", \"flatpickr-next-month\");\n        self.nextMonthNav.innerHTML = self.config.nextArrow;\n        buildMonths();\n        Object.defineProperty(self, \"_hidePrevMonthArrow\", {\n            get: function () { return self.__hidePrevMonthArrow; },\n            set: function (bool) {\n                if (self.__hidePrevMonthArrow !== bool) {\n                    toggleClass(self.prevMonthNav, \"flatpickr-disabled\", bool);\n                    self.__hidePrevMonthArrow = bool;\n                }\n            },\n        });\n        Object.defineProperty(self, \"_hideNextMonthArrow\", {\n            get: function () { return self.__hideNextMonthArrow; },\n            set: function (bool) {\n                if (self.__hideNextMonthArrow !== bool) {\n                    toggleClass(self.nextMonthNav, \"flatpickr-disabled\", bool);\n                    self.__hideNextMonthArrow = bool;\n                }\n            },\n        });\n        self.currentYearElement = self.yearElements[0];\n        updateNavigationCurrentMonth();\n        return self.monthNav;\n    }\n    function buildTime() {\n        self.calendarContainer.classList.add(\"hasTime\");\n        if (self.config.noCalendar)\n            self.calendarContainer.classList.add(\"noCalendar\");\n        var defaults = getDefaultHours(self.config);\n        self.timeContainer = createElement(\"div\", \"flatpickr-time\");\n        self.timeContainer.tabIndex = -1;\n        var separator = createElement(\"span\", \"flatpickr-time-separator\", \":\");\n        var hourInput = createNumberInput(\"flatpickr-hour\", {\n            \"aria-label\": self.l10n.hourAriaLabel,\n        });\n        self.hourElement = hourInput.getElementsByTagName(\"input\")[0];\n        var minuteInput = createNumberInput(\"flatpickr-minute\", {\n            \"aria-label\": self.l10n.minuteAriaLabel,\n        });\n        self.minuteElement = minuteInput.getElementsByTagName(\"input\")[0];\n        self.hourElement.tabIndex = self.minuteElement.tabIndex = -1;\n        self.hourElement.value = pad(self.latestSelectedDateObj\n            ? self.latestSelectedDateObj.getHours()\n            : self.config.time_24hr\n                ? defaults.hours\n                : military2ampm(defaults.hours));\n        self.minuteElement.value = pad(self.latestSelectedDateObj\n            ? self.latestSelectedDateObj.getMinutes()\n            : defaults.minutes);\n        self.hourElement.setAttribute(\"step\", self.config.hourIncrement.toString());\n        self.minuteElement.setAttribute(\"step\", self.config.minuteIncrement.toString());\n        self.hourElement.setAttribute(\"min\", self.config.time_24hr ? \"0\" : \"1\");\n        self.hourElement.setAttribute(\"max\", self.config.time_24hr ? \"23\" : \"12\");\n        self.hourElement.setAttribute(\"maxlength\", \"2\");\n        self.minuteElement.setAttribute(\"min\", \"0\");\n        self.minuteElement.setAttribute(\"max\", \"59\");\n        self.minuteElement.setAttribute(\"maxlength\", \"2\");\n        self.timeContainer.appendChild(hourInput);\n        self.timeContainer.appendChild(separator);\n        self.timeContainer.appendChild(minuteInput);\n        if (self.config.time_24hr)\n            self.timeContainer.classList.add(\"time24hr\");\n        if (self.config.enableSeconds) {\n            self.timeContainer.classList.add(\"hasSeconds\");\n            var secondInput = createNumberInput(\"flatpickr-second\");\n            self.secondElement = secondInput.getElementsByTagName(\"input\")[0];\n            self.secondElement.value = pad(self.latestSelectedDateObj\n                ? self.latestSelectedDateObj.getSeconds()\n                : defaults.seconds);\n            self.secondElement.setAttribute(\"step\", self.minuteElement.getAttribute(\"step\"));\n            self.secondElement.setAttribute(\"min\", \"0\");\n            self.secondElement.setAttribute(\"max\", \"59\");\n            self.secondElement.setAttribute(\"maxlength\", \"2\");\n            self.timeContainer.appendChild(createElement(\"span\", \"flatpickr-time-separator\", \":\"));\n            self.timeContainer.appendChild(secondInput);\n        }\n        if (!self.config.time_24hr) {\n            self.amPM = createElement(\"span\", \"flatpickr-am-pm\", self.l10n.amPM[int((self.latestSelectedDateObj\n                ? self.hourElement.value\n                : self.config.defaultHour) > 11)]);\n            self.amPM.title = self.l10n.toggleTitle;\n            self.amPM.tabIndex = -1;\n            self.timeContainer.appendChild(self.amPM);\n        }\n        return self.timeContainer;\n    }\n    function buildWeekdays() {\n        if (!self.weekdayContainer)\n            self.weekdayContainer = createElement(\"div\", \"flatpickr-weekdays\");\n        else\n            clearNode(self.weekdayContainer);\n        for (var i = self.config.showMonths; i--;) {\n            var container = createElement(\"div\", \"flatpickr-weekdaycontainer\");\n            self.weekdayContainer.appendChild(container);\n        }\n        updateWeekdays();\n        return self.weekdayContainer;\n    }\n    function updateWeekdays() {\n        if (!self.weekdayContainer) {\n            return;\n        }\n        var firstDayOfWeek = self.l10n.firstDayOfWeek;\n        var weekdays = __spreadArrays(self.l10n.weekdays.shorthand);\n        if (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {\n            weekdays = __spreadArrays(weekdays.splice(firstDayOfWeek, weekdays.length), weekdays.splice(0, firstDayOfWeek));\n        }\n        for (var i = self.config.showMonths; i--;) {\n            self.weekdayContainer.children[i].innerHTML = \"\\n      <span class='flatpickr-weekday'>\\n        \" + weekdays.join(\"</span><span class='flatpickr-weekday'>\") + \"\\n      </span>\\n      \";\n        }\n    }\n    function buildWeeks() {\n        self.calendarContainer.classList.add(\"hasWeeks\");\n        var weekWrapper = createElement(\"div\", \"flatpickr-weekwrapper\");\n        weekWrapper.appendChild(createElement(\"span\", \"flatpickr-weekday\", self.l10n.weekAbbreviation));\n        var weekNumbers = createElement(\"div\", \"flatpickr-weeks\");\n        weekWrapper.appendChild(weekNumbers);\n        return {\n            weekWrapper: weekWrapper,\n            weekNumbers: weekNumbers,\n        };\n    }\n    function changeMonth(value, isOffset) {\n        if (isOffset === void 0) { isOffset = true; }\n        var delta = isOffset ? value : value - self.currentMonth;\n        if ((delta < 0 && self._hidePrevMonthArrow === true) ||\n            (delta > 0 && self._hideNextMonthArrow === true))\n            return;\n        self.currentMonth += delta;\n        if (self.currentMonth < 0 || self.currentMonth > 11) {\n            self.currentYear += self.currentMonth > 11 ? 1 : -1;\n            self.currentMonth = (self.currentMonth + 12) % 12;\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n        buildDays();\n        triggerEvent(\"onMonthChange\");\n        updateNavigationCurrentMonth();\n    }\n    function clear(triggerChangeEvent, toInitial) {\n        if (triggerChangeEvent === void 0) { triggerChangeEvent = true; }\n        if (toInitial === void 0) { toInitial = true; }\n        self.input.value = \"\";\n        if (self.altInput !== undefined)\n            self.altInput.value = \"\";\n        if (self.mobileInput !== undefined)\n            self.mobileInput.value = \"\";\n        self.selectedDates = [];\n        self.latestSelectedDateObj = undefined;\n        if (toInitial === true) {\n            self.currentYear = self._initialDate.getFullYear();\n            self.currentMonth = self._initialDate.getMonth();\n        }\n        if (self.config.enableTime === true) {\n            var _a = getDefaultHours(self.config), hours = _a.hours, minutes = _a.minutes, seconds = _a.seconds;\n            setHours(hours, minutes, seconds);\n        }\n        self.redraw();\n        if (triggerChangeEvent)\n            triggerEvent(\"onChange\");\n    }\n    function close() {\n        self.isOpen = false;\n        if (!self.isMobile) {\n            if (self.calendarContainer !== undefined) {\n                self.calendarContainer.classList.remove(\"open\");\n            }\n            if (self._input !== undefined) {\n                self._input.classList.remove(\"active\");\n            }\n        }\n        triggerEvent(\"onClose\");\n    }\n    function destroy() {\n        if (self.config !== undefined)\n            triggerEvent(\"onDestroy\");\n        for (var i = self._handlers.length; i--;) {\n            self._handlers[i].remove();\n        }\n        self._handlers = [];\n        if (self.mobileInput) {\n            if (self.mobileInput.parentNode)\n                self.mobileInput.parentNode.removeChild(self.mobileInput);\n            self.mobileInput = undefined;\n        }\n        else if (self.calendarContainer && self.calendarContainer.parentNode) {\n            if (self.config.static && self.calendarContainer.parentNode) {\n                var wrapper = self.calendarContainer.parentNode;\n                wrapper.lastChild && wrapper.removeChild(wrapper.lastChild);\n                if (wrapper.parentNode) {\n                    while (wrapper.firstChild)\n                        wrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);\n                    wrapper.parentNode.removeChild(wrapper);\n                }\n            }\n            else\n                self.calendarContainer.parentNode.removeChild(self.calendarContainer);\n        }\n        if (self.altInput) {\n            self.input.type = \"text\";\n            if (self.altInput.parentNode)\n                self.altInput.parentNode.removeChild(self.altInput);\n            delete self.altInput;\n        }\n        if (self.input) {\n            self.input.type = self.input._type;\n            self.input.classList.remove(\"flatpickr-input\");\n            self.input.removeAttribute(\"readonly\");\n        }\n        [\n            \"_showTimeInput\",\n            \"latestSelectedDateObj\",\n            \"_hideNextMonthArrow\",\n            \"_hidePrevMonthArrow\",\n            \"__hideNextMonthArrow\",\n            \"__hidePrevMonthArrow\",\n            \"isMobile\",\n            \"isOpen\",\n            \"selectedDateElem\",\n            \"minDateHasTime\",\n            \"maxDateHasTime\",\n            \"days\",\n            \"daysContainer\",\n            \"_input\",\n            \"_positionElement\",\n            \"innerContainer\",\n            \"rContainer\",\n            \"monthNav\",\n            \"todayDateElem\",\n            \"calendarContainer\",\n            \"weekdayContainer\",\n            \"prevMonthNav\",\n            \"nextMonthNav\",\n            \"monthsDropdownContainer\",\n            \"currentMonthElement\",\n            \"currentYearElement\",\n            \"navigationCurrentMonth\",\n            \"selectedDateElem\",\n            \"config\",\n        ].forEach(function (k) {\n            try {\n                delete self[k];\n            }\n            catch (_) { }\n        });\n    }\n    function isCalendarElem(elem) {\n        return self.calendarContainer.contains(elem);\n    }\n    function documentClick(e) {\n        if (self.isOpen && !self.config.inline) {\n            var eventTarget_1 = getEventTarget(e);\n            var isCalendarElement = isCalendarElem(eventTarget_1);\n            var isInput = eventTarget_1 === self.input ||\n                eventTarget_1 === self.altInput ||\n                self.element.contains(eventTarget_1) ||\n                (e.path &&\n                    e.path.indexOf &&\n                    (~e.path.indexOf(self.input) ||\n                        ~e.path.indexOf(self.altInput)));\n            var lostFocus = !isInput &&\n                !isCalendarElement &&\n                !isCalendarElem(e.relatedTarget);\n            var isIgnored = !self.config.ignoredFocusElements.some(function (elem) {\n                return elem.contains(eventTarget_1);\n            });\n            if (lostFocus && isIgnored) {\n                if (self.config.allowInput) {\n                    self.setDate(self._input.value, false, self.config.altInput\n                        ? self.config.altFormat\n                        : self.config.dateFormat);\n                }\n                if (self.timeContainer !== undefined &&\n                    self.minuteElement !== undefined &&\n                    self.hourElement !== undefined &&\n                    self.input.value !== \"\" &&\n                    self.input.value !== undefined) {\n                    updateTime();\n                }\n                self.close();\n                if (self.config &&\n                    self.config.mode === \"range\" &&\n                    self.selectedDates.length === 1)\n                    self.clear(false);\n            }\n        }\n    }\n    function changeYear(newYear) {\n        if (!newYear ||\n            (self.config.minDate && newYear < self.config.minDate.getFullYear()) ||\n            (self.config.maxDate && newYear > self.config.maxDate.getFullYear()))\n            return;\n        var newYearNum = newYear, isNewYear = self.currentYear !== newYearNum;\n        self.currentYear = newYearNum || self.currentYear;\n        if (self.config.maxDate &&\n            self.currentYear === self.config.maxDate.getFullYear()) {\n            self.currentMonth = Math.min(self.config.maxDate.getMonth(), self.currentMonth);\n        }\n        else if (self.config.minDate &&\n            self.currentYear === self.config.minDate.getFullYear()) {\n            self.currentMonth = Math.max(self.config.minDate.getMonth(), self.currentMonth);\n        }\n        if (isNewYear) {\n            self.redraw();\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n    }\n    function isEnabled(date, timeless) {\n        var _a;\n        if (timeless === void 0) { timeless = true; }\n        var dateToCheck = self.parseDate(date, undefined, timeless);\n        if ((self.config.minDate &&\n            dateToCheck &&\n            compareDates(dateToCheck, self.config.minDate, timeless !== undefined ? timeless : !self.minDateHasTime) < 0) ||\n            (self.config.maxDate &&\n                dateToCheck &&\n                compareDates(dateToCheck, self.config.maxDate, timeless !== undefined ? timeless : !self.maxDateHasTime) > 0))\n            return false;\n        if (!self.config.enable && self.config.disable.length === 0)\n            return true;\n        if (dateToCheck === undefined)\n            return false;\n        var bool = !!self.config.enable, array = (_a = self.config.enable) !== null && _a !== void 0 ? _a : self.config.disable;\n        for (var i = 0, d = void 0; i < array.length; i++) {\n            d = array[i];\n            if (typeof d === \"function\" &&\n                d(dateToCheck))\n                return bool;\n            else if (d instanceof Date &&\n                dateToCheck !== undefined &&\n                d.getTime() === dateToCheck.getTime())\n                return bool;\n            else if (typeof d === \"string\") {\n                var parsed = self.parseDate(d, undefined, true);\n                return parsed && parsed.getTime() === dateToCheck.getTime()\n                    ? bool\n                    : !bool;\n            }\n            else if (typeof d === \"object\" &&\n                dateToCheck !== undefined &&\n                d.from &&\n                d.to &&\n                dateToCheck.getTime() >= d.from.getTime() &&\n                dateToCheck.getTime() <= d.to.getTime())\n                return bool;\n        }\n        return !bool;\n    }\n    function isInView(elem) {\n        if (self.daysContainer !== undefined)\n            return (elem.className.indexOf(\"hidden\") === -1 &&\n                elem.className.indexOf(\"flatpickr-disabled\") === -1 &&\n                self.daysContainer.contains(elem));\n        return false;\n    }\n    function onBlur(e) {\n        var isInput = e.target === self._input;\n        var valueChanged = self._input.value.trimEnd() !== getDateStr();\n        if (isInput &&\n            valueChanged &&\n            !(e.relatedTarget && isCalendarElem(e.relatedTarget))) {\n            self.setDate(self._input.value, true, e.target === self.altInput\n                ? self.config.altFormat\n                : self.config.dateFormat);\n        }\n    }\n    function onKeyDown(e) {\n        var eventTarget = getEventTarget(e);\n        var isInput = self.config.wrap\n            ? element.contains(eventTarget)\n            : eventTarget === self._input;\n        var allowInput = self.config.allowInput;\n        var allowKeydown = self.isOpen && (!allowInput || !isInput);\n        var allowInlineKeydown = self.config.inline && isInput && !allowInput;\n        if (e.keyCode === 13 && isInput) {\n            if (allowInput) {\n                self.setDate(self._input.value, true, eventTarget === self.altInput\n                    ? self.config.altFormat\n                    : self.config.dateFormat);\n                self.close();\n                return eventTarget.blur();\n            }\n            else {\n                self.open();\n            }\n        }\n        else if (isCalendarElem(eventTarget) ||\n            allowKeydown ||\n            allowInlineKeydown) {\n            var isTimeObj = !!self.timeContainer &&\n                self.timeContainer.contains(eventTarget);\n            switch (e.keyCode) {\n                case 13:\n                    if (isTimeObj) {\n                        e.preventDefault();\n                        updateTime();\n                        focusAndClose();\n                    }\n                    else\n                        selectDate(e);\n                    break;\n                case 27:\n                    e.preventDefault();\n                    focusAndClose();\n                    break;\n                case 8:\n                case 46:\n                    if (isInput && !self.config.allowInput) {\n                        e.preventDefault();\n                        self.clear();\n                    }\n                    break;\n                case 37:\n                case 39:\n                    if (!isTimeObj && !isInput) {\n                        e.preventDefault();\n                        var activeElement = getClosestActiveElement();\n                        if (self.daysContainer !== undefined &&\n                            (allowInput === false ||\n                                (activeElement && isInView(activeElement)))) {\n                            var delta_1 = e.keyCode === 39 ? 1 : -1;\n                            if (!e.ctrlKey)\n                                focusOnDay(undefined, delta_1);\n                            else {\n                                e.stopPropagation();\n                                changeMonth(delta_1);\n                                focusOnDay(getFirstAvailableDay(1), 0);\n                            }\n                        }\n                    }\n                    else if (self.hourElement)\n                        self.hourElement.focus();\n                    break;\n                case 38:\n                case 40:\n                    e.preventDefault();\n                    var delta = e.keyCode === 40 ? 1 : -1;\n                    if ((self.daysContainer &&\n                        eventTarget.$i !== undefined) ||\n                        eventTarget === self.input ||\n                        eventTarget === self.altInput) {\n                        if (e.ctrlKey) {\n                            e.stopPropagation();\n                            changeYear(self.currentYear - delta);\n                            focusOnDay(getFirstAvailableDay(1), 0);\n                        }\n                        else if (!isTimeObj)\n                            focusOnDay(undefined, delta * 7);\n                    }\n                    else if (eventTarget === self.currentYearElement) {\n                        changeYear(self.currentYear - delta);\n                    }\n                    else if (self.config.enableTime) {\n                        if (!isTimeObj && self.hourElement)\n                            self.hourElement.focus();\n                        updateTime(e);\n                        self._debouncedChange();\n                    }\n                    break;\n                case 9:\n                    if (isTimeObj) {\n                        var elems = [\n                            self.hourElement,\n                            self.minuteElement,\n                            self.secondElement,\n                            self.amPM,\n                        ]\n                            .concat(self.pluginElements)\n                            .filter(function (x) { return x; });\n                        var i = elems.indexOf(eventTarget);\n                        if (i !== -1) {\n                            var target = elems[i + (e.shiftKey ? -1 : 1)];\n                            e.preventDefault();\n                            (target || self._input).focus();\n                        }\n                    }\n                    else if (!self.config.noCalendar &&\n                        self.daysContainer &&\n                        self.daysContainer.contains(eventTarget) &&\n                        e.shiftKey) {\n                        e.preventDefault();\n                        self._input.focus();\n                    }\n                    break;\n                default:\n                    break;\n            }\n        }\n        if (self.amPM !== undefined && eventTarget === self.amPM) {\n            switch (e.key) {\n                case self.l10n.amPM[0].charAt(0):\n                case self.l10n.amPM[0].charAt(0).toLowerCase():\n                    self.amPM.textContent = self.l10n.amPM[0];\n                    setHoursFromInputs();\n                    updateValue();\n                    break;\n                case self.l10n.amPM[1].charAt(0):\n                case self.l10n.amPM[1].charAt(0).toLowerCase():\n                    self.amPM.textContent = self.l10n.amPM[1];\n                    setHoursFromInputs();\n                    updateValue();\n                    break;\n            }\n        }\n        if (isInput || isCalendarElem(eventTarget)) {\n            triggerEvent(\"onKeyDown\", e);\n        }\n    }\n    function onMouseOver(elem, cellClass) {\n        if (cellClass === void 0) { cellClass = \"flatpickr-day\"; }\n        if (self.selectedDates.length !== 1 ||\n            (elem &&\n                (!elem.classList.contains(cellClass) ||\n                    elem.classList.contains(\"flatpickr-disabled\"))))\n            return;\n        var hoverDate = elem\n            ? elem.dateObj.getTime()\n            : self.days.firstElementChild.dateObj.getTime(), initialDate = self.parseDate(self.selectedDates[0], undefined, true).getTime(), rangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()), rangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime());\n        var containsDisabled = false;\n        var minRange = 0, maxRange = 0;\n        for (var t = rangeStartDate; t < rangeEndDate; t += duration.DAY) {\n            if (!isEnabled(new Date(t), true)) {\n                containsDisabled =\n                    containsDisabled || (t > rangeStartDate && t < rangeEndDate);\n                if (t < initialDate && (!minRange || t > minRange))\n                    minRange = t;\n                else if (t > initialDate && (!maxRange || t < maxRange))\n                    maxRange = t;\n            }\n        }\n        var hoverableCells = Array.from(self.rContainer.querySelectorAll(\"*:nth-child(-n+\" + self.config.showMonths + \") > .\" + cellClass));\n        hoverableCells.forEach(function (dayElem) {\n            var date = dayElem.dateObj;\n            var timestamp = date.getTime();\n            var outOfRange = (minRange > 0 && timestamp < minRange) ||\n                (maxRange > 0 && timestamp > maxRange);\n            if (outOfRange) {\n                dayElem.classList.add(\"notAllowed\");\n                [\"inRange\", \"startRange\", \"endRange\"].forEach(function (c) {\n                    dayElem.classList.remove(c);\n                });\n                return;\n            }\n            else if (containsDisabled && !outOfRange)\n                return;\n            [\"startRange\", \"inRange\", \"endRange\", \"notAllowed\"].forEach(function (c) {\n                dayElem.classList.remove(c);\n            });\n            if (elem !== undefined) {\n                elem.classList.add(hoverDate <= self.selectedDates[0].getTime()\n                    ? \"startRange\"\n                    : \"endRange\");\n                if (initialDate < hoverDate && timestamp === initialDate)\n                    dayElem.classList.add(\"startRange\");\n                else if (initialDate > hoverDate && timestamp === initialDate)\n                    dayElem.classList.add(\"endRange\");\n                if (timestamp >= minRange &&\n                    (maxRange === 0 || timestamp <= maxRange) &&\n                    isBetween(timestamp, initialDate, hoverDate))\n                    dayElem.classList.add(\"inRange\");\n            }\n        });\n    }\n    function onResize() {\n        if (self.isOpen && !self.config.static && !self.config.inline)\n            positionCalendar();\n    }\n    function open(e, positionElement) {\n        if (positionElement === void 0) { positionElement = self._positionElement; }\n        if (self.isMobile === true) {\n            if (e) {\n                e.preventDefault();\n                var eventTarget = getEventTarget(e);\n                if (eventTarget) {\n                    eventTarget.blur();\n                }\n            }\n            if (self.mobileInput !== undefined) {\n                self.mobileInput.focus();\n                self.mobileInput.click();\n            }\n            triggerEvent(\"onOpen\");\n            return;\n        }\n        else if (self._input.disabled || self.config.inline) {\n            return;\n        }\n        var wasOpen = self.isOpen;\n        self.isOpen = true;\n        if (!wasOpen) {\n            self.calendarContainer.classList.add(\"open\");\n            self._input.classList.add(\"active\");\n            triggerEvent(\"onOpen\");\n            positionCalendar(positionElement);\n        }\n        if (self.config.enableTime === true && self.config.noCalendar === true) {\n            if (self.config.allowInput === false &&\n                (e === undefined ||\n                    !self.timeContainer.contains(e.relatedTarget))) {\n                setTimeout(function () { return self.hourElement.select(); }, 50);\n            }\n        }\n    }\n    function minMaxDateSetter(type) {\n        return function (date) {\n            var dateObj = (self.config[\"_\" + type + \"Date\"] = self.parseDate(date, self.config.dateFormat));\n            var inverseDateObj = self.config[\"_\" + (type === \"min\" ? \"max\" : \"min\") + \"Date\"];\n            if (dateObj !== undefined) {\n                self[type === \"min\" ? \"minDateHasTime\" : \"maxDateHasTime\"] =\n                    dateObj.getHours() > 0 ||\n                        dateObj.getMinutes() > 0 ||\n                        dateObj.getSeconds() > 0;\n            }\n            if (self.selectedDates) {\n                self.selectedDates = self.selectedDates.filter(function (d) { return isEnabled(d); });\n                if (!self.selectedDates.length && type === \"min\")\n                    setHoursFromDate(dateObj);\n                updateValue();\n            }\n            if (self.daysContainer) {\n                redraw();\n                if (dateObj !== undefined)\n                    self.currentYearElement[type] = dateObj.getFullYear().toString();\n                else\n                    self.currentYearElement.removeAttribute(type);\n                self.currentYearElement.disabled =\n                    !!inverseDateObj &&\n                        dateObj !== undefined &&\n                        inverseDateObj.getFullYear() === dateObj.getFullYear();\n            }\n        };\n    }\n    function parseConfig() {\n        var boolOpts = [\n            \"wrap\",\n            \"weekNumbers\",\n            \"allowInput\",\n            \"allowInvalidPreload\",\n            \"clickOpens\",\n            \"time_24hr\",\n            \"enableTime\",\n            \"noCalendar\",\n            \"altInput\",\n            \"shorthandCurrentMonth\",\n            \"inline\",\n            \"static\",\n            \"enableSeconds\",\n            \"disableMobile\",\n        ];\n        var userConfig = __assign(__assign({}, JSON.parse(JSON.stringify(element.dataset || {}))), instanceConfig);\n        var formats = {};\n        self.config.parseDate = userConfig.parseDate;\n        self.config.formatDate = userConfig.formatDate;\n        Object.defineProperty(self.config, \"enable\", {\n            get: function () { return self.config._enable; },\n            set: function (dates) {\n                self.config._enable = parseDateRules(dates);\n            },\n        });\n        Object.defineProperty(self.config, \"disable\", {\n            get: function () { return self.config._disable; },\n            set: function (dates) {\n                self.config._disable = parseDateRules(dates);\n            },\n        });\n        var timeMode = userConfig.mode === \"time\";\n        if (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {\n            var defaultDateFormat = flatpickr.defaultConfig.dateFormat || defaultOptions.dateFormat;\n            formats.dateFormat =\n                userConfig.noCalendar || timeMode\n                    ? \"H:i\" + (userConfig.enableSeconds ? \":S\" : \"\")\n                    : defaultDateFormat + \" H:i\" + (userConfig.enableSeconds ? \":S\" : \"\");\n        }\n        if (userConfig.altInput &&\n            (userConfig.enableTime || timeMode) &&\n            !userConfig.altFormat) {\n            var defaultAltFormat = flatpickr.defaultConfig.altFormat || defaultOptions.altFormat;\n            formats.altFormat =\n                userConfig.noCalendar || timeMode\n                    ? \"h:i\" + (userConfig.enableSeconds ? \":S K\" : \" K\")\n                    : defaultAltFormat + (\" h:i\" + (userConfig.enableSeconds ? \":S\" : \"\") + \" K\");\n        }\n        Object.defineProperty(self.config, \"minDate\", {\n            get: function () { return self.config._minDate; },\n            set: minMaxDateSetter(\"min\"),\n        });\n        Object.defineProperty(self.config, \"maxDate\", {\n            get: function () { return self.config._maxDate; },\n            set: minMaxDateSetter(\"max\"),\n        });\n        var minMaxTimeSetter = function (type) { return function (val) {\n            self.config[type === \"min\" ? \"_minTime\" : \"_maxTime\"] = self.parseDate(val, \"H:i:S\");\n        }; };\n        Object.defineProperty(self.config, \"minTime\", {\n            get: function () { return self.config._minTime; },\n            set: minMaxTimeSetter(\"min\"),\n        });\n        Object.defineProperty(self.config, \"maxTime\", {\n            get: function () { return self.config._maxTime; },\n            set: minMaxTimeSetter(\"max\"),\n        });\n        if (userConfig.mode === \"time\") {\n            self.config.noCalendar = true;\n            self.config.enableTime = true;\n        }\n        Object.assign(self.config, formats, userConfig);\n        for (var i = 0; i < boolOpts.length; i++)\n            self.config[boolOpts[i]] =\n                self.config[boolOpts[i]] === true ||\n                    self.config[boolOpts[i]] === \"true\";\n        HOOKS.filter(function (hook) { return self.config[hook] !== undefined; }).forEach(function (hook) {\n            self.config[hook] = arrayify(self.config[hook] || []).map(bindToInstance);\n        });\n        self.isMobile =\n            !self.config.disableMobile &&\n                !self.config.inline &&\n                self.config.mode === \"single\" &&\n                !self.config.disable.length &&\n                !self.config.enable &&\n                !self.config.weekNumbers &&\n                /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n        for (var i = 0; i < self.config.plugins.length; i++) {\n            var pluginConf = self.config.plugins[i](self) || {};\n            for (var key in pluginConf) {\n                if (HOOKS.indexOf(key) > -1) {\n                    self.config[key] = arrayify(pluginConf[key])\n                        .map(bindToInstance)\n                        .concat(self.config[key]);\n                }\n                else if (typeof userConfig[key] === \"undefined\")\n                    self.config[key] = pluginConf[key];\n            }\n        }\n        if (!userConfig.altInputClass) {\n            self.config.altInputClass =\n                getInputElem().className + \" \" + self.config.altInputClass;\n        }\n        triggerEvent(\"onParseConfig\");\n    }\n    function getInputElem() {\n        return self.config.wrap\n            ? element.querySelector(\"[data-input]\")\n            : element;\n    }\n    function setupLocale() {\n        if (typeof self.config.locale !== \"object\" &&\n            typeof flatpickr.l10ns[self.config.locale] === \"undefined\")\n            self.config.errorHandler(new Error(\"flatpickr: invalid locale \" + self.config.locale));\n        self.l10n = __assign(__assign({}, flatpickr.l10ns.default), (typeof self.config.locale === \"object\"\n            ? self.config.locale\n            : self.config.locale !== \"default\"\n                ? flatpickr.l10ns[self.config.locale]\n                : undefined));\n        tokenRegex.D = \"(\" + self.l10n.weekdays.shorthand.join(\"|\") + \")\";\n        tokenRegex.l = \"(\" + self.l10n.weekdays.longhand.join(\"|\") + \")\";\n        tokenRegex.M = \"(\" + self.l10n.months.shorthand.join(\"|\") + \")\";\n        tokenRegex.F = \"(\" + self.l10n.months.longhand.join(\"|\") + \")\";\n        tokenRegex.K = \"(\" + self.l10n.amPM[0] + \"|\" + self.l10n.amPM[1] + \"|\" + self.l10n.amPM[0].toLowerCase() + \"|\" + self.l10n.amPM[1].toLowerCase() + \")\";\n        var userConfig = __assign(__assign({}, instanceConfig), JSON.parse(JSON.stringify(element.dataset || {})));\n        if (userConfig.time_24hr === undefined &&\n            flatpickr.defaultConfig.time_24hr === undefined) {\n            self.config.time_24hr = self.l10n.time_24hr;\n        }\n        self.formatDate = createDateFormatter(self);\n        self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n    }\n    function positionCalendar(customPositionElement) {\n        if (typeof self.config.position === \"function\") {\n            return void self.config.position(self, customPositionElement);\n        }\n        if (self.calendarContainer === undefined)\n            return;\n        triggerEvent(\"onPreCalendarPosition\");\n        var positionElement = customPositionElement || self._positionElement;\n        var calendarHeight = Array.prototype.reduce.call(self.calendarContainer.children, (function (acc, child) { return acc + child.offsetHeight; }), 0), calendarWidth = self.calendarContainer.offsetWidth, configPos = self.config.position.split(\" \"), configPosVertical = configPos[0], configPosHorizontal = configPos.length > 1 ? configPos[1] : null, inputBounds = positionElement.getBoundingClientRect(), distanceFromBottom = window.innerHeight - inputBounds.bottom, showOnTop = configPosVertical === \"above\" ||\n            (configPosVertical !== \"below\" &&\n                distanceFromBottom < calendarHeight &&\n                inputBounds.top > calendarHeight);\n        var top = window.pageYOffset +\n            inputBounds.top +\n            (!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);\n        toggleClass(self.calendarContainer, \"arrowTop\", !showOnTop);\n        toggleClass(self.calendarContainer, \"arrowBottom\", showOnTop);\n        if (self.config.inline)\n            return;\n        var left = window.pageXOffset + inputBounds.left;\n        var isCenter = false;\n        var isRight = false;\n        if (configPosHorizontal === \"center\") {\n            left -= (calendarWidth - inputBounds.width) / 2;\n            isCenter = true;\n        }\n        else if (configPosHorizontal === \"right\") {\n            left -= calendarWidth - inputBounds.width;\n            isRight = true;\n        }\n        toggleClass(self.calendarContainer, \"arrowLeft\", !isCenter && !isRight);\n        toggleClass(self.calendarContainer, \"arrowCenter\", isCenter);\n        toggleClass(self.calendarContainer, \"arrowRight\", isRight);\n        var right = window.document.body.offsetWidth -\n            (window.pageXOffset + inputBounds.right);\n        var rightMost = left + calendarWidth > window.document.body.offsetWidth;\n        var centerMost = right + calendarWidth > window.document.body.offsetWidth;\n        toggleClass(self.calendarContainer, \"rightMost\", rightMost);\n        if (self.config.static)\n            return;\n        self.calendarContainer.style.top = top + \"px\";\n        if (!rightMost) {\n            self.calendarContainer.style.left = left + \"px\";\n            self.calendarContainer.style.right = \"auto\";\n        }\n        else if (!centerMost) {\n            self.calendarContainer.style.left = \"auto\";\n            self.calendarContainer.style.right = right + \"px\";\n        }\n        else {\n            var doc = getDocumentStyleSheet();\n            if (doc === undefined)\n                return;\n            var bodyWidth = window.document.body.offsetWidth;\n            var centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);\n            var centerBefore = \".flatpickr-calendar.centerMost:before\";\n            var centerAfter = \".flatpickr-calendar.centerMost:after\";\n            var centerIndex = doc.cssRules.length;\n            var centerStyle = \"{left:\" + inputBounds.left + \"px;right:auto;}\";\n            toggleClass(self.calendarContainer, \"rightMost\", false);\n            toggleClass(self.calendarContainer, \"centerMost\", true);\n            doc.insertRule(centerBefore + \",\" + centerAfter + centerStyle, centerIndex);\n            self.calendarContainer.style.left = centerLeft + \"px\";\n            self.calendarContainer.style.right = \"auto\";\n        }\n    }\n    function getDocumentStyleSheet() {\n        var editableSheet = null;\n        for (var i = 0; i < document.styleSheets.length; i++) {\n            var sheet = document.styleSheets[i];\n            if (!sheet.cssRules)\n                continue;\n            try {\n                sheet.cssRules;\n            }\n            catch (err) {\n                continue;\n            }\n            editableSheet = sheet;\n            break;\n        }\n        return editableSheet != null ? editableSheet : createStyleSheet();\n    }\n    function createStyleSheet() {\n        var style = document.createElement(\"style\");\n        document.head.appendChild(style);\n        return style.sheet;\n    }\n    function redraw() {\n        if (self.config.noCalendar || self.isMobile)\n            return;\n        buildMonthSwitch();\n        updateNavigationCurrentMonth();\n        buildDays();\n    }\n    function focusAndClose() {\n        self._input.focus();\n        if (window.navigator.userAgent.indexOf(\"MSIE\") !== -1 ||\n            navigator.msMaxTouchPoints !== undefined) {\n            setTimeout(self.close, 0);\n        }\n        else {\n            self.close();\n        }\n    }\n    function selectDate(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        var isSelectable = function (day) {\n            return day.classList &&\n                day.classList.contains(\"flatpickr-day\") &&\n                !day.classList.contains(\"flatpickr-disabled\") &&\n                !day.classList.contains(\"notAllowed\");\n        };\n        var t = findParent(getEventTarget(e), isSelectable);\n        if (t === undefined)\n            return;\n        var target = t;\n        var selectedDate = (self.latestSelectedDateObj = new Date(target.dateObj.getTime()));\n        var shouldChangeMonth = (selectedDate.getMonth() < self.currentMonth ||\n            selectedDate.getMonth() >\n                self.currentMonth + self.config.showMonths - 1) &&\n            self.config.mode !== \"range\";\n        self.selectedDateElem = target;\n        if (self.config.mode === \"single\")\n            self.selectedDates = [selectedDate];\n        else if (self.config.mode === \"multiple\") {\n            var selectedIndex = isDateSelected(selectedDate);\n            if (selectedIndex)\n                self.selectedDates.splice(parseInt(selectedIndex), 1);\n            else\n                self.selectedDates.push(selectedDate);\n        }\n        else if (self.config.mode === \"range\") {\n            if (self.selectedDates.length === 2) {\n                self.clear(false, false);\n            }\n            self.latestSelectedDateObj = selectedDate;\n            self.selectedDates.push(selectedDate);\n            if (compareDates(selectedDate, self.selectedDates[0], true) !== 0)\n                self.selectedDates.sort(function (a, b) { return a.getTime() - b.getTime(); });\n        }\n        setHoursFromInputs();\n        if (shouldChangeMonth) {\n            var isNewYear = self.currentYear !== selectedDate.getFullYear();\n            self.currentYear = selectedDate.getFullYear();\n            self.currentMonth = selectedDate.getMonth();\n            if (isNewYear) {\n                triggerEvent(\"onYearChange\");\n                buildMonthSwitch();\n            }\n            triggerEvent(\"onMonthChange\");\n        }\n        updateNavigationCurrentMonth();\n        buildDays();\n        updateValue();\n        if (!shouldChangeMonth &&\n            self.config.mode !== \"range\" &&\n            self.config.showMonths === 1)\n            focusOnDayElem(target);\n        else if (self.selectedDateElem !== undefined &&\n            self.hourElement === undefined) {\n            self.selectedDateElem && self.selectedDateElem.focus();\n        }\n        if (self.hourElement !== undefined)\n            self.hourElement !== undefined && self.hourElement.focus();\n        if (self.config.closeOnSelect) {\n            var single = self.config.mode === \"single\" && !self.config.enableTime;\n            var range = self.config.mode === \"range\" &&\n                self.selectedDates.length === 2 &&\n                !self.config.enableTime;\n            if (single || range) {\n                focusAndClose();\n            }\n        }\n        triggerChange();\n    }\n    var CALLBACKS = {\n        locale: [setupLocale, updateWeekdays],\n        showMonths: [buildMonths, setCalendarWidth, buildWeekdays],\n        minDate: [jumpToDate],\n        maxDate: [jumpToDate],\n        positionElement: [updatePositionElement],\n        clickOpens: [\n            function () {\n                if (self.config.clickOpens === true) {\n                    bind(self._input, \"focus\", self.open);\n                    bind(self._input, \"click\", self.open);\n                }\n                else {\n                    self._input.removeEventListener(\"focus\", self.open);\n                    self._input.removeEventListener(\"click\", self.open);\n                }\n            },\n        ],\n    };\n    function set(option, value) {\n        if (option !== null && typeof option === \"object\") {\n            Object.assign(self.config, option);\n            for (var key in option) {\n                if (CALLBACKS[key] !== undefined)\n                    CALLBACKS[key].forEach(function (x) { return x(); });\n            }\n        }\n        else {\n            self.config[option] = value;\n            if (CALLBACKS[option] !== undefined)\n                CALLBACKS[option].forEach(function (x) { return x(); });\n            else if (HOOKS.indexOf(option) > -1)\n                self.config[option] = arrayify(value);\n        }\n        self.redraw();\n        updateValue(true);\n    }\n    function setSelectedDate(inputDate, format) {\n        var dates = [];\n        if (inputDate instanceof Array)\n            dates = inputDate.map(function (d) { return self.parseDate(d, format); });\n        else if (inputDate instanceof Date || typeof inputDate === \"number\")\n            dates = [self.parseDate(inputDate, format)];\n        else if (typeof inputDate === \"string\") {\n            switch (self.config.mode) {\n                case \"single\":\n                case \"time\":\n                    dates = [self.parseDate(inputDate, format)];\n                    break;\n                case \"multiple\":\n                    dates = inputDate\n                        .split(self.config.conjunction)\n                        .map(function (date) { return self.parseDate(date, format); });\n                    break;\n                case \"range\":\n                    dates = inputDate\n                        .split(self.l10n.rangeSeparator)\n                        .map(function (date) { return self.parseDate(date, format); });\n                    break;\n                default:\n                    break;\n            }\n        }\n        else\n            self.config.errorHandler(new Error(\"Invalid date supplied: \" + JSON.stringify(inputDate)));\n        self.selectedDates = (self.config.allowInvalidPreload\n            ? dates\n            : dates.filter(function (d) { return d instanceof Date && isEnabled(d, false); }));\n        if (self.config.mode === \"range\")\n            self.selectedDates.sort(function (a, b) { return a.getTime() - b.getTime(); });\n    }\n    function setDate(date, triggerChange, format) {\n        if (triggerChange === void 0) { triggerChange = false; }\n        if (format === void 0) { format = self.config.dateFormat; }\n        if ((date !== 0 && !date) || (date instanceof Array && date.length === 0))\n            return self.clear(triggerChange);\n        setSelectedDate(date, format);\n        self.latestSelectedDateObj =\n            self.selectedDates[self.selectedDates.length - 1];\n        self.redraw();\n        jumpToDate(undefined, triggerChange);\n        setHoursFromDate();\n        if (self.selectedDates.length === 0) {\n            self.clear(false);\n        }\n        updateValue(triggerChange);\n        if (triggerChange)\n            triggerEvent(\"onChange\");\n    }\n    function parseDateRules(arr) {\n        return arr\n            .slice()\n            .map(function (rule) {\n            if (typeof rule === \"string\" ||\n                typeof rule === \"number\" ||\n                rule instanceof Date) {\n                return self.parseDate(rule, undefined, true);\n            }\n            else if (rule &&\n                typeof rule === \"object\" &&\n                rule.from &&\n                rule.to)\n                return {\n                    from: self.parseDate(rule.from, undefined),\n                    to: self.parseDate(rule.to, undefined),\n                };\n            return rule;\n        })\n            .filter(function (x) { return x; });\n    }\n    function setupDates() {\n        self.selectedDates = [];\n        self.now = self.parseDate(self.config.now) || new Date();\n        var preloadedDate = self.config.defaultDate ||\n            ((self.input.nodeName === \"INPUT\" ||\n                self.input.nodeName === \"TEXTAREA\") &&\n                self.input.placeholder &&\n                self.input.value === self.input.placeholder\n                ? null\n                : self.input.value);\n        if (preloadedDate)\n            setSelectedDate(preloadedDate, self.config.dateFormat);\n        self._initialDate =\n            self.selectedDates.length > 0\n                ? self.selectedDates[0]\n                : self.config.minDate &&\n                    self.config.minDate.getTime() > self.now.getTime()\n                    ? self.config.minDate\n                    : self.config.maxDate &&\n                        self.config.maxDate.getTime() < self.now.getTime()\n                        ? self.config.maxDate\n                        : self.now;\n        self.currentYear = self._initialDate.getFullYear();\n        self.currentMonth = self._initialDate.getMonth();\n        if (self.selectedDates.length > 0)\n            self.latestSelectedDateObj = self.selectedDates[0];\n        if (self.config.minTime !== undefined)\n            self.config.minTime = self.parseDate(self.config.minTime, \"H:i\");\n        if (self.config.maxTime !== undefined)\n            self.config.maxTime = self.parseDate(self.config.maxTime, \"H:i\");\n        self.minDateHasTime =\n            !!self.config.minDate &&\n                (self.config.minDate.getHours() > 0 ||\n                    self.config.minDate.getMinutes() > 0 ||\n                    self.config.minDate.getSeconds() > 0);\n        self.maxDateHasTime =\n            !!self.config.maxDate &&\n                (self.config.maxDate.getHours() > 0 ||\n                    self.config.maxDate.getMinutes() > 0 ||\n                    self.config.maxDate.getSeconds() > 0);\n    }\n    function setupInputs() {\n        self.input = getInputElem();\n        if (!self.input) {\n            self.config.errorHandler(new Error(\"Invalid input element specified\"));\n            return;\n        }\n        self.input._type = self.input.type;\n        self.input.type = \"text\";\n        self.input.classList.add(\"flatpickr-input\");\n        self._input = self.input;\n        if (self.config.altInput) {\n            self.altInput = createElement(self.input.nodeName, self.config.altInputClass);\n            self._input = self.altInput;\n            self.altInput.placeholder = self.input.placeholder;\n            self.altInput.disabled = self.input.disabled;\n            self.altInput.required = self.input.required;\n            self.altInput.tabIndex = self.input.tabIndex;\n            self.altInput.type = \"text\";\n            self.input.setAttribute(\"type\", \"hidden\");\n            if (!self.config.static && self.input.parentNode)\n                self.input.parentNode.insertBefore(self.altInput, self.input.nextSibling);\n        }\n        if (!self.config.allowInput)\n            self._input.setAttribute(\"readonly\", \"readonly\");\n        updatePositionElement();\n    }\n    function updatePositionElement() {\n        self._positionElement = self.config.positionElement || self._input;\n    }\n    function setupMobile() {\n        var inputType = self.config.enableTime\n            ? self.config.noCalendar\n                ? \"time\"\n                : \"datetime-local\"\n            : \"date\";\n        self.mobileInput = createElement(\"input\", self.input.className + \" flatpickr-mobile\");\n        self.mobileInput.tabIndex = 1;\n        self.mobileInput.type = inputType;\n        self.mobileInput.disabled = self.input.disabled;\n        self.mobileInput.required = self.input.required;\n        self.mobileInput.placeholder = self.input.placeholder;\n        self.mobileFormatStr =\n            inputType === \"datetime-local\"\n                ? \"Y-m-d\\\\TH:i:S\"\n                : inputType === \"date\"\n                    ? \"Y-m-d\"\n                    : \"H:i:S\";\n        if (self.selectedDates.length > 0) {\n            self.mobileInput.defaultValue = self.mobileInput.value = self.formatDate(self.selectedDates[0], self.mobileFormatStr);\n        }\n        if (self.config.minDate)\n            self.mobileInput.min = self.formatDate(self.config.minDate, \"Y-m-d\");\n        if (self.config.maxDate)\n            self.mobileInput.max = self.formatDate(self.config.maxDate, \"Y-m-d\");\n        if (self.input.getAttribute(\"step\"))\n            self.mobileInput.step = String(self.input.getAttribute(\"step\"));\n        self.input.type = \"hidden\";\n        if (self.altInput !== undefined)\n            self.altInput.type = \"hidden\";\n        try {\n            if (self.input.parentNode)\n                self.input.parentNode.insertBefore(self.mobileInput, self.input.nextSibling);\n        }\n        catch (_a) { }\n        bind(self.mobileInput, \"change\", function (e) {\n            self.setDate(getEventTarget(e).value, false, self.mobileFormatStr);\n            triggerEvent(\"onChange\");\n            triggerEvent(\"onClose\");\n        });\n    }\n    function toggle(e) {\n        if (self.isOpen === true)\n            return self.close();\n        self.open(e);\n    }\n    function triggerEvent(event, data) {\n        if (self.config === undefined)\n            return;\n        var hooks = self.config[event];\n        if (hooks !== undefined && hooks.length > 0) {\n            for (var i = 0; hooks[i] && i < hooks.length; i++)\n                hooks[i](self.selectedDates, self.input.value, self, data);\n        }\n        if (event === \"onChange\") {\n            self.input.dispatchEvent(createEvent(\"change\"));\n            self.input.dispatchEvent(createEvent(\"input\"));\n        }\n    }\n    function createEvent(name) {\n        var e = document.createEvent(\"Event\");\n        e.initEvent(name, true, true);\n        return e;\n    }\n    function isDateSelected(date) {\n        for (var i = 0; i < self.selectedDates.length; i++) {\n            var selectedDate = self.selectedDates[i];\n            if (selectedDate instanceof Date &&\n                compareDates(selectedDate, date) === 0)\n                return \"\" + i;\n        }\n        return false;\n    }\n    function isDateInRange(date) {\n        if (self.config.mode !== \"range\" || self.selectedDates.length < 2)\n            return false;\n        return (compareDates(date, self.selectedDates[0]) >= 0 &&\n            compareDates(date, self.selectedDates[1]) <= 0);\n    }\n    function updateNavigationCurrentMonth() {\n        if (self.config.noCalendar || self.isMobile || !self.monthNav)\n            return;\n        self.yearElements.forEach(function (yearElement, i) {\n            var d = new Date(self.currentYear, self.currentMonth, 1);\n            d.setMonth(self.currentMonth + i);\n            if (self.config.showMonths > 1 ||\n                self.config.monthSelectorType === \"static\") {\n                self.monthElements[i].textContent =\n                    monthToStr(d.getMonth(), self.config.shorthandCurrentMonth, self.l10n) + \" \";\n            }\n            else {\n                self.monthsDropdownContainer.value = d.getMonth().toString();\n            }\n            yearElement.value = d.getFullYear().toString();\n        });\n        self._hidePrevMonthArrow =\n            self.config.minDate !== undefined &&\n                (self.currentYear === self.config.minDate.getFullYear()\n                    ? self.currentMonth <= self.config.minDate.getMonth()\n                    : self.currentYear < self.config.minDate.getFullYear());\n        self._hideNextMonthArrow =\n            self.config.maxDate !== undefined &&\n                (self.currentYear === self.config.maxDate.getFullYear()\n                    ? self.currentMonth + 1 > self.config.maxDate.getMonth()\n                    : self.currentYear > self.config.maxDate.getFullYear());\n    }\n    function getDateStr(specificFormat) {\n        var format = specificFormat ||\n            (self.config.altInput ? self.config.altFormat : self.config.dateFormat);\n        return self.selectedDates\n            .map(function (dObj) { return self.formatDate(dObj, format); })\n            .filter(function (d, i, arr) {\n            return self.config.mode !== \"range\" ||\n                self.config.enableTime ||\n                arr.indexOf(d) === i;\n        })\n            .join(self.config.mode !== \"range\"\n            ? self.config.conjunction\n            : self.l10n.rangeSeparator);\n    }\n    function updateValue(triggerChange) {\n        if (triggerChange === void 0) { triggerChange = true; }\n        if (self.mobileInput !== undefined && self.mobileFormatStr) {\n            self.mobileInput.value =\n                self.latestSelectedDateObj !== undefined\n                    ? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr)\n                    : \"\";\n        }\n        self.input.value = getDateStr(self.config.dateFormat);\n        if (self.altInput !== undefined) {\n            self.altInput.value = getDateStr(self.config.altFormat);\n        }\n        if (triggerChange !== false)\n            triggerEvent(\"onValueUpdate\");\n    }\n    function onMonthNavClick(e) {\n        var eventTarget = getEventTarget(e);\n        var isPrevMonth = self.prevMonthNav.contains(eventTarget);\n        var isNextMonth = self.nextMonthNav.contains(eventTarget);\n        if (isPrevMonth || isNextMonth) {\n            changeMonth(isPrevMonth ? -1 : 1);\n        }\n        else if (self.yearElements.indexOf(eventTarget) >= 0) {\n            eventTarget.select();\n        }\n        else if (eventTarget.classList.contains(\"arrowUp\")) {\n            self.changeYear(self.currentYear + 1);\n        }\n        else if (eventTarget.classList.contains(\"arrowDown\")) {\n            self.changeYear(self.currentYear - 1);\n        }\n    }\n    function timeWrapper(e) {\n        e.preventDefault();\n        var isKeyDown = e.type === \"keydown\", eventTarget = getEventTarget(e), input = eventTarget;\n        if (self.amPM !== undefined && eventTarget === self.amPM) {\n            self.amPM.textContent =\n                self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n        }\n        var min = parseFloat(input.getAttribute(\"min\")), max = parseFloat(input.getAttribute(\"max\")), step = parseFloat(input.getAttribute(\"step\")), curValue = parseInt(input.value, 10), delta = e.delta ||\n            (isKeyDown ? (e.which === 38 ? 1 : -1) : 0);\n        var newValue = curValue + step * delta;\n        if (typeof input.value !== \"undefined\" && input.value.length === 2) {\n            var isHourElem = input === self.hourElement, isMinuteElem = input === self.minuteElement;\n            if (newValue < min) {\n                newValue =\n                    max +\n                        newValue +\n                        int(!isHourElem) +\n                        (int(isHourElem) && int(!self.amPM));\n                if (isMinuteElem)\n                    incrementNumInput(undefined, -1, self.hourElement);\n            }\n            else if (newValue > max) {\n                newValue =\n                    input === self.hourElement ? newValue - max - int(!self.amPM) : min;\n                if (isMinuteElem)\n                    incrementNumInput(undefined, 1, self.hourElement);\n            }\n            if (self.amPM &&\n                isHourElem &&\n                (step === 1\n                    ? newValue + curValue === 23\n                    : Math.abs(newValue - curValue) > step)) {\n                self.amPM.textContent =\n                    self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n            }\n            input.value = pad(newValue);\n        }\n    }\n    init();\n    return self;\n}\nfunction _flatpickr(nodeList, config) {\n    var nodes = Array.prototype.slice\n        .call(nodeList)\n        .filter(function (x) { return x instanceof HTMLElement; });\n    var instances = [];\n    for (var i = 0; i < nodes.length; i++) {\n        var node = nodes[i];\n        try {\n            if (node.getAttribute(\"data-fp-omit\") !== null)\n                continue;\n            if (node._flatpickr !== undefined) {\n                node._flatpickr.destroy();\n                node._flatpickr = undefined;\n            }\n            node._flatpickr = FlatpickrInstance(node, config || {});\n            instances.push(node._flatpickr);\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n    return instances.length === 1 ? instances[0] : instances;\n}\nif (typeof HTMLElement !== \"undefined\" &&\n    typeof HTMLCollection !== \"undefined\" &&\n    typeof NodeList !== \"undefined\") {\n    HTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr = function (config) {\n        return _flatpickr(this, config);\n    };\n    HTMLElement.prototype.flatpickr = function (config) {\n        return _flatpickr([this], config);\n    };\n}\nvar flatpickr = function (selector, config) {\n    if (typeof selector === \"string\") {\n        return _flatpickr(window.document.querySelectorAll(selector), config);\n    }\n    else if (selector instanceof Node) {\n        return _flatpickr([selector], config);\n    }\n    else {\n        return _flatpickr(selector, config);\n    }\n};\nflatpickr.defaultConfig = {};\nflatpickr.l10ns = {\n    en: __assign({}, English),\n    default: __assign({}, English),\n};\nflatpickr.localize = function (l10n) {\n    flatpickr.l10ns.default = __assign(__assign({}, flatpickr.l10ns.default), l10n);\n};\nflatpickr.setDefaults = function (config) {\n    flatpickr.defaultConfig = __assign(__assign({}, flatpickr.defaultConfig), config);\n};\nflatpickr.parseDate = createDateParser({});\nflatpickr.formatDate = createDateFormatter({});\nflatpickr.compareDates = compareDates;\nif (typeof jQuery !== \"undefined\" && typeof jQuery.fn !== \"undefined\") {\n    jQuery.fn.flatpickr = function (config) {\n        return _flatpickr(this, config);\n    };\n}\nDate.prototype.fp_incr = function (days) {\n    return new Date(this.getFullYear(), this.getMonth(), this.getDate() + (typeof days === \"string\" ? parseInt(days, 10) : days));\n};\nif (typeof window !== \"undefined\") {\n    window.flatpickr = flatpickr;\n}\nexport default flatpickr;\n","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { Dropdown } from \"./Dropdown\";\r\nimport { StockIcons } from \"./StockIcons\";\r\nimport { StyleSheet } from \"../../../core/util/Utils\";\r\nimport flatpickr from \"flatpickr\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IDateRangeSelectorSettings extends IStockControlSettings {\r\n\r\n\t/**\r\n\t * Date format to use for date input fields.\r\n\t *\r\n\t * Will use global date format if not set.\r\n\t */\r\n\tdateFormat?: string;\r\n\r\n\t/**\r\n\t * If set to `false` the control will not load default CSS for Flatpickr\r\n\t * component. This would mean it would be unstyled, and would require\r\n\t * custom CSS present on the page.\r\n\t *\r\n\t * @default true\r\n\t * @since 5.2.4\r\n\t */\r\n\tuseDefaultCSS?: boolean;\r\n\r\n}\r\n\r\nexport interface IDateRangeSelectorPrivate extends IStockControlPrivate {\r\n\tdropdown: Dropdown;\r\n\r\n\tfromField: HTMLInputElement;\r\n\tfromPicker: any;\r\n\tfromDate?: Date;\r\n\r\n\ttoField: HTMLInputElement;\r\n\ttoPicker: any;\r\n\ttoDate?: Date;\r\n}\r\n\r\nexport interface IDateRangeSelectorEvents extends IStockControlEvents {\r\n}\r\n\r\n/**\r\n * Date range selector control for [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/date-range-selector/} for more info\r\n */\r\nexport class DateRangeSelector extends StockControl {\r\n\tpublic static className: string = \"DateRangeSelector\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DateRangeSelector.className]);\r\n\r\n\tdeclare public _settings: IDateRangeSelectorSettings;\r\n\tdeclare public _privateSettings: IDateRangeSelectorPrivate;\r\n\tdeclare public _events: IDateRangeSelectorEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst dropdown = Dropdown.new(this._root, {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\")\r\n\t\t});\r\n\t\tthis.setPrivate(\"dropdown\", dropdown);\r\n\r\n\t\tdropdown.events.on(\"opened\", (_ev) => {\r\n\t\t\tthis.set(\"active\", true);\r\n\t\t\tthis._updateInputs();\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => {\r\n\t\t\t\t\tdropdown.show();\r\n\t\t\t\t}, 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdropdown.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\r\n\t\tif (this.get(\"useDefaultCSS\", true)) {\r\n\t\t\tthis._loadDefaultCSS();\r\n\t\t}\r\n\t\tthis._initDropdown();\r\n\t}\r\n\r\n\tprotected _initDropdown(): void {\r\n\t\tconst dropdown = this.getPrivate(\"dropdown\");\r\n\t\tconst container = dropdown.getPrivate(\"container\")!;\r\n\r\n\t\tconst content = document.createElement(\"div\")\r\n\t\tcontent.className = \"am5stock-row\";\r\n\t\tcontainer.appendChild(content);\r\n\r\n\t\t// From fields\r\n\t\tconst fromColumn = document.createElement(\"div\")\r\n\t\tfromColumn.className = \"am5stock-column\";\r\n\t\tcontent.appendChild(fromColumn);\r\n\r\n\t\tconst fromGroup = document.createElement(\"div\");\r\n\t\tfromGroup.className = \"am5stock-group\";\r\n\t\tfromColumn.appendChild(fromGroup);\r\n\r\n\t\tconst fromLabel = document.createElement(\"span\");\r\n\t\tfromLabel.innerHTML = this._root.language.translate(\"From %1\", undefined, \"\") + \": \";\r\n\t\tfromGroup.appendChild(fromLabel);\r\n\r\n\t\tconst fromField = document.createElement(\"input\");\r\n\t\tfromField.type = \"text\";\r\n\t\tfromGroup.appendChild(fromField);\r\n\t\tthis.setPrivate(\"fromField\", fromField);\r\n\r\n\t\t// To fields\r\n\t\tconst toColumn = document.createElement(\"div\")\r\n\t\ttoColumn.className = \"am5stock-column\";\r\n\t\tcontent.appendChild(toColumn);\r\n\r\n\t\tconst toGroup = document.createElement(\"div\");\r\n\t\ttoGroup.className = \"am5stock-group\";\r\n\t\ttoColumn.appendChild(toGroup);\r\n\r\n\t\tconst toLabel = document.createElement(\"span\");\r\n\t\ttoLabel.innerHTML = this._root.language.translate(\"To %1\", undefined, \"\") + \": \";\r\n\t\ttoGroup.appendChild(toLabel);\r\n\r\n\t\tconst toField = document.createElement(\"input\");\r\n\t\ttoField.type = \"text\";\r\n\t\ttoGroup.appendChild(toField);\r\n\t\tthis.setPrivate(\"toField\", toField);\r\n\r\n\t\t// Date pickers\r\n\t\tconst pickerLocale = this._getPickerLocale();\r\n\r\n\t\tconst fromPicker = flatpickr(fromField, {\r\n\t\t\tinline: true,\r\n\t\t\tappendTo: fromColumn,\r\n\t\t\tallowInput: true,\r\n\t\t\tlocale: pickerLocale,\r\n\t\t\tformatDate: (date) => {\r\n\t\t\t\treturn this._formatDate(date);\r\n\t\t\t},\r\n\t\t\tparseDate: (date) => {\r\n\t\t\t\treturn this._parseDate(date);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.setPrivate(\"fromPicker\", fromPicker);\r\n\r\n\t\tconst toPicker = flatpickr(toField, {\r\n\t\t\tinline: true,\r\n\t\t\tappendTo: toColumn,\r\n\t\t\tallowInput: true,\r\n\t\t\tlocale: pickerLocale,\r\n\t\t\tformatDate: (date) => {\r\n\t\t\t\treturn this._formatDate(date);\r\n\t\t\t},\r\n\t\t\tparseDate: (date) => {\r\n\t\t\t\treturn this._parseDate(date);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.setPrivate(\"toPicker\", toPicker);\r\n\r\n\r\n\t\t// Buttons\r\n\t\tconst buttons = document.createElement(\"div\")\r\n\t\tbuttons.className = \"am5stock-row\";\r\n\t\tcontainer.appendChild(buttons);\r\n\r\n\t\tconst buttonsColumn = document.createElement(\"div\")\r\n\t\tbuttonsColumn.className = \"am5stock-column\";\r\n\t\tcontainer.appendChild(buttonsColumn);\r\n\r\n\t\tconst saveButton = document.createElement(\"input\");\r\n\t\tsaveButton.type = \"button\";\r\n\t\tsaveButton.value = this._root.language.translateAny(\"Apply\");\r\n\t\tsaveButton.className = \"am5-modal-button am5-modal-primary\";\r\n\t\tbuttonsColumn.appendChild(saveButton);\r\n\r\n\t\t$utils.addEventListener(saveButton, \"click\", () => {\r\n\t\t\tconst xAxis = this._getAxis();\r\n\t\t\tconst from = this._parseDate(fromField.value);\r\n\t\t\tconst to = this._parseDate(toField.value);\r\n\t\t\txAxis.zoomToDates(from, to);\r\n\t\t\tthis._updateLabel();\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tconst cancelButton = document.createElement(\"input\");\r\n\t\tcancelButton.type = \"button\";\r\n\t\tcancelButton.value = this._root.language.translateAny(\"Cancel\");\r\n\t\tcancelButton.className = \"am5-modal-button am5-modal-scondary\";\r\n\t\tbuttonsColumn.appendChild(cancelButton);\r\n\r\n\t\t$utils.addEventListener(cancelButton, \"click\", () => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Calendar\");\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\t\t// if (this.isDirty(\"active\")) {\r\n\t\t// \tthis._initDropdown();\r\n\t\t// }\r\n\t}\r\n\r\n\tprotected _updateInputs(): void {\r\n\t\tconst xAxis = this._getAxis();\r\n\t\tconst from = new Date(xAxis!.getPrivate(\"selectionMin\", 0));\r\n\t\tconst to = new Date(xAxis!.getPrivate(\"selectionMax\", 0));\r\n\r\n\t\tthis.setPrivate(\"fromDate\", from);\r\n\t\tthis.setPrivate(\"toDate\", to);\r\n\r\n\t\tthis.getPrivate(\"fromField\").value = this._formatDate(from);\r\n\t\tthis.getPrivate(\"toField\").value = this._formatDate(to);\r\n\r\n\t\tthis.getPrivate(\"fromPicker\").setDate(from);\r\n\t\tthis.getPrivate(\"toPicker\").setDate(to);\r\n\t}\r\n\r\n\tprotected _updateLabel(): void {\r\n\t\tconst from = this.getPrivate(\"fromDate\");\r\n\t\tconst to = this.getPrivate(\"toDate\");\r\n\t\tlet label = \"\";\r\n\t\tif (from && to) {\r\n\t\t\tlabel = this._formatDate(from) + \" -- \" + this._formatDate(to);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlabel = this._root.language.translateAny(\"Date Range\");\r\n\t\t}\r\n\t\tthis.set(\"name\", label);\r\n\t}\r\n\r\n\tprotected _formatDate(date: Date): string {\r\n\t\treturn this._root.dateFormatter.format(date, this._getDateFormat());\r\n\t}\r\n\r\n\tprotected _parseDate(date: string): Date {\r\n\t\treturn this._root.dateFormatter.parse(date, this._getDateFormat());\r\n\t}\r\n\r\n\tprotected _getDateFormat(): string {\r\n\t\tconst format = this.get(\"dateFormat\", this._root.dateFormatter.get(\"dateFormat\"));\r\n\t\treturn $type.isString(format) ? format : \"MM/dd/yyyy\";\r\n\t}\r\n\r\n\tprotected _getAxis(): any {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst chart = stockChart.panels.getIndex(0)!;\r\n\t\tconst xAxis: any = chart.xAxes.getIndex(0)!;\r\n\t\treturn xAxis;\r\n\t}\r\n\r\n\tprotected _getPickerLocale(): any {\r\n\t\tconst l = this._root.language;\r\n\t\treturn {\r\n\t\t\tweekdays: {\r\n\t\t\t\tshorthand: [\r\n\t\t\t\t\tl.translate(\"Sun\"),\r\n\t\t\t\t\tl.translate(\"Mon\"),\r\n\t\t\t\t\tl.translate(\"Tue\"),\r\n\t\t\t\t\tl.translate(\"Wed\"),\r\n\t\t\t\t\tl.translate(\"Thu\"),\r\n\t\t\t\t\tl.translate(\"Fri\"),\r\n\t\t\t\t\tl.translate(\"Sat\")\r\n\t\t\t\t],\r\n\t\t\t\tlonghand: [\r\n\t\t\t\t\tl.translate(\"Sunday\"),\r\n\t\t\t\t\tl.translate(\"Monday\"),\r\n\t\t\t\t\tl.translate(\"Tuesday\"),\r\n\t\t\t\t\tl.translate(\"Wednesday\"),\r\n\t\t\t\t\tl.translate(\"Thursday\"),\r\n\t\t\t\t\tl.translate(\"Friday\"),\r\n\t\t\t\t\tl.translate(\"Saturday\"),\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\tmonths: {\r\n\t\t\t\tshorthand: [\r\n\t\t\t\t\tl.translate(\"Jan\"),\r\n\t\t\t\t\tl.translate(\"Feb\"),\r\n\t\t\t\t\tl.translate(\"Mar\"),\r\n\t\t\t\t\tl.translate(\"Apr\"),\r\n\t\t\t\t\tl.translate(\"May(short)\"),\r\n\t\t\t\t\tl.translate(\"Jun\"),\r\n\t\t\t\t\tl.translate(\"Jul\"),\r\n\t\t\t\t\tl.translate(\"Aug\"),\r\n\t\t\t\t\tl.translate(\"Sep\"),\r\n\t\t\t\t\tl.translate(\"Oct\"),\r\n\t\t\t\t\tl.translate(\"Nov\"),\r\n\t\t\t\t\tl.translate(\"Dec\"),\r\n\t\t\t\t],\r\n\t\t\t\tlonghand: [\r\n\t\t\t\t\tl.translate(\"January\"),\r\n\t\t\t\t\tl.translate(\"February\"),\r\n\t\t\t\t\tl.translate(\"March\"),\r\n\t\t\t\t\tl.translate(\"April\"),\r\n\t\t\t\t\tl.translate(\"May\"),\r\n\t\t\t\t\tl.translate(\"June\"),\r\n\t\t\t\t\tl.translate(\"July\"),\r\n\t\t\t\t\tl.translate(\"August\"),\r\n\t\t\t\t\tl.translate(\"September\"),\r\n\t\t\t\t\tl.translate(\"October\"),\r\n\t\t\t\t\tl.translate(\"November\"),\r\n\t\t\t\t\tl.translate(\"December\"),\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\tfirstDayOfWeek: l.translate(\"firstDayOfWeek\"),\r\n\t\t\tordinal: l.translateFunc(\"_dateOrd\"),\r\n\t\t\trangeSeparator: \" \" + l.translateAny(\"to\") + \" \",\r\n\t\t\tweekAbbreviation: l.translateAny(\"Wk\"),\r\n\t\t\tscrollTitle: l.translateAny(\"Scroll to increment\"),\r\n\t\t\ttoggleTitle: l.translateAny(\"Click to toggle\"),\r\n\t\t\tamPM: [l.translate(\"AM\"), l.translate(\"PM\")],\r\n\t\t\tyearAriaLabel: l.translateAny(\"Year\"),\r\n\t\t\tmonthAriaLabel: l.translateAny(\"Month\"),\r\n\t\t\thourAriaLabel: l.translateAny(\"Hour\"),\r\n\t\t\tminuteAriaLabel: l.translateAny(\"Minute\"),\r\n\t\t\ttime_24hr: true,\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Loads the default CSS.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tprotected _loadDefaultCSS(): void {\r\n\t\tconst ic = this._root.interfaceColors;\r\n\t\t//const active = ic.get(\"secondaryButton\")!.toCSS();\r\n\t\tconst primary = ic.get(\"primaryButton\")!.toCSS();\r\n\t\tconst primary2 = ic.get(\"primaryButtonHover\")!.toCSS();\r\n\t\tconst text = ic.get(\"text\")!.toCSS();\r\n\t\tconst border = ic.get(\"secondaryButtonActive\")!.toCSS();\r\n\t\tconst bg = ic.get(\"background\")!.toCSS();\r\n\r\n\t\tthis._disposers.push(new StyleSheet(null, `\r\n.flatpickr-calendar {\r\n  background: transparent;\r\n  opacity: 0;\r\n  display: none;\r\n  text-align: center;\r\n  visibility: hidden;\r\n  padding: 0;\r\n  -webkit-animation: none;\r\n          animation: none;\r\n  direction: ltr;\r\n  border: 0;\r\n  font-size: 0.7em;\r\n  line-height: 24px;\r\n  border-radius: 5px;\r\n  position: absolute;\r\n  width: 200px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  -ms-touch-action: manipulation;\r\n      touch-action: manipulation;\r\n  background: ${bg};\r\n  margin-top: 0.5em;\r\n}\r\n.flatpickr-calendar.open,\r\n.flatpickr-calendar.inline {\r\n  opacity: 1;\r\n  max-height: 640px;\r\n  visibility: visible;\r\n}\r\n.flatpickr-calendar.open {\r\n  display: inline-block;\r\n  z-index: 99999;\r\n}\r\n.flatpickr-calendar.animate.open {\r\n  -webkit-animation: fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);\r\n          animation: fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);\r\n}\r\n.flatpickr-calendar.inline {\r\n  display: block;\r\n  position: relative;\r\n  top: 2px;\r\n}\r\n.flatpickr-calendar.static {\r\n  position: absolute;\r\n  top: calc(100% + 2px);\r\n}\r\n.flatpickr-calendar.static.open {\r\n  z-index: 999;\r\n  display: block;\r\n}\r\n.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+1) .flatpickr-day.inRange:nth-child(7n+7) {\r\n  -webkit-box-shadow: none !important;\r\n          box-shadow: none !important;\r\n}\r\n.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+2) .flatpickr-day.inRange:nth-child(7n+1) {\r\n  -webkit-box-shadow: -2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;\r\n          box-shadow: -2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;\r\n}\r\n.flatpickr-calendar .hasWeeks .dayContainer,\r\n.flatpickr-calendar .hasTime .dayContainer {\r\n  border-bottom: 0;\r\n  border-bottom-right-radius: 0;\r\n  border-bottom-left-radius: 0;\r\n}\r\n.flatpickr-calendar .hasWeeks .dayContainer {\r\n  border-left: 0;\r\n}\r\n.flatpickr-calendar.hasTime .flatpickr-time {\r\n  height: 40px;\r\n  border-top: 1px solid ${border};\r\n}\r\n.flatpickr-calendar.noCalendar.hasTime .flatpickr-time {\r\n  height: auto;\r\n}\r\n.flatpickr-calendar:before,\r\n.flatpickr-calendar:after {\r\n  position: absolute;\r\n  display: block;\r\n  pointer-events: none;\r\n  border: solid transparent;\r\n  content: '';\r\n  height: 0;\r\n  width: 0;\r\n  left: 22px;\r\n}\r\n.flatpickr-calendar.rightMost:before,\r\n.flatpickr-calendar.arrowRight:before,\r\n.flatpickr-calendar.rightMost:after,\r\n.flatpickr-calendar.arrowRight:after {\r\n  left: auto;\r\n  right: 22px;\r\n}\r\n.flatpickr-calendar.arrowCenter:before,\r\n.flatpickr-calendar.arrowCenter:after {\r\n  left: 50%;\r\n  right: 50%;\r\n}\r\n.flatpickr-calendar:before {\r\n  border-width: 5px;\r\n  margin: 0 -5px;\r\n}\r\n.flatpickr-calendar:after {\r\n  border-width: 4px;\r\n  margin: 0 -4px;\r\n}\r\n.flatpickr-calendar.arrowTop:before,\r\n.flatpickr-calendar.arrowTop:after {\r\n  bottom: 100%;\r\n}\r\n.flatpickr-calendar.arrowTop:before {\r\n  border-bottom-color: ${border};\r\n}\r\n.flatpickr-calendar.arrowTop:after {\r\n  border-bottom-color: ${bg};\r\n}\r\n.flatpickr-calendar.arrowBottom:before,\r\n.flatpickr-calendar.arrowBottom:after {\r\n  top: 100%;\r\n}\r\n.flatpickr-calendar.arrowBottom:before {\r\n  border-top-color: ${border};\r\n}\r\n.flatpickr-calendar.arrowBottom:after {\r\n  border-top-color: ${bg};\r\n}\r\n.flatpickr-calendar:focus {\r\n  outline: 0;\r\n}\r\n.flatpickr-wrapper {\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n.flatpickr-months {\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n}\r\n.flatpickr-months .flatpickr-month {\r\n  background: transparent;\r\n  color: ${text};\r\n  fill: ${text};\r\n  height: 34px;\r\n  line-height: 1;\r\n  text-align: center;\r\n  position: relative;\r\n  -webkit-user-select: none;\r\n     -moz-user-select: none;\r\n      -ms-user-select: none;\r\n          user-select: none;\r\n  overflow: hidden;\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n}\r\n.flatpickr-months .flatpickr-prev-month,\r\n.flatpickr-months .flatpickr-next-month {\r\n  text-decoration: none;\r\n  cursor: pointer;\r\n  position: absolute;\r\n  top: 0;\r\n  height: 34px;\r\n  padding: 10px;\r\n  z-index: 3;\r\n  color: ${text};\r\n  fill: ${text};\r\n}\r\n.flatpickr-months .flatpickr-prev-month.flatpickr-disabled,\r\n.flatpickr-months .flatpickr-next-month.flatpickr-disabled {\r\n  display: none;\r\n}\r\n.flatpickr-months .flatpickr-prev-month i,\r\n.flatpickr-months .flatpickr-next-month i {\r\n  position: relative;\r\n}\r\n.flatpickr-months .flatpickr-prev-month.flatpickr-prev-month,\r\n.flatpickr-months .flatpickr-next-month.flatpickr-prev-month {\r\n/*\r\n      /*rtl:begin:ignore*/\r\n/*\r\n      */\r\n  left: 0;\r\n/*\r\n      /*rtl:end:ignore*/\r\n/*\r\n      */\r\n}\r\n/*\r\n      /*rtl:begin:ignore*/\r\n/*\r\n      /*rtl:end:ignore*/\r\n.flatpickr-months .flatpickr-prev-month.flatpickr-next-month,\r\n.flatpickr-months .flatpickr-next-month.flatpickr-next-month {\r\n/*\r\n      /*rtl:begin:ignore*/\r\n/*\r\n      */\r\n  right: 0;\r\n/*\r\n      /*rtl:end:ignore*/\r\n/*\r\n      */\r\n}\r\n/*\r\n      /*rtl:begin:ignore*/\r\n/*\r\n      /*rtl:end:ignore*/\r\n.flatpickr-months .flatpickr-prev-month:hover,\r\n.flatpickr-months .flatpickr-next-month:hover {\r\n  color: ${primary2};\r\n}\r\n.flatpickr-months .flatpickr-prev-month:hover svg,\r\n.flatpickr-months .flatpickr-next-month:hover svg {\r\n  fill: ${primary2};\r\n}\r\n.flatpickr-months .flatpickr-prev-month svg,\r\n.flatpickr-months .flatpickr-next-month svg {\r\n  width: 14px;\r\n  height: 14px;\r\n}\r\n.flatpickr-months .flatpickr-prev-month svg path,\r\n.flatpickr-months .flatpickr-next-month svg path {\r\n  -webkit-transition: fill 0.1s;\r\n  transition: fill 0.1s;\r\n  fill: inherit;\r\n}\r\n.numInputWrapper {\r\n  position: relative;\r\n  height: auto;\r\n}\r\n.numInputWrapper input,\r\n.numInputWrapper span {\r\n  display: inline-block;\r\n}\r\n.numInputWrapper input {\r\n  width: 100%;\r\n}\r\n.numInputWrapper input::-ms-clear {\r\n  display: none;\r\n}\r\n.numInputWrapper input::-webkit-outer-spin-button,\r\n.numInputWrapper input::-webkit-inner-spin-button {\r\n  margin: 0;\r\n  -webkit-appearance: none;\r\n}\r\n.numInputWrapper span {\r\n  position: absolute;\r\n  right: 0;\r\n  width: 14px;\r\n  padding: 0 4px 0 2px;\r\n  height: 50%;\r\n  line-height: 50%;\r\n  opacity: 0;\r\n  cursor: pointer;\r\n  border: 1px solid rgba(64,72,72,0.15);\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n}\r\n.numInputWrapper span:hover {\r\n  background: rgba(0,0,0,0.1);\r\n}\r\n.numInputWrapper span:active {\r\n  background: rgba(0,0,0,0.2);\r\n}\r\n.numInputWrapper span:after {\r\n  display: block;\r\n  content: \"\";\r\n  position: absolute;\r\n}\r\n.numInputWrapper span.arrowUp {\r\n  top: 0;\r\n  border-bottom: 0;\r\n}\r\n.numInputWrapper span.arrowUp:after {\r\n  border-left: 4px solid transparent;\r\n  border-right: 4px solid transparent;\r\n  border-bottom: 4px solid rgba(64,72,72,0.6);\r\n  top: 26%;\r\n}\r\n.numInputWrapper span.arrowDown {\r\n  top: 50%;\r\n}\r\n.numInputWrapper span.arrowDown:after {\r\n  border-left: 4px solid transparent;\r\n  border-right: 4px solid transparent;\r\n  border-top: 4px solid rgba(64,72,72,0.6);\r\n  top: 40%;\r\n}\r\n.numInputWrapper span svg {\r\n  width: inherit;\r\n  height: auto;\r\n}\r\n.numInputWrapper span svg path {\r\n  fill: rgba(60,63,64,0.5);\r\n}\r\n.numInputWrapper:hover {\r\n  background: rgba(0,0,0,0.05);\r\n}\r\n.numInputWrapper:hover span {\r\n  opacity: 1;\r\n}\r\n.flatpickr-current-month {\r\n  font-size: 135%;\r\n  line-height: inherit;\r\n  font-weight: 300;\r\n  color: inherit;\r\n  position: absolute;\r\n  width: 75%;\r\n  left: 12.5%;\r\n  padding: 7.48px 0 0 0;\r\n  line-height: 1;\r\n  height: 34px;\r\n  display: inline-block;\r\n  text-align: center;\r\n  -webkit-transform: translate3d(0px, 0px, 0px);\r\n          transform: translate3d(0px, 0px, 0px);\r\n}\r\n.flatpickr-current-month span.cur-month {\r\n  font-family: inherit;\r\n  font-weight: 700;\r\n  color: inherit;\r\n  display: inline-block;\r\n  margin-left: 0.5ch;\r\n  padding: 0;\r\n}\r\n.flatpickr-current-month span.cur-month:hover {\r\n  background: rgba(0,0,0,0.05);\r\n}\r\n.flatpickr-current-month .numInputWrapper {\r\n  width: 6ch;\r\n  width: 7ch\\\\0;\r\n  display: inline-block;\r\n}\r\n.flatpickr-current-month .numInputWrapper span.arrowUp:after {\r\n  border-bottom-color: ${text};\r\n}\r\n.flatpickr-current-month .numInputWrapper span.arrowDown:after {\r\n  border-top-color: ${text};\r\n}\r\n.flatpickr-current-month input.cur-year {\r\n  background: transparent;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  color: inherit;\r\n  cursor: text;\r\n  padding: 0 0 0 0.5ch;\r\n  margin: 0;\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  font-family: inherit;\r\n  font-weight: 300;\r\n  line-height: inherit;\r\n  height: auto;\r\n  border: 0;\r\n  border-radius: 0;\r\n  vertical-align: initial;\r\n  -webkit-appearance: textfield;\r\n  -moz-appearance: textfield;\r\n  appearance: textfield;\r\n}\r\n.flatpickr-current-month input.cur-year:focus {\r\n  outline: 0;\r\n}\r\n.flatpickr-current-month input.cur-year[disabled],\r\n.flatpickr-current-month input.cur-year[disabled]:hover {\r\n  font-size: 100%;\r\n  color: rgba(60,63,64,0.5);\r\n  background: transparent;\r\n  pointer-events: none;\r\n}\r\n.flatpickr-current-month .flatpickr-monthDropdown-months {\r\n  appearance: menulist;\r\n  background: transparent;\r\n  border: none;\r\n  border-radius: 0;\r\n  box-sizing: border-box;\r\n  color: inherit;\r\n  cursor: pointer;\r\n  font-size: inherit;\r\n  font-family: inherit;\r\n  font-weight: 300;\r\n  height: auto;\r\n  line-height: inherit;\r\n  margin: -1px 0 0 0;\r\n  outline: none;\r\n  padding: 0 0 0 0.5ch;\r\n  position: relative;\r\n  vertical-align: initial;\r\n  -webkit-box-sizing: border-box;\r\n  -webkit-appearance: menulist;\r\n  -moz-appearance: menulist;\r\n  width: auto;\r\n}\r\n.flatpickr-current-month .flatpickr-monthDropdown-months:focus,\r\n.flatpickr-current-month .flatpickr-monthDropdown-months:active {\r\n  outline: none;\r\n}\r\n.flatpickr-current-month .flatpickr-monthDropdown-months:hover {\r\n  background: rgba(0,0,0,0.05);\r\n}\r\n.flatpickr-current-month .flatpickr-monthDropdown-months .flatpickr-monthDropdown-month {\r\n  background-color: ${bg};\r\n  outline: none;\r\n  padding: 0;\r\n}\r\n.flatpickr-weekdays {\r\n  background: transparent;\r\n  text-align: center;\r\n  overflow: hidden;\r\n  width: 100%;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-align: center;\r\n  -webkit-align-items: center;\r\n      -ms-flex-align: center;\r\n          align-items: center;\r\n  height: 28px;\r\n}\r\n.flatpickr-weekdays .flatpickr-weekdaycontainer {\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n}\r\nspan.flatpickr-weekday {\r\n  cursor: default;\r\n  font-size: 90%;\r\n  background: transparent;\r\n  color: ${text};\r\n  line-height: 1;\r\n  margin: 0;\r\n  text-align: center;\r\n  display: block;\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n  font-weight: bolder;\r\n}\r\n.dayContainer,\r\n.flatpickr-weeks {\r\n  padding: 1px 0 0 0;\r\n}\r\n.flatpickr-days {\r\n  position: relative;\r\n  overflow: hidden;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-align: start;\r\n  -webkit-align-items: flex-start;\r\n      -ms-flex-align: start;\r\n          align-items: flex-start;\r\n  width: 200px;\r\n}\r\n.flatpickr-days:focus {\r\n  outline: 0;\r\n}\r\n.dayContainer {\r\n  padding: 0;\r\n  outline: 0;\r\n  text-align: left;\r\n  width: 200px;\r\n  min-width: 200px;\r\n  max-width: 200px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  display: inline-block;\r\n  display: -ms-flexbox;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: flex;\r\n  -webkit-flex-wrap: wrap;\r\n          flex-wrap: wrap;\r\n  -ms-flex-wrap: wrap;\r\n  -ms-flex-pack: justify;\r\n  -webkit-justify-content: space-around;\r\n          justify-content: space-around;\r\n  -webkit-transform: translate3d(0px, 0px, 0px);\r\n          transform: translate3d(0px, 0px, 0px);\r\n  opacity: 1;\r\n}\r\n.dayContainer + .dayContainer {\r\n  -webkit-box-shadow: -1px 0 0 ${border};\r\n          box-shadow: -1px 0 0 ${border};\r\n}\r\n.flatpickr-day {\r\n  background: none;\r\n  border: 1px solid transparent;\r\n  border-radius: 150px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  color: ${text};\r\n  cursor: pointer;\r\n  font-weight: 400;\r\n  width: 14.2857143%;\r\n  -webkit-flex-basis: 14.2857143%;\r\n      -ms-flex-preferred-size: 14.2857143%;\r\n          flex-basis: 14.2857143%;\r\n  max-width: 32px;\r\n  height: 32px;\r\n  line-height: 30px;\r\n  margin: 0;\r\n  display: inline-block;\r\n  position: relative;\r\n  -webkit-box-pack: center;\r\n  -webkit-justify-content: center;\r\n      -ms-flex-pack: center;\r\n          justify-content: center;\r\n  text-align: center;\r\n}\r\n.flatpickr-day.inRange,\r\n.flatpickr-day.prevMonthDay.inRange,\r\n.flatpickr-day.nextMonthDay.inRange,\r\n.flatpickr-day.today.inRange,\r\n.flatpickr-day.prevMonthDay.today.inRange,\r\n.flatpickr-day.nextMonthDay.today.inRange,\r\n.flatpickr-day:hover,\r\n.flatpickr-day.prevMonthDay:hover,\r\n.flatpickr-day.nextMonthDay:hover,\r\n.flatpickr-day:focus,\r\n.flatpickr-day.prevMonthDay:focus,\r\n.flatpickr-day.nextMonthDay:focus {\r\n  cursor: pointer;\r\n  outline: 0;\r\n  background: ${primary2};\r\n  border-color: ${primary2};\r\n}\r\n.flatpickr-day.today {\r\n  border-color: ${primary2};\r\n}\r\n.flatpickr-day.today:hover,\r\n.flatpickr-day.today:focus {\r\n  border-color: ${primary2};\r\n  background: ${primary2};\r\n  color: ${bg};\r\n}\r\n.flatpickr-day.selected,\r\n.flatpickr-day.startRange,\r\n.flatpickr-day.endRange,\r\n.flatpickr-day.selected.inRange,\r\n.flatpickr-day.startRange.inRange,\r\n.flatpickr-day.endRange.inRange,\r\n.flatpickr-day.selected:focus,\r\n.flatpickr-day.startRange:focus,\r\n.flatpickr-day.endRange:focus,\r\n.flatpickr-day.selected:hover,\r\n.flatpickr-day.startRange:hover,\r\n.flatpickr-day.endRange:hover,\r\n.flatpickr-day.selected.prevMonthDay,\r\n.flatpickr-day.startRange.prevMonthDay,\r\n.flatpickr-day.endRange.prevMonthDay,\r\n.flatpickr-day.selected.nextMonthDay,\r\n.flatpickr-day.startRange.nextMonthDay,\r\n.flatpickr-day.endRange.nextMonthDay {\r\n  background: ${primary};\r\n  -webkit-box-shadow: none;\r\n          box-shadow: none;\r\n  color: ${bg};\r\n  border-color: ${primary};\r\n}\r\n.flatpickr-day.selected.startRange,\r\n.flatpickr-day.startRange.startRange,\r\n.flatpickr-day.endRange.startRange {\r\n  border-radius: 50px 0 0 50px;\r\n}\r\n.flatpickr-day.selected.endRange,\r\n.flatpickr-day.startRange.endRange,\r\n.flatpickr-day.endRange.endRange {\r\n  border-radius: 0 50px 50px 0;\r\n}\r\n.flatpickr-day.selected.startRange + .endRange:not(:nth-child(7n+1)),\r\n.flatpickr-day.startRange.startRange + .endRange:not(:nth-child(7n+1)),\r\n.flatpickr-day.endRange.startRange + .endRange:not(:nth-child(7n+1)) {\r\n  -webkit-box-shadow: -10px 0 0 ${primary};\r\n          box-shadow: -10px 0 0 ${primary};\r\n}\r\n.flatpickr-day.selected.startRange.endRange,\r\n.flatpickr-day.startRange.startRange.endRange,\r\n.flatpickr-day.endRange.startRange.endRange {\r\n  border-radius: 50px;\r\n}\r\n.flatpickr-day.inRange {\r\n  border-radius: 0;\r\n  -webkit-box-shadow: -5px 0 0 ${primary2}, 5px 0 0 ${primary2};\r\n          box-shadow: -5px 0 0 ${primary2}, 5px 0 0 ${primary2};\r\n}\r\n.flatpickr-day.flatpickr-disabled,\r\n.flatpickr-day.flatpickr-disabled:hover,\r\n.flatpickr-day.prevMonthDay,\r\n.flatpickr-day.nextMonthDay,\r\n.flatpickr-day.notAllowed,\r\n.flatpickr-day.notAllowed.prevMonthDay,\r\n.flatpickr-day.notAllowed.nextMonthDay {\r\n  color: rgba(64,72,72,0.3);\r\n  background: transparent;\r\n  border-color: ${primary2};\r\n  cursor: default;\r\n}\r\n.flatpickr-day.flatpickr-disabled,\r\n.flatpickr-day.flatpickr-disabled:hover {\r\n  cursor: not-allowed;\r\n  color: rgba(64,72,72,0.1);\r\n}\r\n.flatpickr-day.week.selected {\r\n  border-radius: 0;\r\n  -webkit-box-shadow: -5px 0 0 ${primary}, 5px 0 0 ${primary};\r\n          box-shadow: -5px 0 0 ${primary}, 5px 0 0 ${primary};\r\n}\r\n.flatpickr-day.hidden {\r\n  visibility: hidden;\r\n}\r\n.rangeMode .flatpickr-day {\r\n  margin-top: 1px;\r\n}\r\n.flatpickr-weekwrapper {\r\n  float: left;\r\n}\r\n.flatpickr-weekwrapper .flatpickr-weeks {\r\n  padding: 0 12px;\r\n  -webkit-box-shadow: 1px 0 0 ${border};\r\n          box-shadow: 1px 0 0 ${border};\r\n}\r\n.flatpickr-weekwrapper .flatpickr-weekday {\r\n  float: none;\r\n  width: 100%;\r\n  line-height: 28px;\r\n}\r\n.flatpickr-weekwrapper span.flatpickr-day,\r\n.flatpickr-weekwrapper span.flatpickr-day:hover {\r\n  display: block;\r\n  width: 100%;\r\n  max-width: none;\r\n  color: rgba(64,72,72,0.3);\r\n  background: transparent;\r\n  cursor: default;\r\n  border: none;\r\n}\r\n.flatpickr-innerContainer {\r\n  display: block;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  overflow: hidden;\r\n}\r\n.flatpickr-rContainer {\r\n  display: inline-block;\r\n  padding: 0;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n}\r\n.flatpickr-time {\r\n  text-align: center;\r\n  outline: 0;\r\n  display: block;\r\n  height: 0;\r\n  line-height: 40px;\r\n  max-height: 40px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  overflow: hidden;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n}\r\n.flatpickr-time:after {\r\n  content: \"\";\r\n  display: table;\r\n  clear: both;\r\n}\r\n.flatpickr-time .numInputWrapper {\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n  width: 40%;\r\n  height: 40px;\r\n  float: left;\r\n}\r\n.flatpickr-time .numInputWrapper span.arrowUp:after {\r\n  border-bottom-color: ${text};\r\n}\r\n.flatpickr-time .numInputWrapper span.arrowDown:after {\r\n  border-top-color: ${text};\r\n}\r\n.flatpickr-time.hasSeconds .numInputWrapper {\r\n  width: 26%;\r\n}\r\n.flatpickr-time.time24hr .numInputWrapper {\r\n  width: 49%;\r\n}\r\n.flatpickr-time input {\r\n  background: transparent;\r\n  -webkit-box-shadow: none;\r\n          box-shadow: none;\r\n  border: 0;\r\n  border-radius: 0;\r\n  text-align: center;\r\n  margin: 0;\r\n  padding: 0;\r\n  height: inherit;\r\n  line-height: inherit;\r\n  color: ${text};\r\n  font-size: 14px;\r\n  position: relative;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  -webkit-appearance: textfield;\r\n  -moz-appearance: textfield;\r\n  appearance: textfield;\r\n}\r\n.flatpickr-time input.flatpickr-hour {\r\n  font-weight: bold;\r\n}\r\n.flatpickr-time input.flatpickr-minute,\r\n.flatpickr-time input.flatpickr-second {\r\n  font-weight: 400;\r\n}\r\n.flatpickr-time input:focus {\r\n  outline: 0;\r\n  border: 0;\r\n}\r\n.flatpickr-time .flatpickr-time-separator,\r\n.flatpickr-time .flatpickr-am-pm {\r\n  height: inherit;\r\n  float: left;\r\n  line-height: inherit;\r\n  color: ${text};\r\n  font-weight: bold;\r\n  width: 2%;\r\n  -webkit-user-select: none;\r\n     -moz-user-select: none;\r\n      -ms-user-select: none;\r\n          user-select: none;\r\n  -webkit-align-self: center;\r\n      -ms-flex-item-align: center;\r\n          align-self: center;\r\n}\r\n.flatpickr-time .flatpickr-am-pm {\r\n  outline: 0;\r\n  width: 18%;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  font-weight: 400;\r\n}\r\n.flatpickr-time input:hover,\r\n.flatpickr-time .flatpickr-am-pm:hover,\r\n.flatpickr-time input:focus,\r\n.flatpickr-time .flatpickr-am-pm:focus {\r\n  background: #f1f1f1;\r\n}\r\n.flatpickr-input[readonly] {\r\n  cursor: pointer;\r\n}\r\n@-webkit-keyframes fpFadeInDown {\r\n  from {\r\n    opacity: 0;\r\n    -webkit-transform: translate3d(0, -20px, 0);\r\n            transform: translate3d(0, -20px, 0);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    -webkit-transform: translate3d(0, 0, 0);\r\n            transform: translate3d(0, 0, 0);\r\n  }\r\n}\r\n@keyframes fpFadeInDown {\r\n  from {\r\n    opacity: 0;\r\n    -webkit-transform: translate3d(0, -20px, 0);\r\n            transform: translate3d(0, -20px, 0);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    -webkit-transform: translate3d(0, 0, 0);\r\n            transform: translate3d(0, 0, 0);\r\n  }\r\n}\r\n.flatpickr-calendar {\r\n  width: 200px;\r\n}\r\n.dayContainer {\r\n  padding: 0;\r\n  border-right: 0;\r\n}\r\nspan.flatpickr-day,\r\nspan.flatpickr-day.prevMonthDay,\r\nspan.flatpickr-day.nextMonthDay {\r\n  border-radius: 0 !important;\r\n  border: 1px solid ${primary2};\r\n  max-width: none;\r\n  border-right-color: transparent;\r\n}\r\nspan.flatpickr-day:nth-child(n+8),\r\nspan.flatpickr-day.prevMonthDay:nth-child(n+8),\r\nspan.flatpickr-day.nextMonthDay:nth-child(n+8) {\r\n  border-top-color: transparent;\r\n}\r\nspan.flatpickr-day:nth-child(7n-6),\r\nspan.flatpickr-day.prevMonthDay:nth-child(7n-6),\r\nspan.flatpickr-day.nextMonthDay:nth-child(7n-6) {\r\n  border-left: 0;\r\n}\r\nspan.flatpickr-day:nth-child(n+36),\r\nspan.flatpickr-day.prevMonthDay:nth-child(n+36),\r\nspan.flatpickr-day.nextMonthDay:nth-child(n+36) {\r\n  border-bottom: 0;\r\n}\r\nspan.flatpickr-day:nth-child(-n+7),\r\nspan.flatpickr-day.prevMonthDay:nth-child(-n+7),\r\nspan.flatpickr-day.nextMonthDay:nth-child(-n+7) {\r\n  margin-top: 0;\r\n}\r\nspan.flatpickr-day.today:not(.selected),\r\nspan.flatpickr-day.prevMonthDay.today:not(.selected),\r\nspan.flatpickr-day.nextMonthDay.today:not(.selected) {\r\n  border-color: ${primary2};\r\n  border-right-color: transparent;\r\n  border-top-color: transparent;\r\n  border-bottom-color: ${primary2};\r\n}\r\nspan.flatpickr-day.today:not(.selected):hover,\r\nspan.flatpickr-day.prevMonthDay.today:not(.selected):hover,\r\nspan.flatpickr-day.nextMonthDay.today:not(.selected):hover {\r\n  border: 1px solid ${primary2};\r\n}\r\nspan.flatpickr-day.startRange,\r\nspan.flatpickr-day.prevMonthDay.startRange,\r\nspan.flatpickr-day.nextMonthDay.startRange,\r\nspan.flatpickr-day.endRange,\r\nspan.flatpickr-day.prevMonthDay.endRange,\r\nspan.flatpickr-day.nextMonthDay.endRange {\r\n  border-color: ${primary};\r\n}\r\nspan.flatpickr-day.today,\r\nspan.flatpickr-day.prevMonthDay.today,\r\nspan.flatpickr-day.nextMonthDay.today,\r\nspan.flatpickr-day.selected,\r\nspan.flatpickr-day.prevMonthDay.selected,\r\nspan.flatpickr-day.nextMonthDay.selected {\r\n  z-index: 2;\r\n}\r\n.rangeMode .flatpickr-day {\r\n  margin-top: -1px;\r\n}\r\n.flatpickr-weekwrapper .flatpickr-weeks {\r\n  -webkit-box-shadow: none;\r\n          box-shadow: none;\r\n}\r\n.flatpickr-weekwrapper span.flatpickr-day {\r\n  border: 0;\r\n  margin: -1px 0 0 -1px;\r\n}\r\n.hasWeeks .flatpickr-days {\r\n  border-right: 0;\r\n}\r\n\r\n\t@media screen and (min-width:0\\\\0) and (min-resolution: +72dpi) {\r\n\t\tspan.flatpickr-day {\r\n\t\t\tdisplay: block;\r\n\t\t\t-webkit-box-flex: 1;\r\n\t\t\t-webkit-flex: 1 0 auto;\r\n\t\t\t    -ms-flex: 1 0 auto;\r\n\t\t\t        flex: 1 0 auto;\r\n\t\t}\r\n\t}\r\n\t\t`));\r\n\t}\r\n\r\n}","import type { TimeUnit } from \"../../../core/util/Time\"\r\n// import type { DateAxis } from \"../../xy/axes/DateAxis\";\r\n// import type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\";\r\nimport * as $time from \"../../../core/util/Time\";\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IPeriod {\r\n\ttimeUnit: TimeUnit | \"ytd\" | \"max\";\r\n\tcount?: number;\r\n\tname?: string;\r\n}\r\n\r\nexport interface IPeriodSelectorSettings extends IStockControlSettings {\r\n\r\n\t/**\r\n\t * A list periods to choose from.\r\n\t */\r\n\tperiods?: IPeriod[];\r\n\r\n}\r\n\r\nexport interface IPeriodSelectorPrivate extends IStockControlPrivate {\r\n}\r\n\r\nexport interface IPeriodSelectorEvents extends IStockControlEvents {\r\n}\r\n\r\n/**\r\n * A pre-defined period selector control for [[StockToolback]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/period-selector/} for more info\r\n */\r\nexport class PeriodSelector extends StockControl {\r\n\tpublic static className: string = \"PeriodSelector\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([PeriodSelector.className]);\r\n\r\n\tdeclare public _settings: IPeriodSelectorSettings;\r\n\tdeclare public _privateSettings: IPeriodSelectorPrivate;\r\n\tdeclare public _events: IPeriodSelectorEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-no-hover\";\r\n\r\n\t\tthis._initPeriodButtons();\r\n\t}\r\n\r\n\tprotected _initPeriodButtons(): void {\r\n\t\tconst container = this.getPrivate(\"label\")!;\r\n\t\tcontainer.style.display = \"\";\r\n\r\n\t\tconst periods = this.get(\"periods\", []);\r\n\t\t$array.each(periods, (period) => {\r\n\t\t\tconst button = document.createElement(\"a\");\r\n\t\t\tbutton.innerHTML = period.name || (period.timeUnit.toUpperCase() + period.count || \"1\");\r\n\t\t\tbutton.className = \"am5stock-link\";\r\n\t\t\tcontainer.appendChild(button);\r\n\r\n\t\t\tthis._disposers.push($utils.addEventListener(button, \"click\", (_ev) => {\r\n\t\t\t\tthis.selectPeriod(period);\r\n\t\t\t}));\r\n\t\t});\r\n\t}\r\n\r\n\t// protected _getDefaultIcon(): SVGElement {\r\n\t// \treturn StockIcons.getIcon(\"Period\");\r\n\t// }\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\t\t// if (this.isDirty(\"active\")) {\r\n\t\t// \tthis._initDropdown();\r\n\t\t// }\r\n\t}\r\n\r\n\tprotected _getChart(): any {\r\n\t\treturn this.get(\"stockChart\").panels.getIndex(0)!;\r\n\t}\r\n\r\n\tprotected _getAxis(): any {\r\n\t\treturn this._getChart().xAxes.getIndex(0)!;\r\n\t}\r\n\r\n\tpublic selectPeriod(period: IPeriod): void {\r\n\t\tif (period.timeUnit == \"max\") {\r\n\t\t\tthis._getChart().zoomOut();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst axis = this._getAxis();\r\n\t\t\tlet end = new Date(axis.getPrivate(\"max\"));\r\n\t\t\tlet start: Date;\r\n\t\t\tif (period.timeUnit == \"ytd\") {\r\n\t\t\t\tstart = new Date(end.getFullYear(), 0, 1, 0, 0, 0, 0);\r\n\t\t\t\tend = new Date(axis.getIntervalMax(axis.get(\"baseInterval\")));\r\n\t\t\t\tif (axis.get(\"groupData\")) {\r\n\t\t\t\t\taxis.zoomToDates(start, end, 0);\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\taxis.zoomToDates(start, end, 0);\r\n\t\t\t\t\t}, 10);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// some adjustments in case data is grouped\r\n\t\t\t\tif (axis.get(\"groupData\")) {\r\n\t\t\t\t\t// find interval which will be used after zoom\r\n\t\t\t\t\tconst interval = axis.getGroupInterval($time.getDuration(period.timeUnit, period.count))\r\n\t\t\t\t\tif (interval) {\r\n\t\t\t\t\t\t// find max of the base interval\r\n\t\t\t\t\t\tlet endTime = axis.getIntervalMax(axis.get(\"baseInterval\"));\r\n\r\n\t\t\t\t\t\tif (endTime != null) {\r\n\t\t\t\t\t\t\t// round to the future interval\r\n\t\t\t\t\t\t\tend = $time.round(new Date(endTime), interval.timeUnit, interval.count);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tstart = $time.add(new Date(end), period.timeUnit, (period.count || 1) * -1);\r\n\t\t\t\t\t\taxis.zoomToDates(start, end, 0);\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\taxis.zoomToDates(start, end, 0);\r\n\t\t\t\t\t\t}, 10);\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstart = $time.add(new Date(end), period.timeUnit, (period.count || 1) * -1);\r\n\t\t\t}\r\n\t\t\taxis.zoomToDates(start, end);\r\n\t\t}\r\n\t}\r\n\r\n}","import { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\n\r\nexport interface ISeriesTypeControlSettings extends IDropdownListControlSettings {\r\n}\r\n\r\nexport interface ISeriesTypeControlPrivate extends IDropdownListControlPrivate {\r\n}\r\n\r\nexport interface ISeriesTypeControlEvents extends IDropdownListControlEvents {\r\n}\r\n\r\n/**\r\n * A control that is used to change type of the main series of the [[StockChart]].\r\n */\r\nexport class SeriesTypeControl extends DropdownListControl {\r\n\tpublic static className: string = \"SeriesTypeControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([SeriesTypeControl.className]);\r\n\r\n\tdeclare public _settings: ISeriesTypeControlSettings;\r\n\tdeclare public _privateSettings: ISeriesTypeControlPrivate;\r\n\tdeclare public _events: ISeriesTypeControlEvents;\r\n\r\n}","import type { IDropdownListItem } from \"./DropdownList\";\r\nimport type { TimeUnit } from \"../../../core/util/Time\";\r\n\r\nimport { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nexport interface IIntervalControlItem extends IDropdownListItem {\r\n\tinterval: {\r\n\t\ttimeUnit: TimeUnit,\r\n\t\tcount?: number\r\n\t};\r\n}\r\n\r\nexport interface IIntervalControlSettings extends IDropdownListControlSettings {\r\n\tcurrentItem?: string | IIntervalControlItem;\r\n\titems?: Array<string | IIntervalControlItem>;\r\n}\r\n\r\nexport interface IIntervalControlPrivate extends IDropdownListControlPrivate {\r\n}\r\n\r\nexport interface IIntervalControlEvents extends IDropdownListControlEvents {\r\n}\r\n\r\n/**\r\n * A control that is used to change type of the main series of the [[StockChart]].\r\n */\r\nexport class IntervalControl extends DropdownListControl {\r\n\tpublic static className: string = \"IntervalControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([IntervalControl.className]);\r\n\r\n\tdeclare public _settings: IIntervalControlSettings;\r\n\tdeclare public _privateSettings: IIntervalControlPrivate;\r\n\tdeclare public _events: IIntervalControlEvents;\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Interval\");\r\n\t}\r\n\r\n}","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nexport interface IResetControlSettings extends IStockControlSettings {\r\n}\r\n\r\nexport interface IResetControlPrivate extends IStockControlPrivate {\r\n}\r\n\r\nexport interface IResetControlEvents extends IStockControlEvents {\r\n}\r\n\r\n/**\r\n * Reset control.\r\n *\r\n * Removes all drawings and indicators when clicked.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/reset-control/} for more info\r\n */\r\nexport class ResetControl extends StockControl {\r\n\tpublic static className: string = \"ResetControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([ResetControl.className]);\r\n\r\n\tdeclare public _settings: IResetControlSettings;\r\n\tdeclare public _privateSettings: IResetControlPrivate;\r\n\tdeclare public _events: IResetControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.events.on(\"click\", () => {\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tstockChart.panels.each((panel) => {\r\n\t\t\t\tpanel.drawings.clear();\r\n\t\t\t});\r\n\r\n\t\t\tstockChart.indicators.clear();\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Reset\");\r\n\t}\r\n\r\n}","import type { IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface ISettingsControlItem extends IDropdownListItem {\r\n}\r\n\r\nexport interface ISettingsControlSettings extends IDropdownListControlSettings {\r\n}\r\n\r\nexport interface ISettingsControlPrivate extends IDropdownListControlPrivate {\r\n}\r\n\r\nexport interface ISettingsControlEvents extends IDropdownListControlEvents {\r\n}\r\n\r\n/**\r\n * A control that is used to change type of the main series of the [[StockChart]].\r\n */\r\nexport class SettingsControl extends DropdownListControl {\r\n\tpublic static className: string = \"SettingsControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([SettingsControl.className]);\r\n\r\n\tdeclare public _settings: ISettingsControlSettings;\r\n\tdeclare public _privateSettings: ISettingsControlPrivate;\r\n\tdeclare public _events: ISettingsControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst dropdown = this.getPrivate(\"dropdown\")!;\r\n\t\tdropdown.events.on(\"changed\", (ev) => {\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\t\tif (stockSeries) {\r\n\t\t\t\tif (ev.item.id == \"y-scale\") {\r\n\t\t\t\t\tif (ev.item.value == \"percent\") {\r\n\t\t\t\t\t\tstockChart.setPercentScale(true);\r\n\t\t\t\t\t\tthis._setLogarithmic(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tstockChart.setPercentScale(false);\r\n\t\t\t\t\t\tthis._setLogarithmic(ev.item.value == \"logarithmic\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (ev.item.id == \"fills\") {\r\n\t\t\t\t\tthis._setFills((<any>ev).checked)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", () => {\r\n\t\t\tthis._populateInputs();\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t// public _afterChanged() {\r\n\t// \tsuper._afterChanged();\r\n\t// }\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Settings\");\r\n\t}\r\n\r\n\tprotected _populateInputs(): void {\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tconst inputs = button.getElementsByTagName(\"input\");\r\n\t\tconst currentScale = this._getYScale();\r\n\t\tfor (let i = 0; i < inputs.length; i++) {\r\n\t\t\tconst input = inputs[i];\r\n\t\t\tswitch (input.id) {\r\n\t\t\t\tcase \"am5stock-list-fills\":\r\n\t\t\t\t\tinput.checked = this._getFillEnabled()\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"am5stock-list-y-scale-percent\":\r\n\t\t\t\tcase \"am5stock-list-y-scale-regular\":\r\n\t\t\t\tcase \"am5stock-list-y-scale-logarithmic\":\r\n\t\t\t\t\tinput.checked = input.value == currentScale;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _getFillEnabled(): boolean {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\tif (stockSeries) {\r\n\t\t\tconst xAxis = stockSeries.get(\"xAxis\");\r\n\t\t\tconst fills = xAxis.get(\"renderer\").axisFills.values;\r\n\t\t\treturn (fills.length > 0) && fills[0].get(\"visible\", false);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected _getYScale(): \"percent\" | \"regular\" | \"logarithmic\" {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\tif (stockSeries) {\r\n\t\t\tconst yAxis = stockSeries.get(\"yAxis\");\r\n\t\t\tif (yAxis instanceof ValueAxis) {\r\n\t\t\t\tif (stockSeries.get(\"valueYShow\") == \"valueYChangeSelectionPercent\") {\r\n\t\t\t\t\treturn \"percent\";\r\n\t\t\t\t}\r\n\t\t\t\tif (yAxis.get(\"logarithmic\")) {\r\n\t\t\t\t\treturn \"logarithmic\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"regular\";\r\n\t}\r\n\r\n\tprotected _setLogarithmic(value: boolean): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\tif (stockSeries) {\r\n\t\t\tconst yAxis = stockSeries.get(\"yAxis\");\r\n\t\t\tif (yAxis instanceof ValueAxis) {\r\n\r\n\t\t\t\t$array.each(yAxis.series, (series) => {\r\n\t\t\t\t\tseries.resetExtremes();\r\n\t\t\t\t})\r\n\r\n\t\t\t\tyAxis.set(\"logarithmic\", value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setFills(enabled: boolean): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.panels.each((panel) => {\r\n\t\t\tpanel.xAxes.each((xAxis) => {\r\n\t\t\t\txAxis.get(\"renderer\").axisFills.template.set(\"visible\", enabled);\r\n\t\t\t\txAxis.get(\"renderer\").grid.template.set(\"forceHidden\", enabled);\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n}","import type { IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nexport interface IComparisonControlSettings extends IDropdownListControlSettings {\r\n\titems?: Array<string | IDropdownListItem>;\r\n}\r\n\r\nexport interface IComparisonControlPrivate extends IDropdownListControlPrivate {\r\n}\r\n\r\nexport interface IComparisonControlEvents extends IDropdownListControlEvents {\r\n}\r\n\r\n/**\r\n * A control that is used to change type of the main series of the [[StockChart]].\r\n */\r\nexport class ComparisonControl extends DropdownListControl {\r\n\tpublic static className: string = \"ComparisonControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([ComparisonControl.className]);\r\n\r\n\tdeclare public _settings: IComparisonControlSettings;\r\n\tdeclare public _privateSettings: IComparisonControlPrivate;\r\n\tdeclare public _events: IComparisonControlEvents;\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Comparison\");\r\n\t}\r\n\r\n}","\"use strict\";\nif (typeof Object.assign !== \"function\") {\n    Object.assign = function (target) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (!target) {\n            throw TypeError(\"Cannot convert undefined or null to object\");\n        }\n        var _loop_1 = function (source) {\n            if (source) {\n                Object.keys(source).forEach(function (key) { return (target[key] = source[key]); });\n            }\n        };\n        for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n            var source = args_1[_a];\n            _loop_1(source);\n        }\n        return target;\n    };\n}\n","(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(['module'], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(module);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod);\n    global.regression = mod.exports;\n  }\n})(this, function (module) {\n  'use strict';\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  var _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  function _toConsumableArray(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n        arr2[i] = arr[i];\n      }\n\n      return arr2;\n    } else {\n      return Array.from(arr);\n    }\n  }\n\n  var DEFAULT_OPTIONS = { order: 2, precision: 2, period: null };\n\n  /**\n  * Determine the coefficient of determination (r^2) of a fit from the observations\n  * and predictions.\n  *\n  * @param {Array<Array<number>>} data - Pairs of observed x-y values\n  * @param {Array<Array<number>>} results - Pairs of observed predicted x-y values\n  *\n  * @return {number} - The r^2 value, or NaN if one cannot be calculated.\n  */\n  function determinationCoefficient(data, results) {\n    var predictions = [];\n    var observations = [];\n\n    data.forEach(function (d, i) {\n      if (d[1] !== null) {\n        observations.push(d);\n        predictions.push(results[i]);\n      }\n    });\n\n    var sum = observations.reduce(function (a, observation) {\n      return a + observation[1];\n    }, 0);\n    var mean = sum / observations.length;\n\n    var ssyy = observations.reduce(function (a, observation) {\n      var difference = observation[1] - mean;\n      return a + difference * difference;\n    }, 0);\n\n    var sse = observations.reduce(function (accum, observation, index) {\n      var prediction = predictions[index];\n      var residual = observation[1] - prediction[1];\n      return accum + residual * residual;\n    }, 0);\n\n    return 1 - sse / ssyy;\n  }\n\n  /**\n  * Determine the solution of a system of linear equations A * x = b using\n  * Gaussian elimination.\n  *\n  * @param {Array<Array<number>>} input - A 2-d matrix of data in row-major form [ A | b ]\n  * @param {number} order - How many degrees to solve for\n  *\n  * @return {Array<number>} - Vector of normalized solution coefficients matrix (x)\n  */\n  function gaussianElimination(input, order) {\n    var matrix = input;\n    var n = input.length - 1;\n    var coefficients = [order];\n\n    for (var i = 0; i < n; i++) {\n      var maxrow = i;\n      for (var j = i + 1; j < n; j++) {\n        if (Math.abs(matrix[i][j]) > Math.abs(matrix[i][maxrow])) {\n          maxrow = j;\n        }\n      }\n\n      for (var k = i; k < n + 1; k++) {\n        var tmp = matrix[k][i];\n        matrix[k][i] = matrix[k][maxrow];\n        matrix[k][maxrow] = tmp;\n      }\n\n      for (var _j = i + 1; _j < n; _j++) {\n        for (var _k = n; _k >= i; _k--) {\n          matrix[_k][_j] -= matrix[_k][i] * matrix[i][_j] / matrix[i][i];\n        }\n      }\n    }\n\n    for (var _j2 = n - 1; _j2 >= 0; _j2--) {\n      var total = 0;\n      for (var _k2 = _j2 + 1; _k2 < n; _k2++) {\n        total += matrix[_k2][_j2] * coefficients[_k2];\n      }\n\n      coefficients[_j2] = (matrix[n][_j2] - total) / matrix[_j2][_j2];\n    }\n\n    return coefficients;\n  }\n\n  /**\n  * Round a number to a precision, specificed in number of decimal places\n  *\n  * @param {number} number - The number to round\n  * @param {number} precision - The number of decimal places to round to:\n  *                             > 0 means decimals, < 0 means powers of 10\n  *\n  *\n  * @return {numbr} - The number, rounded\n  */\n  function round(number, precision) {\n    var factor = Math.pow(10, precision);\n    return Math.round(number * factor) / factor;\n  }\n\n  /**\n  * The set of all fitting methods\n  *\n  * @namespace\n  */\n  var methods = {\n    linear: function linear(data, options) {\n      var sum = [0, 0, 0, 0, 0];\n      var len = 0;\n\n      for (var n = 0; n < data.length; n++) {\n        if (data[n][1] !== null) {\n          len++;\n          sum[0] += data[n][0];\n          sum[1] += data[n][1];\n          sum[2] += data[n][0] * data[n][0];\n          sum[3] += data[n][0] * data[n][1];\n          sum[4] += data[n][1] * data[n][1];\n        }\n      }\n\n      var run = len * sum[2] - sum[0] * sum[0];\n      var rise = len * sum[3] - sum[0] * sum[1];\n      var gradient = run === 0 ? 0 : round(rise / run, options.precision);\n      var intercept = round(sum[1] / len - gradient * sum[0] / len, options.precision);\n\n      var predict = function predict(x) {\n        return [round(x, options.precision), round(gradient * x + intercept, options.precision)];\n      };\n\n      var points = data.map(function (point) {\n        return predict(point[0]);\n      });\n\n      return {\n        points: points,\n        predict: predict,\n        equation: [gradient, intercept],\n        r2: round(determinationCoefficient(data, points), options.precision),\n        string: intercept === 0 ? 'y = ' + gradient + 'x' : 'y = ' + gradient + 'x + ' + intercept\n      };\n    },\n    exponential: function exponential(data, options) {\n      var sum = [0, 0, 0, 0, 0, 0];\n\n      for (var n = 0; n < data.length; n++) {\n        if (data[n][1] !== null) {\n          sum[0] += data[n][0];\n          sum[1] += data[n][1];\n          sum[2] += data[n][0] * data[n][0] * data[n][1];\n          sum[3] += data[n][1] * Math.log(data[n][1]);\n          sum[4] += data[n][0] * data[n][1] * Math.log(data[n][1]);\n          sum[5] += data[n][0] * data[n][1];\n        }\n      }\n\n      var denominator = sum[1] * sum[2] - sum[5] * sum[5];\n      var a = Math.exp((sum[2] * sum[3] - sum[5] * sum[4]) / denominator);\n      var b = (sum[1] * sum[4] - sum[5] * sum[3]) / denominator;\n      var coeffA = round(a, options.precision);\n      var coeffB = round(b, options.precision);\n      var predict = function predict(x) {\n        return [round(x, options.precision), round(coeffA * Math.exp(coeffB * x), options.precision)];\n      };\n\n      var points = data.map(function (point) {\n        return predict(point[0]);\n      });\n\n      return {\n        points: points,\n        predict: predict,\n        equation: [coeffA, coeffB],\n        string: 'y = ' + coeffA + 'e^(' + coeffB + 'x)',\n        r2: round(determinationCoefficient(data, points), options.precision)\n      };\n    },\n    logarithmic: function logarithmic(data, options) {\n      var sum = [0, 0, 0, 0];\n      var len = data.length;\n\n      for (var n = 0; n < len; n++) {\n        if (data[n][1] !== null) {\n          sum[0] += Math.log(data[n][0]);\n          sum[1] += data[n][1] * Math.log(data[n][0]);\n          sum[2] += data[n][1];\n          sum[3] += Math.pow(Math.log(data[n][0]), 2);\n        }\n      }\n\n      var a = (len * sum[1] - sum[2] * sum[0]) / (len * sum[3] - sum[0] * sum[0]);\n      var coeffB = round(a, options.precision);\n      var coeffA = round((sum[2] - coeffB * sum[0]) / len, options.precision);\n\n      var predict = function predict(x) {\n        return [round(x, options.precision), round(round(coeffA + coeffB * Math.log(x), options.precision), options.precision)];\n      };\n\n      var points = data.map(function (point) {\n        return predict(point[0]);\n      });\n\n      return {\n        points: points,\n        predict: predict,\n        equation: [coeffA, coeffB],\n        string: 'y = ' + coeffA + ' + ' + coeffB + ' ln(x)',\n        r2: round(determinationCoefficient(data, points), options.precision)\n      };\n    },\n    power: function power(data, options) {\n      var sum = [0, 0, 0, 0, 0];\n      var len = data.length;\n\n      for (var n = 0; n < len; n++) {\n        if (data[n][1] !== null) {\n          sum[0] += Math.log(data[n][0]);\n          sum[1] += Math.log(data[n][1]) * Math.log(data[n][0]);\n          sum[2] += Math.log(data[n][1]);\n          sum[3] += Math.pow(Math.log(data[n][0]), 2);\n        }\n      }\n\n      var b = (len * sum[1] - sum[0] * sum[2]) / (len * sum[3] - Math.pow(sum[0], 2));\n      var a = (sum[2] - b * sum[0]) / len;\n      var coeffA = round(Math.exp(a), options.precision);\n      var coeffB = round(b, options.precision);\n\n      var predict = function predict(x) {\n        return [round(x, options.precision), round(round(coeffA * Math.pow(x, coeffB), options.precision), options.precision)];\n      };\n\n      var points = data.map(function (point) {\n        return predict(point[0]);\n      });\n\n      return {\n        points: points,\n        predict: predict,\n        equation: [coeffA, coeffB],\n        string: 'y = ' + coeffA + 'x^' + coeffB,\n        r2: round(determinationCoefficient(data, points), options.precision)\n      };\n    },\n    polynomial: function polynomial(data, options) {\n      var lhs = [];\n      var rhs = [];\n      var a = 0;\n      var b = 0;\n      var len = data.length;\n      var k = options.order + 1;\n\n      for (var i = 0; i < k; i++) {\n        for (var l = 0; l < len; l++) {\n          if (data[l][1] !== null) {\n            a += Math.pow(data[l][0], i) * data[l][1];\n          }\n        }\n\n        lhs.push(a);\n        a = 0;\n\n        var c = [];\n        for (var j = 0; j < k; j++) {\n          for (var _l = 0; _l < len; _l++) {\n            if (data[_l][1] !== null) {\n              b += Math.pow(data[_l][0], i + j);\n            }\n          }\n          c.push(b);\n          b = 0;\n        }\n        rhs.push(c);\n      }\n      rhs.push(lhs);\n\n      var coefficients = gaussianElimination(rhs, k).map(function (v) {\n        return round(v, options.precision);\n      });\n\n      var predict = function predict(x) {\n        return [round(x, options.precision), round(coefficients.reduce(function (sum, coeff, power) {\n          return sum + coeff * Math.pow(x, power);\n        }, 0), options.precision)];\n      };\n\n      var points = data.map(function (point) {\n        return predict(point[0]);\n      });\n\n      var string = 'y = ';\n      for (var _i = coefficients.length - 1; _i >= 0; _i--) {\n        if (_i > 1) {\n          string += coefficients[_i] + 'x^' + _i + ' + ';\n        } else if (_i === 1) {\n          string += coefficients[_i] + 'x + ';\n        } else {\n          string += coefficients[_i];\n        }\n      }\n\n      return {\n        string: string,\n        points: points,\n        predict: predict,\n        equation: [].concat(_toConsumableArray(coefficients)).reverse(),\n        r2: round(determinationCoefficient(data, points), options.precision)\n      };\n    }\n  };\n\n  function createWrapper() {\n    var reduce = function reduce(accumulator, name) {\n      return _extends({\n        _round: round\n      }, accumulator, _defineProperty({}, name, function (data, supplied) {\n        return methods[name](data, _extends({}, DEFAULT_OPTIONS, supplied));\n      }));\n    };\n\n    return Object.keys(methods).reduce(reduce, {});\n  }\n\n  module.exports = createWrapper();\n});\n","import * as m from \"./../../dist/es2015/stock.js\";\nexport const am5stock = m;"],"names":["rules","children","push","Button","_root","themeTags","icon","Graphics","_afterNew","upButton","this","downButton","events","on","get","moveDown","moveUp","closeButton","close","expandButton","expand","Container","PanelControls","className","id","icons","StockIcons","_getSVG","svg","document","createElementNS","setAttribute","viewbox","path","appendChild","style","setupDefaultRules","l","language","r","rule","bind","verticalLayout","ic","interfaceColors","setAll","paddingLeft","paddingRight","paddingTop","paddingBottom","width","height","layout","percentScaleSeriesSettings","valueYShow","openValueYShow","highValueYShow","lowValueYShow","percentScaleValueAxisSettings","numberFormat","interpolationDuration","extraMax","strictMinMaxSelection","autoSetPercentScale","minHeight","clickTarget","fontSize","marginLeft","marginRight","marginTop","marginBottom","useLastColorForLegendMarker","fillOpacity","cornerRadiusBL","cornerRadiusBR","cornerRadiusTL","cornerRadiusTR","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowBlur","interactive","centerY","fill","cursorOverStyle","states","create","strokeOpacity","forceHidden","opposite","visible","position","x","y","centerX","layer","horizontalLayout","opacity","scale","strokeWidth","draw","display","moveTo","lineTo","drawCircle","angleStep","angle","dAngle","i","Math","cos","sin","radius","draggable","strokeDasharray","stateRule","hoverRule","p0","rotationStep","isMeasured","sequence","colors","snapToData","forceInactive","populateText","text","legendLabelText","legendValueText","stroke","adapters","add","target","dataItem","dataContext","volumeColor","name","shortName","seriesColor","type","field","period","offset","upperColor","lowerColor","shift","shiftType","increasingColor","decreasingColor","useVolume","movingAverageType","slowPeriod","standardDeviations","overSold","overBought","overSoldColor","overBoughtColor","kSmoothing","dSmoothing","slowColor","limitMoveValue","positiveColor","negativeColor","upColor","downColor","fastPeriod","signalPeriod","signalColor","set","active","translateAny","indicators","drawingIcons","svgPath","fillDisabled","tool","tools","togglable","strokeColor","strokeWidths","strokeDasharrays","showExtension","fillColor","labelFill","labelFontSize","labelFontSizes","labelFontWeight","labelFontStyle","labelFontFamily","labelFontFamilies","drawingIcon","useOpacity","description","periods","timeUnit","count","fixedLabel","searchable","maxSearchItems","items","currentItem","label","getIcon","interval","ColorSet","form","value","Theme","_defaultThemes","_afterNewApplyThemes","_initElements","_applyClassNames","addDisposer","button","createElement","setPrivate","_getIcon","innerHTML","_disposers","ev","_handleClick","isEnabled","dispatch","originalEvent","getPrivate","userIcon","_getDefaultIcon","_beforeChanged","isDirty","_setLabel","_dispose","Entity","StockControl","isOpen","keyCode","hide","preventDefault","container","stopPropagation","arrow","parent","toolbarContainer","round","getBoundingClientRect","right","abs","show","Dropdown","list","_initItems","cs","item","addItem","_initOpacity","isPrivateDirty","color","currentColor","hex","background","toCSS","_ev","currentOpacity","hr","classNames","concat","DropdownColors","element","root","_prefix","hover","border","bg","StyleRule","undefined","dispose","increment","dropdownSettings","control","dropdown","setTimeout","onPrivate","backgroundColor","loadDefaultCSS","disposer","StockToolbarCSS","dom","ColorControl","_settingsTarget","initContent","_editableSettings","series","stockChart","settings","key","currentValue","CandlestickSeries","columns","length","column","getIndex","additionalKeys","lookup","template","invalidateTarget","LineSeries","options","strokes","fills","_updatedSettings","content","clear","title","table","prevLine","settingInputs","settingsWithTarget","prevName","setting","_getSettingKey","keyTarget","getDropdown","getNumber","getColor","getCheckbox","line","heading","cell","saveButton","checked","targetKey","split","pop","additonalKey","markDirtyValues","cancelButton","cancel","open","option","optionElement","selected","_setting","settingsTarget","_colorControl","Modal","List","_settings","StockChartDefaultTheme","XYChartDefaultTheme","tooltipContainer","panelsContainer","panels","onAll","change","oldValues","chart","_removePanel","moveValue","newValue","_processPanel","setIndex","index","insertIndex","Error","oldValue","indicator","_removeIndicator","_processIndicator","setPrivateRaw","SettingsModal","license","match","_licenseApplied","_showBranding","volumeSeries","isType","each","_markDirtyKey","stockSeries","dataItems","dropFromOpen","riseFromOpen","_applyGraphicsStates","mainChart","_prevSettings","setPercentScale","_prepareChildren","percentScale","seriesSettings","axisSettings","_maybePrepAxisDefaults","_maybePrepSeriesDefaults","apply","comparingSeriesSettings","comparedSeries","legendDataItem","legend","component","data","ldi","removeComparingSeries","removeValue","_val","axis","prepareData","panel","panelControls","indexOf","len","values","topPlotContainer","stockPanel","_updateControls","resizer","Rectangle","e","chartsContainer","_downResizer","_downY","toLocal","point","upperChart","_upperPanel","_uhp","_dhp","max","lowerChart","min","downY","dhp","uhp","diff","xAxes","_removeXAxis","_processXAxis","leftAxesContainer","_syncYAxesSize","rightAxesContainer","maxLeft","maxRight","lw","rw","toolsContainer","_axis","_xAxes","_skipSync","_syncXAxes","xAxis","Color","stockDataItem","previousClose","StockChart","_dataDirty","_sDP","markDataDirty","_vDP","setCustomData","markDirty","_updateChildren","_updateSeriesColor","contextName","BaseColumnSeries","toCSSHex","customData","o","h","c","valueX","value_y","_getValue","toField","ma","valueToRemove","sum","m","k","n","pValue","multiplier","ema2","_ema","ema","ema3","_dema","Indicator","Template","closeButtons","settingsButtons","make","openIndicator","openSeries","processDataItem","itemContainer","settingsButton","makeSettingsButton","_setDataItem","makeCloseButton","Legend","StockLegend","drawings","removeIndex","isVisible","XYChart","StockPanel","seriesChart","_themeTag","wheelY","panX","panY","addTag","seriesXAxis","xRenderer","AxisRendererX","baseInterval","start","end","GaplessDateAxis","renderer","DateAxis","Tooltip","yRenderer","AxisRendererY","yAxis","yAxes","ValueAxis","tooltip","_createSeries","XYCursor","ChartIndicator","valueXField","valueYField","groupDataDisabled","calculateAggregates","_handleLegend","disposeDataItem","_getDataArray","_sma","_wma","_tema","baseDuration","newX","MovingAverage","upperBandSeries","openValueYField","lowerBandSeries","_applyThemes","smaData","Number","upper","lower","MovingAverageEnvelope","ColumnSeries","increasing","decreasing","deviation","deviationColor","MovingAverageDeviation","mean","stdSum","j","di","diValue","pow","std","sqrt","BollingerBands","strictMinMax","makeDataItem","overBoughtRange","createAxisRange","overBoughtFills","overBoughtGrid","overBoughtLabel","location","overSoldRange","overSoldFills","overSoldGrid","overSoldLabel","overSoldValue","overBoughtValue","getNumberFormatter","format","rsi","gain","loss","valueY","RelativeStrengthIndex","setRaw","low","high","volume","volumeDI","mf","ad","AccumulationDistribution","_axisRangeDI","_axisRange","axisRange","t","asi","swingColor","yDataItem","cy","oy","hl","hc","lc","tr","er","AccumulativeSwingIndex","downSeries","Infinity","li","hi","vh","vl","up","down","Aroon","signalSeries","differenceSeries","emaFast","emaSlow","macd","signal","difference","differenceColor","MACD","mfv","cmf","ChaikinMoneyFlow","ChaikinOscillator","previous","obv","OnBalanceVolume","slowSeries","lp","hp","StochasticOscillator","sma5","sma34","ao","oscillatorColor","AwesomeOscillator","williams","WilliamsR","getVolumeColor","Volume","_getTypicalPrice","sma","meanDeviation","cci","CommodityChannelIndex","disparity","DisparityIndex","_tag","_di","strokesTemplate","fillsTemplate","templateField","_handleFillDragStart","_getIndex","_isPointerDown","_erasingEnabled","_disposeIndex","_drawingEnabled","_handlePointerDown","_getStrokeIndex","dragStart","_handleFillDragStop","dragStop","_isHover","_showSegmentBullets","_hideAllBullets","bulletsContainer","bullets","setStateOnChildren","Circle","C","event","_addBulletInteraction","_tweakBullet","Bullet","locationX","sprite","_handlePointerOver","_handlePointerOut","_key","_dataItems","userData","bullet","unhover","_isDragging","plotContainer","_dragStartPX","coordinateToPosition","_dragStartY","_getYValue","positionToValue","_dvpX","valueToPosition","_dvY","posX","dvpx","dvy","vpx","vy","vx","_getXValue","_setXLocation","_updateSegment","_updateElements","_index","_getStrokeTemplate","_getFillTemplate","fillTemplate","strokeTemplate","_container","_handleBulletDragged","_handleBulletDragStart","_handleBulletDragStop","_handlePointerClick","_clickPointerPoint","_handleBulletDraggedReal","_positionBullets","_event","corner","_clickDp","_downDp","_upDp","_handlePointerUp","_moveDp","_handlePointerMove","_isDrawing","_movePointerPoint","_setXLocationReal","Date","locale","firstDayOfWeek","utc","getTime","baseValueSeries","baseValue","_getBase","DrawingSeries","_pIndex","_addContextInfo","_addPoint","_checkClosing","_handleClosing","closing","firstDataItem","dPoint","hypot","PolylineSeries","movePoint","vwy","blDI","brDI","tlDI","trDI","tlDI2","_addPoints","diTR","diBR","diBL","RectangleSeries","Line","lines","hitLines","mainContainer","lineTemplate","_lines","strokeIndex","hitTemplate","s","hitLine","_hitLines","diP1","diP2","p1","p2","p11","p22","_updateLine","segments","_handlePointerClickReal","_handlePointerMoveReal","makeLine","makeHitLine","SimpleLineSeries","_updateExtentionLine","HorizontalLineSeries","VerticalLineSeries","x1","x2","di1","getSeriesItem","di2","i1","i2","average","AverageSeries","startIndex","endIndex","inversed","points","ii","resultPoints","y1","y2","RegressionSeries","_handleBulletPosition","segmentItems","_panX","_panY","cursor","DoodleSeries","_createGrip","gripL","_resize","gripR","_resizeStart","gripT","_rotate","gripB","grip","_is","_ix","_iw","_updatePositions","delta","themeTag","RoundedRectangle","_positionDP","bounds","localBounds","d","w","left","bottom","top","a","rectangle","cx","cxr","Percent","cyr","rotation","SpriteResizer","iconCenterX","iconCenterY","spriteResizer","IconSeries","div","_inner","textArea","scrollHeight","saveText","Label","fontFamily","fontStyle","fontWeight","_tweakBullet2","input","_clickEvent","inputDiv","focus","clickEvent","LabelSeries","bgColor","PointedRectangle","_updatePointer","animate","to","from","duration","easing","toGlobal","pointerX","pointerY","CalloutSeries","radiusX","radiusY","Ellipse","ellipses","ellipse","ellipseTemplate","bDI","tDI","rDI","lDI","positionL","positionR","mx","valueXReal","locationXReal","valueYReal","valueY0","my","valueX0","positionX0","positionX","mpos","diT","diB","diL","diR","_clickVY","_clickPX","makeEllipse","_ellipses","pt","pb","pr","pl","rx","ry","EllipseSeries","TrendLineSeries","fill1","makeFill","fill2","dy","QuadrantLineSeries","labels","_updateSegmentReal","_updateChildrenReal","prevValue","_labels","_strokes","_fills","realValue","markDirtyText","labelArr","fillsArr","strokesArr","makeLabel","makeStroke","FibonacciSeries","valueY1","open1","open2","valueX1","endValue","positionToCoordinate","FibonacciTimezoneSeries","_p22","_p2","HorizontalRaySeries","_initControls","_afterChanged","_cssDisposer","controls","StockToolbar","_initSearch","searchBox","placeholder","_filterItems","search","searchCallback","maxItems","call","slice","getElementsByTagName","regex","RegExp","innerText","info","inputId","subLabel","inputs","DropdownList","setTool","_initTools","_getToolIcon","DrawingToolControl","itemObject","setItem","cloneNode","DropdownListControl","JSON","parse","listIcon","setIcon","_initIcons","_getDrawingIcon","stringify","IconControl","_initToolbar","toolbar","toolControl","iconControl","snapControl","strokeControl","strokeWidthControl","currentStrokeDasharray","dasharray","join","strokeDasharrayControl","fillControl","labelFillControl","fontSizes","size","fontSizeControl","boldControl","italicControl","fontFamilies","fontFamilyControl","extensionControl","eraserControl","_drawingSeries","_tool","seriesList","enableErasing","disableErasing","clearControl","clearDrawings","_setTool","_setStroke","_setFill","_setExtension","_setDrawingIcon","_setSnap","_currentEnabledSeries","disableDrawing","chartSeries","iconSvgPath","iconScale","enableDrawing","labelFontSizeControl","labelFontFamilyControl","controlElement","labelTools","snap","DrawingControl","addIndicator","_initList","indicatorId","modal","once","IndicatorControl","HOOKS","defaults","_disable","allowInput","allowInvalidPreload","altFormat","altInput","altInputClass","window","navigator","userAgent","ariaDateFormat","autoFillDefaultTime","clickOpens","closeOnSelect","conjunction","dateFormat","defaultHour","defaultMinute","defaultSeconds","disable","disableMobile","enableSeconds","enableTime","errorHandler","err","console","warn","getWeek","givenDate","date","setHours","setDate","getDate","getDay","week1","getFullYear","hourIncrement","ignoredFocusElements","inline","minuteIncrement","mode","monthSelectorType","nextArrow","noCalendar","now","onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition","plugins","positionElement","prevArrow","shorthandCurrentMonth","showMonths","static","time_24hr","weekNumbers","wrap","english","weekdays","shorthand","longhand","months","daysInMonth","ordinal","nth","rangeSeparator","weekAbbreviation","scrollTitle","toggleTitle","amPM","yearAriaLabel","monthAriaLabel","hourAriaLabel","minuteAriaLabel","pad","number","bool","debounce","fn","wait","_this","args","arguments","clearTimeout","arrayify","obj","Array","toggleClass","elem","classList","remove","tag","textContent","clearNode","node","firstChild","removeChild","findParent","condition","parentNode","createNumberInput","inputClassName","opts","wrapper","numInput","arrowUp","arrowDown","pattern","getEventTarget","composedPath","error","doNothing","monthToStr","monthNumber","revFormat","D","F","dateObj","monthName","setMonth","G","hour","getHours","parseFloat","H","J","day","K","test","M","shortMonth","S","seconds","setSeconds","U","_","unixSeconds","W","weekNum","weekNumber","parseInt","Y","year","setFullYear","Z","ISODate","minutes","setMinutes","month","u","unixMillSeconds","tokenRegex","formats","toISOString","getMonth","getSeconds","getMinutes","String","substring","createDateFormatter","_a","_b","config","_c","l10n","_d","isMobile","frmt","overrideLocale","formatDate","map","arr","createDateParser","givenFormat","timeless","customLocale","parsedDate","dateOrig","toFixed","datestr","trim","parseDate","matched","ops","matchIndex","regexStr","token","isBackSlash","escaped","exec","val","forEach","isNaN","compareDates","date1","date2","calculateSecondsSinceMidnight","hours","getDefaultHours","minDate","minHour","minMinutes","minSeconds","maxDate","maxHr","maxMinutes","__assign","Object","assign","p","prototype","hasOwnProperty","__spreadArrays","il","jl","FlatpickrInstance","instanceConfig","self","flatpickr","defaultConfig","getClosestActiveElement","calendarContainer","getRootNode","activeElement","bindToInstance","setCalendarWidth","requestAnimationFrame","visibility","daysContainer","daysWidth","days","offsetWidth","weekWrapper","removeProperty","updateTime","selectedDates","defaultDate","getMilliseconds","latestSelectedDateObj","isKeyDown","eventTarget","getAttribute","step","curValue","which","isHourElem","hourElement","isMinuteElem","minuteElement","incrementNumInput","timeWrapper","_input","setHoursFromInputs","updateValue","_debouncedChange","secondElement","limitMinHours","minTime","minDateHasTime","limitMaxHours","maxTime","maxDateHasTime","minBound","maxBound","currentTime","result","secondsSinceMidnight","floor","parseSeconds","setHoursFromDate","onYearInput","toString","changeYear","handler","el","addEventListener","_handlers","removeEventListener","triggerChange","triggerEvent","jumpToDate","jumpDate","jumpTo","oldYear","currentYear","oldMonth","currentMonth","message","buildMonthSwitch","redraw","timeIncrement","contains","inputElem","createEvent","dispatchEvent","createDay","_dayNumber","dateIsEnabled","dayElement","$i","todayDateElem","tabIndex","isDateSelected","selectedDateElem","isDateInRange","insertAdjacentHTML","focusOnDayElem","targetNode","onMouseOver","getFirstAvailableDay","startMonth","endMonth","focusOnDay","current","dayFocused","isInView","body","startElem","givenMonth","loopDelta","numMonthDays","changeMonth","getNextAvailableDay","buildMonthDays","firstOfMonth","prevMonthDays","utils","getDaysInMonth","createDocumentFragment","isMultiMonth","prevMonthDayClass","nextMonthDayClass","dayNumber","dayIndex","dayNum","dayContainer","buildDays","frag","shouldBuildMonth","monthsDropdownContainer","buildMonth","monthElement","monthNavFragment","selectedMonth","yearInput","tabindex","yearElement","disabled","buildMonths","monthNav","prevMonthNav","yearElements","monthElements","nextMonthNav","buildWeekdays","weekdayContainer","updateWeekdays","splice","isOffset","_hidePrevMonthArrow","_hideNextMonthArrow","updateNavigationCurrentMonth","isCalendarElem","documentClick","eventTarget_1","isCalendarElement","lostFocus","relatedTarget","isIgnored","some","timeContainer","newYear","newYearNum","isNewYear","dateToCheck","enable","array","parsed","onBlur","isInput","valueChanged","trimEnd","getDateStr","allowKeydown","allowInlineKeydown","blur","isTimeObj","focusAndClose","selectDate","delta_1","ctrlKey","currentYearElement","elems","pluginElements","filter","shiftKey","charAt","toLowerCase","cellClass","hoverDate","firstElementChild","initialDate","rangeStartDate","rangeEndDate","containsDisabled","minRange","maxRange","rContainer","querySelectorAll","dayElem","ts","ts1","ts2","timestamp","outOfRange","onResize","positionCalendar","minMaxDateSetter","inverseDateObj","removeAttribute","getInputElem","querySelector","setupLocale","l10ns","default","dataset","customPositionElement","_positionElement","calendarHeight","reduce","acc","child","offsetHeight","calendarWidth","configPos","configPosVertical","configPosHorizontal","inputBounds","distanceFromBottom","innerHeight","showOnTop","pageYOffset","pageXOffset","isCenter","isRight","rightMost","centerMost","doc","editableSheet","styleSheets","sheet","cssRules","head","getDocumentStyleSheet","bodyWidth","centerLeft","centerIndex","centerStyle","insertRule","centerBefore","msMaxTouchPoints","selectedDate","shouldChangeMonth","selectedIndex","sort","b","single","range","loadedPlugins","_bind","_setHoursFromDate","_positionCalendar","triggerChangeEvent","toInitial","mobileInput","_initialDate","_createElement","destroy","lastChild","insertBefore","_type","click","wasOpen","select","CALLBACKS","setSelectedDate","toggle","updatePositionElement","inputDate","dates","parseDateRules","hooks","initEvent","specificFormat","dObj","mobileFormatStr","onMonthNavClick","isPrevMonth","isNextMonth","boolOpts","userConfig","defineProperty","_enable","timeMode","defaultDateFormat","defaultAltFormat","_minDate","_maxDate","minMaxTimeSetter","_minTime","_maxTime","hook","pluginConf","parseConfig","nodeName","required","nextSibling","preloadedDate","setupDates","yr","fragment","__hidePrevMonthArrow","__hideNextMonthArrow","innerContainer","buildWeeks","separator","hourInput","minuteInput","military2ampm","secondInput","buildTime","customAppend","appendTo","nodeType","build","evt","inputType","defaultValue","setupMobile","debouncedResize","ontouchstart","capture","bindEvents","isSafari","init","_flatpickr","nodeList","nodes","HTMLElement","instances","HTMLCollection","NodeList","selector","Node","en","localize","setDefaults","jQuery","fp_incr","_updateInputs","_loadDefaultCSS","_initDropdown","fromColumn","fromGroup","fromLabel","translate","fromField","toColumn","toGroup","toLabel","pickerLocale","_getPickerLocale","fromPicker","_formatDate","_parseDate","toPicker","buttons","buttonsColumn","_getAxis","zoomToDates","_updateLabel","dateFormatter","_getDateFormat","translateFunc","primary","primary2","StyleSheet","DateRangeSelector","_initPeriodButtons","toUpperCase","selectPeriod","_getChart","zoomOut","getIntervalMax","getGroupInterval","endTime","PeriodSelector","SeriesTypeControl","IntervalControl","ResetControl","_setLogarithmic","_setFills","_populateInputs","currentScale","_getYScale","_getFillEnabled","axisFills","resetExtremes","enabled","grid","SettingsControl","ComparisonControl","_i","TypeError","_loop_1","source","keys","args_1","module","_extends","_toConsumableArray","isArray","arr2","DEFAULT_OPTIONS","order","precision","determinationCoefficient","results","predictions","observations","observation","ssyy","accum","prediction","residual","factor","methods","linear","run","rise","gradient","intercept","predict","equation","r2","string","exponential","log","denominator","exp","coeffA","coeffB","logarithmic","power","polynomial","lhs","rhs","_l","coefficients","matrix","maxrow","tmp","_j","_k","_j2","total","_k2","gaussianElimination","v","coeff","reverse","exports","accumulator","_round","supplied","enumerable","configurable","writable","am5stock"],"sourceRoot":""}